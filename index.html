<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Kapazit√§tsplaner V5 - Hierarchische Dashboards</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: system-ui, -apple-system, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .group:hover .group-hover\:opacity-100 { opacity: 1; }
    /* Scroll-Position beibehalten */
    .preserve-scroll { scroll-behavior: auto; }
    
    /* Verstecke Scrollbar f√ºr Header-Synchronisation */
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    
    /* Diagonale Schraffur f√ºr Pausenzeiten */
    .break-stripe {
      background-color: rgba(251, 146, 60, 0.2); /* Orange transparent */
      background-image: repeating-linear-gradient(
        45deg,
        rgba(251, 146, 60, 0.4) 0px,
        rgba(251, 146, 60, 0.4) 2px,
        transparent 2px,
        transparent 6px
      );
    }
    
    /* Mobile Touch-Optimierungen */
    @media (max-width: 768px) {
      /* Touch-Targets mindestens 44x44px */
      button { min-height: 44px; min-width: 44px; }
      
      /* Besseres Tap-Highlighting */
      button, a, [role="button"] {
        -webkit-tap-highlight-color: rgba(99, 102, 241, 0.3);
      }
      
      /* Verhindere Zoom bei Input-Focus */
      input, select, textarea {
        font-size: 16px !important;
      }
      
      /* Scrollbare Bereiche mit Momentum */
      .overflow-x-auto, .overflow-y-auto {
        -webkit-overflow-scrolling: touch;
      }
      
      /* Mobile: Kleinere Schrift im Gantt */
      .gantt-text {
        font-size: 10px !important;
      }
      
      /* Mobile: Admin Panel volle H√∂he */
      .admin-modal {
        max-height: 95vh !important;
        margin: 0.5rem !important;
      }
      
      /* Mobile: Gr√∂√üere Touch-Bereiche f√ºr Tasks */
      .task-block {
        min-height: 50px !important;
      }
    }
    
    /* Tablet Optimierungen */
    @media (min-width: 768px) and (max-width: 1024px) {
      /* Admin Panel auf Tablets */
      .admin-grid {
        grid-template-columns: 1fr 1fr !important;
      }
    }
    
    /* Sehr kleine Smartphones */
    @media (max-width: 480px) {
      /* Admin Panel einspaltiges Layout */
      .admin-grid {
        grid-template-columns: 1fr !important;
      }
      
      /* Kleinere Padding auf Mobile */
      .mobile-padding {
        padding: 0.5rem !important;
      }
      
      /* Dashboard Karten volle Breite */
      .dashboard-cards {
        grid-template-columns: 1fr !important;
      }
    }
    
    /* Verbesserte Touch-Gesten f√ºr Tasks */
    .task-touchable {
      cursor: pointer;
      touch-action: none;
    }
    
    @media (hover: none) {
      /* Auf Touch-Ger√§ten: Buttons immer sichtbar */
      .opacity-0.group-hover\:opacity-100 {
        opacity: 0.8 !important;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // FIREBASE CONFIG
    const firebaseConfig = {
      apiKey: "AIzaSyBSPyPehsfFzYTL6Rdy7zVy2l-aLDunckI",
      authDomain: "kapazitaetsplanerhoffmann.firebaseapp.com",
      projectId: "kapazitaetsplanerhoffmann",
      storageBucket: "kapazitaetsplanerhoffmann.firebasestorage.app",
      messagingSenderId: "25183676841",
      appId: "1:25183676841:web:bb8ecbe3c6e185ca07bcb8"
    };

    // Firebase initialisieren
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    const db = firebase.firestore();

    // Storage-Wrapper f√ºr Firebase (kompatibel mit alter window.storage API)
    window.storage = {
      async get(key) {
        try {
          const doc = await db.collection('data').doc(key).get();
          if (doc.exists) {
            return { key, value: doc.data().value };
          }
          return null;
        } catch (e) {
          console.error('Firebase get error:', e);
          return null;
        }
      },
      async set(key, value) {
        try {
          await db.collection('data').doc(key).set({ value, updated: new Date() });
          return { key, value };
        } catch (e) {
          console.error('Firebase set error:', e);
          return null;
        }
      }
    };

    // Lucide React Icons als inline SVG
    const Calendar = ({className, ...props}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
    );
    const Users = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
    );
    const LogOut = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
    );
    const Settings = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
    );
    const Plus = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="M12 5v14"/></svg>
    );
    const Trash2 = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
    );
    const GripVertical = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg>
    );
    const ChevronLeft = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m15 18-6-6 6-6"/></svg>
    );
    const ChevronRight = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m9 18 6-6-6-6"/></svg>
    );
    const StickyNote = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M15.5 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V8.5L15.5 3Z"/><path d="M15 3v6h6"/></svg>
    );
    const BarChart3 = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>
    );
    const ChevronDown = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m6 9 6 6 6-6"/></svg>
    );
    const ChevronUp = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m18 15-6-6-6 6"/></svg>
    );
    const Umbrella = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 12a10.06 10.06 1 0 0-20 0Z"/><path d="M12 12v8a2 2 0 0 0 4 0"/><path d="M12 2v1"/></svg>
    );
    const Eye = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
    );
    const Building2 = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/></svg>
    );
    const ArrowRight = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
    );
    const Copy = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
    );
    const X = ({className}) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
    );

const CapacityPlanner = () => {
  const [currentUser, setCurrentUser] = useState(null);
  const [users, setUsers] = useState([]);
  const [teams, setTeams] = useState([]);
  const [divisions, setDivisions] = useState([]); // NEU: Abteilungen
  const [departments, setDepartments] = useState([]);
  const [projects, setProjects] = useState([]);
  const [projectFolders, setProjectFolders] = useState([]); // NEU: Ordner f√ºr Projekte
  const [tasks, setTasks] = useState([]);
  const [notes, setNotes] = useState([]);
  const [vacations, setVacations] = useState([]);
  const [currentWeek, setCurrentWeek] = useState(() => {
    const now = new Date();
    const d = new Date(Date.UTC(now.getFullYear(), now.getMonth(), now.getDate()));
    const dayNum = d.getUTCDay() || 7;
    d.setUTCDate(d.getUTCDate() + 4 - dayNum);
    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
    return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
  });
  const [currentYear] = useState(new Date().getFullYear());
  const [isAuthenticated, setIsAuthenticated] = useState(false);
  const [passwordInput, setPasswordInput] = useState('');
  const [passwordError, setPasswordError] = useState(false);
  const [showLogin, setShowLogin] = useState(true);
  
  // üîê PASSWORT HIER √ÑNDERN - dies ist das gemeinsame Team-Passwort
  const APP_PASSWORD = "Team2025";
  const [showSettings, setShowSettings] = useState(false);
  const [showAdmin, setShowAdmin] = useState(false);
  const [adminExpandedUsers, setAdminExpandedUsers] = useState({});
  const [adminExpandedResources, setAdminExpandedResources] = useState({});
  const [adminUserSort, setAdminUserSort] = useState('recent');
  const [adminResourceSort, setAdminResourceSort] = useState('recent');
  const [showDashboard, setShowDashboard] = useState(false);
  const [showProjectDashboard, setShowProjectDashboard] = useState(false); // Projektdashboard
  const [showProjectPlanning, setShowProjectPlanning] = useState(false); // NEU: Projektplanung
  const [projectPlanningView, setProjectPlanningView] = useState('projects'); // 'projects' oder 'resources'
  const [projectPhases, setProjectPhases] = useState([]); // Projekt-Phasen f√ºr Gantt
  const [workPackages, setWorkPackages] = useState([]); // NEU: Arbeitspakete unter Phasen
  const [dependencies, setDependencies] = useState([]); // NEU: Abh√§ngigkeiten zwischen APs
  const [resources, setResources] = useState([]); // NEU: Ressourcen (Maschinen, Werkzeuge, Fahrzeuge)
  const [timelineScroll, setTimelineScroll] = useState(0); // NEU: Scroll-Position f√ºr Timeline
  const [dayWidth, setDayWidth] = useState(15); // NEU: Breite pro Tag (Zoom) - Standard 15px
  const [expandedProjects, setExpandedProjects] = useState({}); // Aufklapp-Status der Projekte
  const [expandedPhases, setExpandedPhases] = useState({}); // Aufklapp-Status der Phasen
  const [draggedProject, setDraggedProject] = useState(null);
  const [draggedTask, setDraggedTask] = useState(null);
  const [resizingTask, setResizingTask] = useState(null);
  const [fontSize, setFontSize] = useState(12);
  const [dashboardFontSize, setDashboardFontSize] = useState(10); // Schriftgr√∂√üe f√ºr Dashboard
  const [expandedNotes, setExpandedNotes] = useState({});
  const [expandedMembers, setExpandedMembers] = useState({});
  const [selectedUser, setSelectedUser] = useState(null);
  const [detailViewUser, setDetailViewUser] = useState(null);
  const [projectSearchText, setProjectSearchText] = useState('');
  
  // Projektdashboard Filter (persistent pro User)
  const [projectDashboardFilters, setProjectDashboardFilters] = useState({
    department: 'all',
    division: 'all',
    team: 'all',
    user: 'all',
    projectSearch: ''
  });
  
  // History & Undo/Redo States
  const [historyLog, setHistoryLog] = useState([]);
  const [showHistory, setShowHistory] = useState(false);
  const [sidebarWPId, setSidebarWPId] = useState(null); // Sidebar f√ºr Projektplanung
  const [filterAssigned, setFilterAssigned] = useState({ responsibles: false, editors: false, divisions: false });
  const [resizeMode, setResizeMode] = useState('magnetic'); // 'magnetic' oder 'rigid'
  const [baselines, setBaselines] = useState([]); // Gespeicherte Baselines
  const [activeBaseline, setActiveBaseline] = useState(null); // Aktuell angezeigte Baseline
  const [ganttZoomLevel, setGanttZoomLevel] = useState(50); // Zoom f√ºr Gantt (25-100%)
  const [ganttLeftPanelWidth, setGanttLeftPanelWidth] = useState(384); // Breite der linken Liste
  const [ganttColumnWidths, setGanttColumnWidths] = useState({ 
    start: 70,  // Start-Spalte
    end: 70,    // Ende-Spalte
    hours: 50,  // Plan h-Spalte
    days: 40    // KT-Spalte
  }); // Individuelle Spaltenbreiten
  const [ganttVisibleColumns, setGanttVisibleColumns] = useState({ start: true, end: true, hours: true, days: true }); // Sichtbare Spalten
  const [ganttProjectSidebarCollapsed, setGanttProjectSidebarCollapsed] = useState(false); // Projekt-Sidebar eingeklappt
  const [ganttSelectedProjectId, setGanttSelectedProjectId] = useState(null); // Ausgew√§hltes Projekt
  const [ganttSelectedFolderId, setGanttSelectedFolderId] = useState(null); // Ausgew√§hlter Ordner
  const [ganttDetailsCollapsed, setGanttDetailsCollapsed] = useState(false); // Details-Panel eingeklappt
  const [workloadPanelHeight, setWorkloadPanelHeight] = useState(0); // 0 = geschlossen
  const [workloadExpandedGroups, setWorkloadExpandedGroups] = useState({});
  const [workloadExpandedUsers, setWorkloadExpandedUsers] = useState({});
  const [workloadFilter, setWorkloadFilter] = useState('mitarbeiter');
  const [workloadZoom, setWorkloadZoom] = useState(120);
  const [wlFontSize, setWlFontSize] = useState(11); // Einheitliche Schriftgr√∂√üe (8-14px)
  const [wlDecimals, setWlDecimals] = useState(0); // Dezimalstellen (0, 1, 2)
  const [wlFocusWP, setWlFocusWP] = useState(null); // { wpId, wpName, userIds: [] } - Feinplanung-Filter
  const [highlightedDays, setHighlightedDays] = useState({}); // { "2026-02-14": "#fbbf24" } - Hervorgehobene Tage
  const [holidays, setHolidays] = useState({}); // Freie Tage: { "2026-02-16": { type: "feiertag", name: "Rosenmontag" } }
  
  // Freie Tage laden
  useEffect(() => {
    const loadHolidays = async () => {
      try {
        const saved = await window.storage.get('ganttHolidays');
        if (saved) setHolidays(JSON.parse(saved.value));
      } catch (e) { /* ignore */ }
    };
    loadHolidays();
  }, []);
  
  // Freie Tage speichern
  const saveHolidays = async (h) => {
    setHolidays(h);
    try {
      await window.storage.set('ganttHolidays', JSON.stringify(h));
    } catch (e) { /* ignore */ }
  };
  
  // Hervorgehobene Tage laden
  useEffect(() => {
    const load = async () => {
      try {
        const saved = await window.storage.get('highlightedDays');
        if (saved) setHighlightedDays(JSON.parse(saved.value));
      } catch (e) { /* ignore */ }
    };
    load();
  }, []);
  
  const saveHighlightedDays = async (h) => {
    setHighlightedDays(h);
    try { await window.storage.set('highlightedDays', JSON.stringify(h)); } catch (e) { /* ignore */ }
  };
  
  // Baselines beim Start laden
  useEffect(() => {
    const loadBaselines = async () => {
      try {
        const saved = await window.storage.get('wpBaselines');
        if (saved) setBaselines(JSON.parse(saved.value));
      } catch (e) { /* ignore */ }
    };
    loadBaselines();
  }, []);
  
  const [undoStack, setUndoStack] = useState([]);
  const [redoStack, setRedoStack] = useState([]);
  const maxUndoSteps = 50; // Maximale Anzahl Undo-Schritte
  
  // Refs f√ºr Scroll-Position
  const ganttScrollRef = useRef(null);
  const [savedScrollPosition, setSavedScrollPosition] = useState(0);
  
  // Neue States f√ºr hierarchische √úbersichten
  const [expandedDepartments, setExpandedDepartments] = useState({});
  const [expandedTeams, setExpandedTeams] = useState({});

  // Ref f√ºr Admin-Panel Scroll-Position
  const adminScrollRef = useRef(null);
  const [lastScrollPosition, setLastScrollPosition] = useState(0);

  const WEEKS_TO_SHOW = 4;
  const DW = 80, HH = 40;
  const GRID_START = 6;               // Gantt zeigt ab 6:00 ‚Ä¶
  const GRID_END   = 20;              // ‚Ä¶ bis 20:00
  const GRID_ROWS  = GRID_END - GRID_START; // 14 Zeilen
  
  // üìú History & Undo/Redo Funktionen
  const createSnapshot = () => ({
    tasks: JSON.parse(JSON.stringify(tasks)),
    projects: JSON.parse(JSON.stringify(projects)),
    users: JSON.parse(JSON.stringify(users)),
    vacations: JSON.parse(JSON.stringify(vacations)),
    notes: JSON.parse(JSON.stringify(notes))
  });
  
  const saveSnapshot = () => {
    const snapshot = createSnapshot();
    setUndoStack(prev => [snapshot, ...prev].slice(0, maxUndoSteps));
    setRedoStack([]); // Redo-Stack leeren bei neuer Aktion
  };
  
  const addToHistory = (action, details) => {
    const entry = {
      id: Date.now(),
      timestamp: new Date().toISOString(),
      action, // z.B. 'task_create', 'task_move', 'vacation_set'
      userName: currentUser?.name || 'Unbekannt',
      userId: currentUser?.id,
      details
    };
    setHistoryLog(prev => [entry, ...prev].slice(0, 200)); // Max 200 Eintr√§ge
  };
  
  const undo = () => {
    if (undoStack.length === 0) return;
    
    const currentSnapshot = createSnapshot();
    setRedoStack(prev => [currentSnapshot, ...prev].slice(0, maxUndoSteps));
    
    const previousState = undoStack[0];
    setTasks(previousState.tasks);
    setProjects(previousState.projects);
    setUsers(previousState.users);
    setVacations(previousState.vacations);
    setNotes(previousState.notes);
    setUndoStack(prev => prev.slice(1));
    
    addToHistory('undo', { info: 'Aktion r√ºckg√§ngig gemacht' });
  };
  
  const redo = () => {
    if (redoStack.length === 0) return;
    
    const currentSnapshot = createSnapshot();
    setUndoStack(prev => [currentSnapshot, ...prev].slice(0, maxUndoSteps));
    
    const nextState = redoStack[0];
    setTasks(nextState.tasks);
    setProjects(nextState.projects);
    setUsers(nextState.users);
    setVacations(nextState.vacations);
    setNotes(nextState.notes);
    setRedoStack(prev => prev.slice(1));
    
    addToHistory('redo', { info: 'Aktion wiederhergestellt' });
  };
  
  // Standard: Vollzeit mit ZWEI Pausen
  const DEFAULT_SCHEDULE = {
    1: {start:8, end:17, break1Start:9, break1Duration:0.25, break2Start:12.5, break2Duration:0.75},
    2: {start:8, end:17, break1Start:9, break1Duration:0.25, break2Start:12.5, break2Duration:0.75},
    3: {start:8, end:17, break1Start:9, break1Duration:0.25, break2Start:12.5, break2Duration:0.75},
    4: {start:8, end:17, break1Start:9, break1Duration:0.25, break2Start:12.5, break2Duration:0.75},
    5: {start:8, end:17, break1Start:9, break1Duration:0.25, break2Start:12.5, break2Duration:0.75}
  };

  // 8.5  ‚Üí  "08:30"   |   "08:30"  ‚Üí  8.5
  const h2t = (h) => { const hh=Math.floor(h), mm=Math.round((h-hh)*60); return `${String(hh).padStart(2,'0')}:${String(mm).padStart(2,'0')}`; };
  const t2h = (s) => { const [h,m]=s.split(':').map(Number); return h+m/60; };
  
  // Smart Time Formatter - wandelt verschiedene Eingaben in HH:MM um
  const formatTimeInput = (input) => {
    if (!input) return '';
    
    // Nur Zahlen extrahieren
    const digits = input.replace(/[^0-9]/g, '');
    if (digits.length === 0) return '';
    
    // Verschiedene Formate handhaben
    if (digits.length === 1) {
      // "6" ‚Üí "06:00"
      return `${digits.padStart(2, '0')}:00`;
    } else if (digits.length === 2) {
      // "63" ‚Üí "06:30" oder "12" ‚Üí "12:00"
      const num = parseInt(digits);
      if (num > 23) {
        // Wahrscheinlich HM statt HH (z.B. 63 = 6:30)
        const h = digits[0];
        const m = digits[1] + '0';
        return `${h.padStart(2, '0')}:${m}`;
      } else {
        return `${digits}:00`;
      }
    } else if (digits.length === 3) {
      // "630" ‚Üí "06:30"
      const h = digits[0];
      const m = digits.substring(1);
      return `${h.padStart(2, '0')}:${m}`;
    } else if (digits.length >= 4) {
      // "1230" ‚Üí "12:30"
      const h = digits.substring(0, 2);
      const m = digits.substring(2, 4);
      return `${h}:${m}`;
    }
    
    return input;
  };

  // Pr√ºfe ob eine Stunde in einer Pausenzeit liegt (ZWEI Pausen m√∂glich!)
  const isBreakHour = (user, date, hour) => {
    if (!date) return false;
    const dayNum = date.getDay();
    if (dayNum === 0 || dayNum === 6) return false; // Wochenende
    const sched = (user.dailySchedule || DEFAULT_SCHEDULE)[dayNum];
    if (!sched) return false;
    
    // Pause 1 (z.B. 09:00-09:15)
    const break1Start = sched.break1Start || 0;
    const break1Duration = sched.break1Duration || 0;
    const break1End = break1Start + break1Duration;
    
    // Pause 2 (z.B. 12:30-13:15)
    const break2Start = sched.break2Start || 0;
    const break2Duration = sched.break2Duration || 0;
    const break2End = break2Start + break2Duration;
    
    // Teilzeit-Logik: Wenn Arbeitsende vor 13:00, dann Mittagspause entf√§llt
    const workEnd = sched.end || 17;
    const hasBreak2 = workEnd > 13 && break2Duration > 0;
    
    // Pr√ºfe ob Stunde in einer der Pausen liegt
    const inBreak1 = break1Duration > 0 && hour >= break1Start && hour < break1End;
    const inBreak2 = hasBreak2 && hour >= break2Start && hour < break2End;
    
    return inBreak1 || inBreak2;
  };
  
  // Berechne Netto-Stunden (Brutto minus ALLE Pausen√ºberschneidungen)
  const calculateNetHours = (startHour, endHour, startDate, endDate, userId) => {
    const start = new Date(startDate + 'T12:00:00');
    const end = new Date(endDate + 'T12:00:00');
    const days = Math.round((end - start) / 86400000) + 1;
    const user = users.find(u => u.id === userId);
    
    let totalGross = 0;
    let totalBreak = 0;
    
    for (let d = 0; d < days; d++) {
      const currentDate = new Date(start);
      currentDate.setDate(start.getDate() + d);
      const dayNum = currentDate.getDay();
      
      // Wochenende √ºberspringen
      if (dayNum === 0 || dayNum === 6) continue;
      
      const sched = (user?.dailySchedule || DEFAULT_SCHEDULE)[dayNum];
      if (!sched) continue;
      
      const dayGross = endHour - startHour;
      totalGross += dayGross;
      
      // Pause 1 √úberschneidung
      const break1Start = sched.break1Start || 0;
      const break1Duration = sched.break1Duration || 0;
      const break1End = break1Start + break1Duration;
      
      if (break1Duration > 0) {
        const overlap1Start = Math.max(startHour, break1Start);
        const overlap1End = Math.min(endHour, break1End);
        if (overlap1Start < overlap1End) {
          totalBreak += (overlap1End - overlap1Start);
        }
      }
      
      // Pause 2 √úberschneidung (nur wenn nicht Teilzeit)
      const workEnd = sched.end || 17;
      const hasBreak2 = workEnd > 13;
      
      if (hasBreak2) {
        const break2Start = sched.break2Start || 0;
        const break2Duration = sched.break2Duration || 0;
        const break2End = break2Start + break2Duration;
        
        if (break2Duration > 0) {
          const overlap2Start = Math.max(startHour, break2Start);
          const overlap2End = Math.min(endHour, break2End);
          if (overlap2Start < overlap2End) {
            totalBreak += (overlap2End - overlap2Start);
          }
        }
      }
    }
    
    return {
      gross: totalGross,
      break: totalBreak,
      net: totalGross - totalBreak
    };
  };

  // Berechne Netto-Stunden f√ºr einen EINZELNEN Tag (f√ºr Dashboard Tages-Anzeige)
  const calculateDayNetHours = (userId, date, startHour, endHour) => {
    const user = users.find(u => u.id === userId);
    const dayNum = date.getDay();
    
    // Wochenende = 0 Stunden
    if (dayNum === 0 || dayNum === 6) return 0;
    
    const sched = (user?.dailySchedule || DEFAULT_SCHEDULE)[dayNum];
    if (!sched) return 0;
    
    let netHours = endHour - startHour;
    
    // Pause 1 abziehen falls √úberschneidung
    const break1Start = sched.break1Start;
    const break1Duration = sched.break1Duration || 0;
    if (break1Start !== undefined && break1Duration > 0) {
      const break1End = break1Start + break1Duration;
      const overlap1Start = Math.max(startHour, break1Start);
      const overlap1End = Math.min(endHour, break1End);
      if (overlap1Start < overlap1End) {
        netHours -= (overlap1End - overlap1Start);
      }
    }
    
    // Pause 2 abziehen falls √úberschneidung (nur bei Vollzeit)
    const workEnd = sched.end || 17;
    if (workEnd > 13) {
      const break2Start = sched.break2Start;
      const break2Duration = sched.break2Duration || 0;
      if (break2Start !== undefined && break2Duration > 0) {
        const break2End = break2Start + break2Duration;
        const overlap2Start = Math.max(startHour, break2Start);
        const overlap2End = Math.min(endHour, break2End);
        if (overlap2Start < overlap2End) {
          netHours -= (overlap2End - overlap2Start);
        }
      }
    }
    
    return netHours;
  };


  useEffect(() => {
    const init = async () => {
      try {
        const u = await window.storage.get('users').catch(() => null);
        const du = [
          { id: 'admin', name: 'Admin', role: 'admin', teamId: null, teamRole: null, departmentId: null },
          { id: 'p1', name: 'Person 1', role: 'member', teamId: 'team1', teamRole: 'lead', weeklyCapacity: 40, departmentId: null },
          { id: 'p2', name: 'Person 2', role: 'member', teamId: 'team1', teamRole: 'responsible', weeklyCapacity: 40, departmentId: null },
          { id: 'p3', name: 'Person 3', role: 'member', teamId: 'team1', teamRole: 'editor', weeklyCapacity: 40, departmentId: null },
          { id: 'p4', name: 'Person 4 (Bereichsleiter)', role: 'member', teamId: 'team2', teamRole: 'department_head', weeklyCapacity: 40, departmentId: 'dept1' },
          { id: 'p5', name: 'Person 5', role: 'member', teamId: 'team2', teamRole: 'editor', weeklyCapacity: 40, departmentId: null },
          { id: 'p6', name: 'Person 6 (Unternehmer)', role: 'member', teamId: null, teamRole: 'entrepreneur', weeklyCapacity: 40, departmentId: null }
        ];
        setUsers(u ? JSON.parse(u.value) : du);
        if (!u) await window.storage.set('users', JSON.stringify(du));

        const t = await window.storage.get('teams').catch(() => null);
        const dt = [
          { id: 'team1', name: 'Team Alpha', divisionId: 'div1' },
          { id: 'team2', name: 'Team Beta', divisionId: 'div1' }
        ];
        setTeams(t ? JSON.parse(t.value) : dt);
        if (!t) await window.storage.set('teams', JSON.stringify(dt));

        const div = await window.storage.get('divisions').catch(() => null);
        const ddiv = [
          { id: 'div1', name: 'Abteilung 1', departmentId: 'dept1' },
          { id: 'div2', name: 'Abteilung 2', departmentId: 'dept1' }
        ];
        setDivisions(div ? JSON.parse(div.value) : ddiv);
        if (!div) await window.storage.set('divisions', JSON.stringify(ddiv));

        const d = await window.storage.get('departments').catch(() => null);
        const dd = [
          { id: 'dept1', name: 'Bereich Nord' },
          { id: 'dept2', name: 'Bereich S√ºd' }
        ];
        setDepartments(d ? JSON.parse(d.value) : dd);
        if (!d) await window.storage.set('departments', JSON.stringify(dd));

        const p = await window.storage.get('projects').catch(() => null);
        const dp = [
          { id: 'p1', name: 'Projekt A', color: '#22c55e' },
          { id: 'p2', name: 'Projekt B', color: '#ef4444' },
          { id: 'p3', name: 'Projekt C', color: '#3b82f6' }
        ];
        setProjects(p ? JSON.parse(p.value) : dp);
        if (!p) await window.storage.set('projects', JSON.stringify(dp));

        const pf = await window.storage.get('projectFolders').catch(() => null);
        if (pf) setProjectFolders(JSON.parse(pf.value));

        const tk = await window.storage.get('tasks').catch(() => null);
        if (tk) setTasks(JSON.parse(tk.value));

        const n = await window.storage.get('notes').catch(() => null);
        if (n) setNotes(JSON.parse(n.value));

        const v = await window.storage.get('vacations').catch(() => null);
        if (v) setVacations(JSON.parse(v.value));
        
        const pp = await window.storage.get('projectPhases').catch(() => null);
        if (pp) setProjectPhases(JSON.parse(pp.value));
        
        const wp = await window.storage.get('workPackages').catch(() => null);
        if (wp) setWorkPackages(JSON.parse(wp.value));
        
        const deps = await window.storage.get('dependencies').catch(() => null);
        if (deps) setDependencies(JSON.parse(deps.value));
        
        const res = await window.storage.get('resources').catch(() => null);
        if (res) setResources(JSON.parse(res.value));
      } catch (e) { console.error('Init error:', e); }
    };
    init();
  }, []);

  useEffect(() => {
    if (currentUser && !selectedUser) setSelectedUser(currentUser);
    if (currentUser && selectedUser && currentUser.id !== selectedUser.id && currentUser.teamRole !== 'lead') {
      setSelectedUser(currentUser);
    }
  }, [currentUser]);

  // Scroll-Position nach State-Updates wiederherstellen
  useEffect(() => {
    if (ganttScrollRef.current && savedScrollPosition > 0) {
      ganttScrollRef.current.scrollLeft = savedScrollPosition;
      setSavedScrollPosition(0);
    }
  }, [tasks, expandedNotes, savedScrollPosition]);

  const getWeekDates = (w, y) => {
    try {
      // Jahres√ºberlauf behandeln
      let week = parseInt(w) || 1;
      let year = parseInt(y) || 2025;
      while (week > 52) {
        week -= 52;
        year++;
      }
      while (week < 1) {
        week += 52;
        year--;
      }
      
      const s = new Date(year, 0, 1 + (week - 1) * 7);
      const d = s.getDay();
      const st = new Date(s);
      if (d <= 4) st.setDate(s.getDate() - s.getDay() + 1);
      else st.setDate(s.getDate() + 8 - s.getDay());
      const dates = [];
      for (let i = 0; i < 7; i++) {
        const dt = new Date(st);
        dt.setDate(st.getDate() + i);
        dt.setHours(12, 0, 0, 0);
        dates.push(dt);
      }
      return dates;
    } catch (e) {
      console.error('Date error:', e);
      return [];
    }
  };

  const formatDate = (d) => {
    const dt = new Date(d);
    const year = dt.getFullYear();
    const month = String(dt.getMonth() + 1).padStart(2, '0');
    const day = String(dt.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
  };
  
  const getWeekNumber = (date) => {
    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
    const dayNum = d.getUTCDay() || 7;
    d.setUTCDate(d.getUTCDate() + 4 - dayNum);
    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
    return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
  };

  const saveTasks = async (t) => { setTasks(t); await window.storage.set('tasks', JSON.stringify(t)); };
  const saveProjects = async (p) => { setProjects(p); await window.storage.set('projects', JSON.stringify(p)); };
  const saveProjectFolders = async (pf) => { setProjectFolders(pf); await window.storage.set('projectFolders', JSON.stringify(pf)); };
  const saveUsers = async (u) => { setUsers(u); await window.storage.set('users', JSON.stringify(u)); };
  const saveTeams = async (t) => { setTeams(t); await window.storage.set('teams', JSON.stringify(t)); };
  const saveDivisions = async (d) => { setDivisions(d); await window.storage.set('divisions', JSON.stringify(d)); };
  const saveDepartments = async (d) => { setDepartments(d); await window.storage.set('departments', JSON.stringify(d)); };
  const saveNotes = async (n) => { setNotes(n); await window.storage.set('notes', JSON.stringify(n)); };
  const saveVacations = async (v) => { setVacations(v); await window.storage.set('vacations', JSON.stringify(v)); };
  const saveProjectPhases = async (pp) => { setProjectPhases(pp); await window.storage.set('projectPhases', JSON.stringify(pp)); };
  const saveWorkPackages = async (wp) => { setWorkPackages(wp); await window.storage.set('workPackages', JSON.stringify(wp)); };
  const saveDependencies = async (deps) => { setDependencies(deps); await window.storage.set('dependencies', JSON.stringify(deps)); };
  const saveResources = async (r) => { setResources(r); await window.storage.set('resources', JSON.stringify(r)); };

  // Zeilen-Reihenfolge √§ndern (Drag & Drop vertikal)
  const handleRowDrop = (draggedType, draggedId, targetType, targetId, position) => {
    if (draggedType === 'project' && targetType === 'project') {
      // Projekt verschieben
      const draggedIdx = projects.findIndex(p => p.id === draggedId);
      let targetIdx = projects.findIndex(p => p.id === targetId);
      if (draggedIdx === -1 || targetIdx === -1 || draggedIdx === targetIdx) return;
      
      const newProjects = [...projects];
      const [moved] = newProjects.splice(draggedIdx, 1);
      if (position === 'after') targetIdx = targetIdx >= draggedIdx ? targetIdx : targetIdx + 1;
      else targetIdx = targetIdx > draggedIdx ? targetIdx - 1 : targetIdx;
      newProjects.splice(targetIdx, 0, moved);
      
      // Order-Werte aktualisieren
      newProjects.forEach((p, i) => p.order = i);
      saveProjects(newProjects);
    }
    else if (draggedType === 'phase' && targetType === 'phase') {
      // Phase verschieben (nur innerhalb desselben Projekts)
      const draggedPhase = projectPhases.find(p => p.id === draggedId);
      const targetPhase = projectPhases.find(p => p.id === targetId);
      if (!draggedPhase || !targetPhase || draggedPhase.projectId !== targetPhase.projectId) return;
      
      const projectId = draggedPhase.projectId;
      const phasesInProject = projectPhases.filter(p => p.projectId === projectId);
      const otherPhases = projectPhases.filter(p => p.projectId !== projectId);
      
      const draggedIdx = phasesInProject.findIndex(p => p.id === draggedId);
      let targetIdx = phasesInProject.findIndex(p => p.id === targetId);
      if (draggedIdx === targetIdx) return;
      
      const [moved] = phasesInProject.splice(draggedIdx, 1);
      if (position === 'after') targetIdx = targetIdx >= draggedIdx ? targetIdx : targetIdx + 1;
      else targetIdx = targetIdx > draggedIdx ? targetIdx - 1 : targetIdx;
      phasesInProject.splice(targetIdx, 0, moved);
      
      phasesInProject.forEach((p, i) => p.order = i);
      saveProjectPhases([...otherPhases, ...phasesInProject]);
    }
    else if (draggedType === 'wp' && targetType === 'wp') {
      // Arbeitspaket verschieben (nur innerhalb derselben Phase)
      const draggedWP = workPackages.find(w => w.id === draggedId);
      const targetWP = workPackages.find(w => w.id === targetId);
      if (!draggedWP || !targetWP || draggedWP.phaseId !== targetWP.phaseId) return;
      
      const phaseId = draggedWP.phaseId;
      const wpsInPhase = workPackages.filter(w => w.phaseId === phaseId);
      const otherWPs = workPackages.filter(w => w.phaseId !== phaseId);
      
      const draggedIdx = wpsInPhase.findIndex(w => w.id === draggedId);
      let targetIdx = wpsInPhase.findIndex(w => w.id === targetId);
      if (draggedIdx === targetIdx) return;
      
      const [moved] = wpsInPhase.splice(draggedIdx, 1);
      if (position === 'after') targetIdx = targetIdx >= draggedIdx ? targetIdx : targetIdx + 1;
      else targetIdx = targetIdx > draggedIdx ? targetIdx - 1 : targetIdx;
      wpsInPhase.splice(targetIdx, 0, moved);
      
      wpsInPhase.forEach((w, i) => w.order = i);
      saveWorkPackages([...otherWPs, ...wpsInPhase]);
    }
  };

  const toggleVacation = (userId, date) => {
    // Scroll-Position speichern
    if (ganttScrollRef.current) {
      setSavedScrollPosition(ganttScrollRef.current.scrollLeft);
    }
    
    const dateStr = formatDate(date);
    const existing = vacations.find(v => v.userId === userId && v.date === dateStr);
    if (existing) {
      saveVacations(vacations.filter(v => !(v.userId === userId && v.date === dateStr)));
    } else {
      saveVacations([...vacations, {id: 'v' + Date.now(), userId, date: dateStr}]);
    }
  };

  const isVacation = (userId, date) => {
    const dateStr = formatDate(date);
    return vacations.some(v => v.userId === userId && v.date === dateStr);
  };
  
  const getVacationType = (userId, date) => {
    const dateStr = typeof date === 'string' ? date : formatDate(date);
    const v = vacations.find(v => v.userId === userId && v.date === dateStr);
    return v?.type || 'urlaub';
  };
  
  // Batch: mehrere Tage auf einmal als frei setzen/entfernen
  const setVacationBatch = (userId, dateStrings, mode, type = 'urlaub') => {
    if (mode === 'add') {
      // Bestehende updaten oder neue hinzuf√ºgen
      let updated = vacations.filter(v => !(v.userId === userId && dateStrings.includes(v.date)));
      const toAdd = dateStrings.map((ds, i) => ({ id: 'v' + Date.now() + '_' + i, userId, date: ds, type }));
      saveVacations([...updated, ...toAdd]);
    } else {
      saveVacations(vacations.filter(v => !(v.userId === userId && dateStrings.includes(v.date))));
    }
  };

  const addTask = (uid, pid, date, sh, eh) => {
    const td = new Date(date);
    td.setHours(12, 0, 0, 0);
    saveTasks([...tasks, {
      id: 't' + Date.now(), userId: uid, projectId: pid,
      startDate: formatDate(td), endDate: formatDate(td),
      startHour: sh, endHour: eh
    }]);
  };

  // NEU: Kopiere Tasks aus Vorwoche
  const copyTasksFromPreviousWeek = (userId, targetWeekNum) => {
    // Scroll-Position speichern
    if (ganttScrollRef.current) {
      setSavedScrollPosition(ganttScrollRef.current.scrollLeft);
    }
    
    const sourceWeekNum = targetWeekNum - 1;
    const sourceWeekDates = getWeekDates(sourceWeekNum, currentYear);
    const targetWeekDates = getWeekDates(targetWeekNum, currentYear);
    
    if (sourceWeekDates.length === 0 || targetWeekDates.length === 0) return;
    
    const sourceStartDate = formatDate(sourceWeekDates[0]);
    const sourceEndDate = formatDate(sourceWeekDates[6]);
    const targetStartDate = formatDate(targetWeekDates[0]);
    
    // Finde alle Tasks der Vorwoche
    const previousWeekTasks = tasks.filter(t => 
      t.userId === userId && 
      t.startDate >= sourceStartDate && 
      t.startDate <= sourceEndDate
    );
    
    if (previousWeekTasks.length === 0) {
      alert('Keine Planung in der Vorwoche gefunden!');
      return;
    }
    
    // Berechne Tages-Offset
    const daysDiff = 7;
    
    // Kopiere Tasks
    const newTasks = previousWeekTasks.map(t => {
      const oldStart = new Date(t.startDate + 'T12:00:00');
      const oldEnd = new Date(t.endDate + 'T12:00:00');
      const newStart = new Date(oldStart);
      newStart.setDate(newStart.getDate() + daysDiff);
      const newEnd = new Date(oldEnd);
      newEnd.setDate(newEnd.getDate() + daysDiff);
      
      return {
        id: 't' + Date.now() + '_' + Math.random(),
        userId: t.userId,
        projectId: t.projectId,
        startDate: formatDate(newStart),
        endDate: formatDate(newEnd),
        startHour: t.startHour,
        endHour: t.endHour
      };
    });
    
    saveTasks([...tasks, ...newTasks]);
    alert(`${previousWeekTasks.length} Aufgabe(n) aus Vorwoche kopiert!`);
  };
  
  // NEU: Kopiere einzelnen Task in n√§chste Woche
  const copyTaskToNextWeek = (task) => {
    // Scroll-Position speichern
    if (ganttScrollRef.current) {
      setSavedScrollPosition(ganttScrollRef.current.scrollLeft);
    }
    
    const oldStart = new Date(task.startDate + 'T12:00:00');
    const oldEnd = new Date(task.endDate + 'T12:00:00');
    const newStart = new Date(oldStart);
    newStart.setDate(newStart.getDate() + 7);
    const newEnd = new Date(oldEnd);
    newEnd.setDate(newEnd.getDate() + 7);
    
    const newTask = {
      id: 't' + Date.now(),
      userId: task.userId,
      projectId: task.projectId,
      startDate: formatDate(newStart),
      endDate: formatDate(newEnd),
      startHour: task.startHour,
      endHour: task.endHour
    };
    
    saveTasks([...tasks, newTask]);
  };

  const updateTask = (id, upd) => saveTasks(tasks.map(t => t.id === id ? { ...t, ...upd } : t));
  const deleteTask = (id) => {
    // Scroll-Position speichern
    if (ganttScrollRef.current) {
      setSavedScrollPosition(ganttScrollRef.current.scrollLeft);
    }
    saveTasks(tasks.filter(t => t.id !== id));
  };

  const getWeekNote = (userId, weekNum) => {
    return notes.find(n => n.userId === userId && n.week === weekNum && n.year === currentYear);
  };

  const updateWeekNote = (userId, weekNum, text) => {
    const existing = notes.find(n => n.userId === userId && n.week === weekNum && n.year === currentYear);
    if (existing) {
      saveNotes(notes.map(n => n.userId === userId && n.week === weekNum && n.year === currentYear ? {...n, text} : n));
    } else {
      saveNotes([...notes, {id: 'n' + Date.now(), userId, week: weekNum, year: currentYear, text}]);
    }
  };

  const getTeamMembers = (teamId) => users.filter(u => u.teamId === teamId && u.role !== 'admin');

  // Arbeitsplan eines Users f√ºr einen konkreten Tag
  const getDaySchedule = (user, date) => {
    const dow = date.getDay();
    if (dow === 0 || dow === 6) return {start:0, end:0, break1Duration:0, break2Duration:0};
    return (user.dailySchedule || DEFAULT_SCHEDULE)[dow] || {start:8, end:17, break1Start:9, break1Duration:0.25, break2Start:12.5, break2Duration:0.75};
  };
  // Arbeitsstunden an einem Tag (= end ‚àí start ‚àí pause1 ‚àí pause2, oder 0 wenn frei)
  const getDailyHours = (user, date) => {
    const s = getDaySchedule(user, date);
    const gross = s.end > s.start ? s.end - s.start : 0;
    const break1 = s.break1Duration || 0;
    const break2 = (s.end > 13) ? (s.break2Duration || 0) : 0; // Pause 2 nur bei Vollzeit
    return Math.max(0, gross - break1 - break2);
  };
  const isNonWorkingDay = (user, date) => getDailyHours(user, date) === 0;
  // Pr√ºft ob eine bestimmte Stunde (z.B. 9 = 9:00‚Äì10:00) innerhalb des Arbeitsplans liegt
  const isWorkingHour = (user, date, hour) => {
    const s = getDaySchedule(user, date);
    // Eine Stunden-Zelle ist "Arbeitszeit" wenn irgendein Teil davon in der Arbeitszeit liegt
    // Beispiel: hour=7 (7:00-8:00), s.start=7.5 (7:30) ‚Üí hour+1 > 7.5 ‚Üí true
    return (hour + 1) > s.start && hour < s.end;
  };
  // Wochenkapazit√§t eines Users (Urlaub-Tage werden abgezogen)
  const getWeekCapacity = (user, weekDates) => {
    return weekDates.reduce((sum, d) => {
      if (isVacation(user.id, d)) return sum;
      return sum + getDailyHours(user, d);
    }, 0);
  };

  useEffect(() => {
    const handleMouseMove = (e) => {
      if (draggedTask) {
        const dx = e.clientX - draggedTask.startX;
        const dy = e.clientY - draggedTask.startY;
        const daysMoved = Math.round(dx / DW);
        const hoursMoved = Math.round(dy / HH * 4) / 4; // 0,25h Schritte!
        const st = new Date(draggedTask.task.startDate);
        const newSt = new Date(st);
        newSt.setDate(st.getDate() + daysMoved);
        const ed = new Date(draggedTask.task.endDate);
        const newEd = new Date(ed);
        newEd.setDate(ed.getDate() + daysMoved);
        const newSh = Math.max(GRID_START, Math.min(GRID_END - 1, draggedTask.task.startHour - hoursMoved));
        const newEh = Math.max(GRID_START + 1, Math.min(GRID_END, draggedTask.task.endHour - hoursMoved));
        setDraggedTask({ ...draggedTask, previewStartDate: formatDate(newSt), previewEndDate: formatDate(newEd), previewStartHour: newSh, previewEndHour: newEh });
      }
      if (resizingTask) {
        if (resizingTask.dir === 'right') {
          const dx = e.clientX - resizingTask.startX;
          const daysMoved = Math.round(dx / DW);
          const ed = new Date(resizingTask.task.endDate);
          const newEd = new Date(ed);
          newEd.setDate(ed.getDate() + daysMoved);
          setResizingTask({ ...resizingTask, previewEndDate: formatDate(newEd) });
        } else if (resizingTask.dir === 'top') {
          const dy = e.clientY - resizingTask.startY;
          const hoursMoved = Math.round(dy / HH * 4) / 4; // 0,25h Schritte!
          const newEh = Math.max(resizingTask.task.startHour + 1, Math.min(GRID_END, resizingTask.origEnd - hoursMoved));
          setResizingTask({ ...resizingTask, previewEndHour: newEh });
        } else if (resizingTask.dir === 'bottom') {
          const dy = e.clientY - resizingTask.startY;
          const hoursMoved = Math.round(dy / HH * 4) / 4; // 0,25h Schritte!
          const newSh = Math.max(GRID_START, Math.min(resizingTask.task.endHour - 1, resizingTask.origStart - hoursMoved));
          setResizingTask({ ...resizingTask, previewStartHour: newSh });
        }
      }
    };
    const handleMouseUp = () => {
      if (draggedTask && draggedTask.previewStartDate) {
        updateTask(draggedTask.task.id, {
          startDate: draggedTask.previewStartDate, endDate: draggedTask.previewEndDate,
          startHour: draggedTask.previewStartHour, endHour: draggedTask.previewEndHour
        });
      }
      if (resizingTask) {
        const upd = {};
        if (resizingTask.previewEndDate) upd.endDate = resizingTask.previewEndDate;
        if (resizingTask.previewEndHour !== undefined) upd.endHour = resizingTask.previewEndHour;
        if (resizingTask.previewStartHour !== undefined) upd.startHour = resizingTask.previewStartHour;
        if (Object.keys(upd).length > 0) updateTask(resizingTask.task.id, upd);
      }
      setDraggedTask(null);
      setResizingTask(null);
    };
    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
    return () => {
      document.removeEventListener('mousemove', handleMouseMove);
      document.removeEventListener('mouseup', handleMouseUp);
    };
  }, [draggedTask, resizingTask, tasks]);

  const AdminPanel = () => {
    const [localUsers, setLocalUsers] = React.useState(users);
    const [localTeams, setLocalTeams] = React.useState(teams);
    const [localDivisions, setLocalDivisions] = React.useState(divisions);
    const [localDepartments, setLocalDepartments] = React.useState(departments);
    const [localResources, setLocalResources] = React.useState(resources);
    const [expandedUsers, setExpandedUsers] = [adminExpandedUsers, setAdminExpandedUsers];
    const [expandedResources, setExpandedResources] = [adminExpandedResources, setAdminExpandedResources];
    const [userSort, setUserSort] = [adminUserSort, setAdminUserSort];
    const [resourceSort, setResourceSort] = [adminResourceSort, setAdminResourceSort];
    React.useEffect(() => { setLocalUsers(users); }, [users]);
    React.useEffect(() => { setLocalTeams(teams); }, [teams]);
    React.useEffect(() => { setLocalDivisions(divisions); }, [divisions]);
    React.useEffect(() => { setLocalDepartments(departments); }, [departments]);
    React.useEffect(() => { setLocalResources(resources); }, [resources]);
    
    // Scroll-Position speichern vor Update
    const saveScrollPosition = () => {
      if (adminScrollRef.current) {
        setLastScrollPosition(adminScrollRef.current.scrollTop);
      }
    };
    
    // Scroll-Position wiederherstellen nach Update
    React.useEffect(() => {
      if (adminScrollRef.current && lastScrollPosition > 0) {
        adminScrollRef.current.scrollTop = lastScrollPosition;
      }
    }, [localUsers]);
    
    return (
      <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 mobile-padding">
        <div className="bg-white rounded-2xl w-[95%] max-w-[900px] max-h-[95vh] flex flex-col admin-modal">
          <div className="flex justify-between items-center px-5 py-3 border-b flex-shrink-0">
            <h2 className="text-lg font-bold">Admin Panel</h2>
            <button onClick={() => setShowAdmin(false)} className="text-xl text-gray-400 hover:text-gray-600">‚úï</button>
          </div>
          <div ref={adminScrollRef} className="flex-1 overflow-y-auto p-4 space-y-2 text-xs">
            
            {/* BEREICHE */}
            {localDepartments.sort((a,b) => a.name.localeCompare(b.name)).map(dept => {
              const deptExpanded = expandedUsers['dept_' + dept.id];
              const deptDivisions = localDivisions.filter(d => d.departmentId === dept.id).sort((a,b) => a.name.localeCompare(b.name));
              return (
                <div key={dept.id} className="border rounded-lg overflow-hidden">
                  {/* Bereich Header */}
                  <div className="flex items-center gap-2 px-3 py-2 bg-slate-100 cursor-pointer hover:bg-slate-200" onClick={() => setExpandedUsers({...expandedUsers, ['dept_' + dept.id]: !deptExpanded})}>
                    <span className="text-gray-400 text-[10px]">{deptExpanded ? '‚ñº' : '‚ñ∂'}</span>
                    <div className="w-2 h-2 rounded-full bg-slate-500" />
                    <input type="text" value={dept.name} onClick={e => e.stopPropagation()} onChange={(e) => setLocalDepartments(localDepartments.map(x => x.id === dept.id ? {...x, name: e.target.value} : x))} onBlur={() => saveDepartments(localDepartments)} className="flex-1 bg-transparent font-semibold text-xs border-0 p-0 focus:outline-none focus:bg-white focus:px-1 focus:rounded" />
                    <span className="text-[10px] text-gray-400">{deptDivisions.length} Abt.</span>
                    <button onClick={(e) => { e.stopPropagation(); if (deptDivisions.length > 0) return alert('Bereich hat noch Abteilungen.'); if (confirm(`"${dept.name}" l√∂schen?`)) { const n = localDepartments.filter(x => x.id !== dept.id); setLocalDepartments(n); saveDepartments(n); }}} className="p-0.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded"><Trash2 className="w-3 h-3" /></button>
                  </div>
                  
                  {deptExpanded && (
                    <div className="px-3 py-2 space-y-1.5 bg-white">
                      {/* Abteilungen im Bereich */}
                      {deptDivisions.map(div => {
                        const divExpanded = expandedUsers['div_' + div.id];
                        const divTeams = localTeams.filter(t => t.divisionId === div.id).sort((a,b) => a.name.localeCompare(b.name));
                        const divResources = localResources.filter(r => r.abteilungId === div.id).sort((a,b) => a.name.localeCompare(b.name));
                        return (
                          <div key={div.id} className="border rounded-md overflow-hidden ml-3">
                            <div className="flex items-center gap-2 px-2.5 py-1.5 bg-blue-50 cursor-pointer hover:bg-orange-50" onClick={() => setExpandedUsers({...expandedUsers, ['div_' + div.id]: !divExpanded})}>
                              <span className="text-gray-400 text-[10px]">{divExpanded ? '‚ñº' : '‚ñ∂'}</span>
                              <div className="w-1.5 h-1.5 rounded-full bg-blue-500" />
                              <input type="text" value={div.name} onClick={e => e.stopPropagation()} onChange={(e) => setLocalDivisions(localDivisions.map(x => x.id === div.id ? {...x, name: e.target.value} : x))} onBlur={() => saveDivisions(localDivisions)} className="flex-1 bg-transparent font-medium text-xs border-0 p-0 focus:outline-none focus:bg-white focus:px-1 focus:rounded" />
                              <span className="text-[10px] text-gray-400">{divTeams.length}T {divResources.length}R</span>
                              <button onClick={(e) => { e.stopPropagation(); if (divTeams.length > 0) return alert('Abteilung hat noch Teams.'); if (confirm(`"${div.name}" l√∂schen?`)) { const n = localDivisions.filter(x => x.id !== div.id); setLocalDivisions(n); saveDivisions(n); }}} className="p-0.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded"><Trash2 className="w-3 h-3" /></button>
                            </div>
                            
                            {divExpanded && (
                              <div className="px-2.5 py-1.5 space-y-1.5 bg-white">
                                {/* Teams */}
                                {divTeams.map(team => {
                                  const teamExpanded = expandedUsers['team_' + team.id];
                                  const teamUsers = localUsers.filter(u => u.teamId === team.id && u.role !== 'admin').sort((a,b) => a.name.localeCompare(b.name));
                                  return (
                                    <div key={team.id} className="border rounded overflow-hidden ml-3">
                                      <div className="flex items-center gap-2 px-2 py-1.5 bg-indigo-50 cursor-pointer hover:bg-indigo-100" onClick={() => setExpandedUsers({...expandedUsers, ['team_' + team.id]: !teamExpanded})}>
                                        <span className="text-gray-400 text-[10px]">{teamExpanded ? '‚ñº' : '‚ñ∂'}</span>
                                        <div className="w-1.5 h-1.5 rounded-full bg-indigo-500" />
                                        <input type="text" value={team.name} onClick={e => e.stopPropagation()} onChange={(e) => setLocalTeams(localTeams.map(x => x.id === team.id ? {...x, name: e.target.value} : x))} onBlur={() => saveTeams(localTeams)} className="flex-1 bg-transparent font-medium text-xs border-0 p-0 focus:outline-none focus:bg-white focus:px-1 focus:rounded" />
                                        <span className="text-[10px] text-gray-400">{teamUsers.length} Pers.</span>
                                        <button onClick={(e) => { e.stopPropagation(); if (teamUsers.length > 0) return alert('Team hat noch Benutzer.'); if (confirm(`"${team.name}" l√∂schen?`)) { const n = localTeams.filter(x => x.id !== team.id); setLocalTeams(n); saveTeams(n); }}} className="p-0.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded"><Trash2 className="w-3 h-3" /></button>
                                      </div>
                                      
                                      {teamExpanded && (
                                        <div className="px-2 py-1 space-y-1 bg-white">
                                          {/* Benutzer */}
                                          {teamUsers.map(u => {
                                            const uExpanded = expandedUsers[u.id];
                                            const sched = u.dailySchedule || DEFAULT_SCHEDULE;
                                            const weekH = [1,2,3,4,5].reduce((s,d) => { const ds=sched[d]||{start:8,end:17,break1Duration:0.25,break2Duration:0.75}; const g=ds.end>ds.start?ds.end-ds.start:0; return s+Math.max(0,g-(ds.break1Duration||0)-((ds.end>13)?(ds.break2Duration||0):0)); }, 0);
                                            const roleLabel = u.teamRole === 'entrepreneur' ? 'UNT' : u.teamRole === 'department_head' ? 'BL' : u.teamRole === 'lead' ? 'FK' : u.teamRole === 'responsible' ? 'V' : 'B';
                                            return (
                                              <div key={u.id} className="border rounded overflow-hidden ml-3">
                                                <div className="flex items-center gap-1.5 px-2 py-1 bg-gray-50 cursor-pointer hover:bg-gray-100" onClick={() => setExpandedUsers({...expandedUsers, [u.id]: !uExpanded})}>
                                                  <span className="text-gray-400 text-[10px]">{uExpanded ? '‚ñº' : '‚ñ∂'}</span>
                                                  <span className="text-[10px] px-1 py-0.5 rounded bg-indigo-100 text-indigo-600 font-medium">{roleLabel}</span>
                                                  <span className="font-medium truncate flex-1">{u.name}</span>
                                                  <span className="text-[10px] text-gray-400">{weekH}h/W</span>
                                                  <button onClick={(e) => { e.stopPropagation(); if (tasks.some(t => t.userId === u.id)) return alert('Benutzer hat noch Tasks.'); if (confirm(`"${u.name}" l√∂schen?`)) { const n = localUsers.filter(x => x.id !== u.id); setLocalUsers(n); saveUsers(n); }}} className="p-0.5 text-red-400 hover:text-red-600 rounded"><Trash2 className="w-3 h-3" /></button>
                                                </div>
                                                {uExpanded && (
                                                  <div className="px-2 py-1.5 space-y-1.5 bg-white">
                                                    <input type="text" value={u.name} onChange={(e) => setLocalUsers(localUsers.map(x => x.id === u.id ? {...x, name: e.target.value} : x))} onBlur={() => saveUsers(localUsers)} className="w-full p-1.5 border rounded text-xs" placeholder="Name" />
                                                    <div className="flex gap-1.5">
                                                      <select value={u.teamId || ''} onChange={(e) => { const n = localUsers.map(x => x.id === u.id ? {...x, teamId: e.target.value} : x); setLocalUsers(n); saveUsers(n); }} className="flex-1 p-1.5 border rounded text-xs">
                                                        <option value="">Kein Team</option>
                                                        {localTeams.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}
                                                      </select>
                                                      <select value={u.teamRole || 'editor'} onChange={(e) => { const n = localUsers.map(x => x.id === u.id ? {...x, teamRole: e.target.value} : x); setLocalUsers(n); saveUsers(n); }} className="w-32 p-1.5 border rounded text-xs">
                                                        <option value="entrepreneur">Unternehmer</option>
                                                        <option value="department_head">Bereichsleitung</option>
                                                        <option value="lead">F√ºhrungskraft</option>
                                                        <option value="responsible">Verantwortlicher</option>
                                                        <option value="editor">Bearbeiter</option>
                                                      </select>
                                                    </div>
                                                    {(u.teamRole === 'department_head' || u.teamRole === 'entrepreneur') && (
                                                      <select value={u.departmentId || ''} onChange={(e) => { const n = localUsers.map(x => x.id === u.id ? {...x, departmentId: e.target.value || null} : x); setLocalUsers(n); saveUsers(n); }} className="w-full p-1.5 border rounded text-xs bg-yellow-50">
                                                        <option value="">Kein Bereich (sieht alle)</option>
                                                        {localDepartments.map(d => <option key={d.id} value={d.id}>{d.name}</option>)}
                                                      </select>
                                                    )}
                                                    {/* Arbeitszeiten kompakt */}
                                                    <div className="p-1.5 bg-gray-50 rounded border space-y-1">
                                                      <div className="flex items-center justify-between">
                                                        <div className="text-[10px] font-semibold text-gray-500">Arbeitszeiten</div>
                                                        <span className="text-[10px] font-medium px-1.5 py-0.5 rounded bg-indigo-50 text-indigo-600">{weekH}h/W</span>
                                                      </div>
                                                      {[{d:1,l:'Mo'},{d:2,l:'Di'},{d:3,l:'Mi'},{d:4,l:'Do'},{d:5,l:'Fr'}].map(({d,l}) => {
                                                        const dayS = sched[d] || {start:8, end:17, break1Start:9, break1Duration:0.25, break2Start:12.5, break2Duration:0.75};
                                                        const isOff = dayS.start >= dayS.end || (dayS.start === 0 && dayS.end === 0);
                                                        const toggleOff = () => { const ns = {...sched, [d]: isOff ? {start:8,end:17,break1Start:9,break1Duration:0.25,break2Start:12.5,break2Duration:0.75} : {start:0,end:0,break1Duration:0,break2Duration:0}}; const n = localUsers.map(x => x.id === u.id ? {...x, dailySchedule: ns} : x); setLocalUsers(n); saveUsers(n); };
                                                        const setVal = (field, raw) => { const val = (field === 'break1Duration' || field === 'break2Duration') ? parseFloat(raw) || 0 : t2h(raw); const ns = {...sched, [d]: {...dayS, [field]: val}}; const n = localUsers.map(x => x.id === u.id ? {...x, dailySchedule: ns} : x); setLocalUsers(n); saveUsers(n); };
                                                        const gross = dayS.end > dayS.start ? dayS.end - dayS.start : 0;
                                                        const net = Math.max(0, gross - (dayS.break1Duration||0) - ((dayS.end>13)?(dayS.break2Duration||0):0));
                                                        return (
                                                          <div key={d} className="space-y-0.5">
                                                            <div className="flex items-center gap-1">
                                                              <button onClick={toggleOff} className={`w-6 text-center text-[10px] font-medium rounded py-0.5 ${isOff ? 'bg-gray-200 text-gray-400' : 'bg-indigo-100 text-indigo-700'}`}>{l}</button>
                                                              {isOff ? <span className="text-[10px] text-gray-400 italic">frei</span> : (
                                                                <React.Fragment>
                                                                  <input type="text" defaultValue={h2t(dayS.start)} key={`s-${u.id}-${d}-${dayS.start}`} onBlur={(e) => { const f = formatTimeInput(e.target.value); if (f) setVal('start', f); }} className="w-12 border rounded px-1 py-0.5 text-[10px] text-center" />
                                                                  <span className="text-gray-300">‚Äì</span>
                                                                  <input type="text" defaultValue={h2t(dayS.end)} key={`e-${u.id}-${d}-${dayS.end}`} onBlur={(e) => { const f = formatTimeInput(e.target.value); if (f) setVal('end', f); }} className="w-12 border rounded px-1 py-0.5 text-[10px] text-center" />
                                                                  <span className="text-[10px] text-gray-400 ml-auto">{net.toFixed(1)}h</span>
                                                                </React.Fragment>
                                                              )}
                                                            </div>
                                                            {!isOff && (
                                                              <div className="ml-7 flex items-center gap-1 text-[10px] text-gray-400">
                                                                <span className="w-5">P1:</span>
                                                                <input type="text" defaultValue={h2t(dayS.break1Start || 9)} key={`b1s-${u.id}-${d}-${dayS.break1Start}`} onBlur={(e) => { const f = formatTimeInput(e.target.value); if (f) setVal('break1Start', f); }} className="w-11 border rounded px-0.5 py-0.5 text-[10px] text-center text-gray-600" />
                                                                <span>‚Äì</span>
                                                                <input type="text" defaultValue={h2t((dayS.break1Start || 9) + (dayS.break1Duration || 0.25))} key={`b1e-${u.id}-${d}-${dayS.break1Duration}`} onBlur={(e) => { const f = formatTimeInput(e.target.value); if (f) { const dur = Math.max(0, t2h(f) - (dayS.break1Start || 9)); setVal('break1Duration', dur.toString()); }}} className="w-11 border rounded px-0.5 py-0.5 text-[10px] text-center text-gray-600" />
                                                                <span className="mx-1">P2:</span>
                                                                <input type="text" defaultValue={h2t(dayS.break2Start || 12.5)} key={`b2s-${u.id}-${d}-${dayS.break2Start}`} onBlur={(e) => { const f = formatTimeInput(e.target.value); if (f) setVal('break2Start', f); }} className="w-11 border rounded px-0.5 py-0.5 text-[10px] text-center text-gray-600" />
                                                                <span>‚Äì</span>
                                                                <input type="text" defaultValue={h2t((dayS.break2Start || 12.5) + (dayS.break2Duration || 0.75))} key={`b2e-${u.id}-${d}-${dayS.break2Duration}`} onBlur={(e) => { const f = formatTimeInput(e.target.value); if (f) { const dur = Math.max(0, t2h(f) - (dayS.break2Start || 12.5)); setVal('break2Duration', dur.toString()); }}} className="w-11 border rounded px-0.5 py-0.5 text-[10px] text-center text-gray-600" />
                                                              </div>
                                                            )}
                                                          </div>
                                                        );
                                                      })}
                                                    </div>
                                                  </div>
                                                )}
                                              </div>
                                            );
                                          })}
                                          <button onClick={() => {
                                            const nu = { id: 'p' + Date.now(), name: 'Neue Person', role: 'member', teamId: team.id, teamRole: 'editor', dailySchedule: {1:{start:8,end:17,break1Start:9,break1Duration:0.25,break2Start:12.5,break2Duration:0.75},2:{start:8,end:17,break1Start:9,break1Duration:0.25,break2Start:12.5,break2Duration:0.75},3:{start:8,end:17,break1Start:9,break1Duration:0.25,break2Start:12.5,break2Duration:0.75},4:{start:8,end:17,break1Start:9,break1Duration:0.25,break2Start:12.5,break2Duration:0.75},5:{start:8,end:17,break1Start:9,break1Duration:0.25,break2Start:12.5,break2Duration:0.75}}, departmentId: null };
                                            const n = [...localUsers, nu]; setLocalUsers(n); saveUsers(n); setExpandedUsers({...expandedUsers, [nu.id]: true});
                                          }} className="w-full ml-3 py-1 text-[10px] text-indigo-600 hover:bg-indigo-50 rounded border border-dashed border-indigo-300 flex items-center justify-center gap-1">
                                            <Plus className="w-3 h-3" /> Person
                                          </button>
                                        </div>
                                      )}
                                    </div>
                                  );
                                })}
                                
                                {/* Ressourcen der Abteilung */}
                                {divResources.length > 0 && (
                                  <div className="ml-3 mt-1">
                                    <div className="text-[10px] font-semibold text-gray-400 uppercase tracking-wide mb-1">Ressourcen</div>
                                    {divResources.map(r => {
                                      const rExpanded = expandedResources[r.id];
                                      const typeIcon = r.type === 'maschine' ? 'üè≠' : r.type === 'werkzeug' ? 'üîß' : 'üöõ';
                                      return (
                                        <div key={r.id} className="border rounded overflow-hidden ml-0 mb-1">
                                          <div className="flex items-center gap-1.5 px-2 py-1 bg-amber-50 cursor-pointer hover:bg-amber-100" onClick={() => setExpandedResources({...expandedResources, [r.id]: !rExpanded})}>
                                            <span className="text-gray-400 text-[10px]">{rExpanded ? '‚ñº' : '‚ñ∂'}</span>
                                            <span className="text-[10px]">{typeIcon}</span>
                                            <span className="font-medium truncate flex-1">{r.name}</span>
                                            {r.type === 'maschine' && r.schichtmodell > 1 && <span className="text-[10px] text-gray-400">{r.schichtmodell}S</span>}
                                            {r.kuerzel && <span className="text-[10px] px-1 py-0.5 rounded bg-gray-100 font-mono">{r.kuerzel}</span>}
                                            <button onClick={(e) => { e.stopPropagation(); if (confirm(`"${r.name}" l√∂schen?`)) { const n = localResources.filter(x => x.id !== r.id); setLocalResources(n); saveResources(n); }}} className="p-0.5 text-red-400 hover:text-red-600 rounded"><Trash2 className="w-3 h-3" /></button>
                                          </div>
                                          {rExpanded && (
                                            <div className="px-2 py-1.5 space-y-1.5 bg-white">
                                              <input type="text" value={r.name} onChange={(e) => setLocalResources(localResources.map(x => x.id === r.id ? {...x, name: e.target.value} : x))} onBlur={() => saveResources(localResources)} className="w-full p-1.5 border rounded text-xs" />
                                              <div className="flex gap-1.5">
                                                <select value={r.type || 'maschine'} onChange={(e) => { const n = localResources.map(x => x.id === r.id ? {...x, type: e.target.value} : x); setLocalResources(n); saveResources(n); }} className="flex-1 p-1.5 border rounded text-xs">
                                                  <option value="maschine">üè≠ Maschine</option>
                                                  <option value="werkzeug">üîß Werkzeug</option>
                                                  <option value="fahrzeug">üöõ Fahrzeug</option>
                                                </select>
                                                <select value={r.abteilungId || ''} onChange={(e) => { const n = localResources.map(x => x.id === r.id ? {...x, abteilungId: e.target.value || null} : x); setLocalResources(n); saveResources(n); }} className="flex-1 p-1.5 border rounded text-xs">
                                                  <option value="">Keine Abt.</option>
                                                  {localDivisions.map(d => <option key={d.id} value={d.id}>{d.name}</option>)}
                                                </select>
                                              </div>
                                              {r.type === 'maschine' && (
                                                <div className="flex items-center gap-2">
                                                  <span className="text-[10px] text-gray-500">Schicht:</span>
                                                  {[1,2,3].map(s => (
                                                    <button key={s} onClick={() => { const n = localResources.map(x => x.id === r.id ? {...x, schichtmodell: s} : x); setLocalResources(n); saveResources(n); }} className={`px-2 py-0.5 rounded text-[10px] font-medium ${r.schichtmodell === s ? 'bg-indigo-600 text-white' : 'bg-gray-100 hover:bg-gray-200'}`}>{s}S</button>
                                                  ))}
                                                  <span className="text-[10px] text-gray-500 ml-2">h/S:</span>
                                                  <input type="number" value={r.stundenProSchicht || 8} min="1" max="12" step="0.5" onChange={(e) => { const n = localResources.map(x => x.id === r.id ? {...x, stundenProSchicht: parseFloat(e.target.value) || 8} : x); setLocalResources(n); saveResources(n); }} className="w-12 p-1 border rounded text-[10px] text-center" />
                                                </div>
                                              )}
                                              {r.type === 'fahrzeug' && <input type="text" value={r.kennzeichen || ''} onChange={(e) => setLocalResources(localResources.map(x => x.id === r.id ? {...x, kennzeichen: e.target.value} : x))} onBlur={() => saveResources(localResources)} className="w-full p-1.5 border rounded text-xs" placeholder="Kennzeichen" />}
                                              <div className="flex items-center gap-2">
                                                <span className="text-[10px] text-gray-500">K√ºrzel:</span>
                                                <input type="text" value={r.kuerzel || ''} maxLength="4" onChange={(e) => setLocalResources(localResources.map(x => x.id === r.id ? {...x, kuerzel: e.target.value.toUpperCase()} : x))} onBlur={() => saveResources(localResources)} className="w-14 p-1 border rounded text-[10px] text-center font-mono" placeholder="CNC1" />
                                                <span className="text-[10px] text-gray-500">Farbe:</span>
                                                <input type="color" value={r.farbe || '#6366f1'} onChange={(e) => { const n = localResources.map(x => x.id === r.id ? {...x, farbe: e.target.value} : x); setLocalResources(n); saveResources(n); }} className="w-6 h-6 rounded cursor-pointer border-0" />
                                              </div>
                                            </div>
                                          )}
                                        </div>
                                      );
                                    })}
                                  </div>
                                )}
                                
                                {/* Add-Buttons */}
                                <div className="flex gap-1.5 ml-3 mt-1">
                                  <button onClick={() => {
                                    const nt = { id: 'team' + Date.now(), name: 'Neues Team', divisionId: div.id };
                                    const n = [...localTeams, nt]; setLocalTeams(n); saveTeams(n); setExpandedUsers({...expandedUsers, ['team_' + nt.id]: true});
                                  }} className="flex-1 py-1 text-[10px] text-indigo-600 hover:bg-indigo-50 rounded border border-dashed border-indigo-300 flex items-center justify-center gap-1">
                                    <Plus className="w-3 h-3" /> Team
                                  </button>
                                  <button onClick={() => {
                                    const nr = { id: 'res_' + Date.now(), name: 'Neue Ressource', type: 'maschine', abteilungId: div.id, schichtmodell: 1, stundenProSchicht: 8, kuerzel: '', kennzeichen: '', farbe: '#6366f1' };
                                    const n = [...localResources, nr]; setLocalResources(n); saveResources(n); setExpandedResources({...expandedResources, [nr.id]: true});
                                  }} className="flex-1 py-1 text-[10px] text-orange-600 hover:bg-amber-50 rounded border border-dashed border-amber-300 flex items-center justify-center gap-1">
                                    <Plus className="w-3 h-3" /> Ressource
                                  </button>
                                </div>
                              </div>
                            )}
                          </div>
                        );
                      })}
                      
                      {/* Abteilung hinzuf√ºgen im Bereich */}
                      <button onClick={() => {
                        const nd = { id: 'div' + Date.now(), name: 'Neue Abteilung', departmentId: dept.id };
                        const n = [...localDivisions, nd]; setLocalDivisions(n); saveDivisions(n); setExpandedUsers({...expandedUsers, ['div_' + nd.id]: true});
                      }} className="w-full ml-3 py-1 text-[10px] text-blue-600 hover:bg-blue-50 rounded border border-dashed border-blue-300 flex items-center justify-center gap-1">
                        <Plus className="w-3 h-3" /> Abteilung
                      </button>
                    </div>
                  )}
                </div>
              );
            })}
            
            {/* Nicht zugeordnete Elemente */}
            {(() => {
              const orphanDivisions = localDivisions.filter(d => !d.departmentId || !localDepartments.some(dep => dep.id === d.departmentId));
              const orphanTeams = localTeams.filter(t => !t.divisionId || !localDivisions.some(d => d.id === t.divisionId));
              const orphanUsers = localUsers.filter(u => u.role !== 'admin' && (!u.teamId || !localTeams.some(t => t.id === u.teamId)));
              const orphanResources = localResources.filter(r => !r.abteilungId || !localDivisions.some(d => d.id === r.abteilungId));
              if (orphanDivisions.length === 0 && orphanTeams.length === 0 && orphanUsers.length === 0 && orphanResources.length === 0) return null;
              const orphExpanded = expandedUsers['_orphans'];
              return (
                <div className="border rounded-lg overflow-hidden border-orange-200">
                  <div className="flex items-center gap-2 px-3 py-2 bg-orange-50 cursor-pointer hover:bg-orange-100" onClick={() => setExpandedUsers({...expandedUsers, ['_orphans']: !orphExpanded})}>
                    <span className="text-gray-400 text-[10px]">{orphExpanded ? '‚ñº' : '‚ñ∂'}</span>
                    <span className="font-semibold text-xs text-orange-700">‚ö† Nicht zugeordnet</span>
                    <span className="text-[10px] text-orange-500">{orphanDivisions.length + orphanTeams.length + orphanUsers.length + orphanResources.length} Elemente</span>
                  </div>
                  {orphExpanded && (
                    <div className="px-3 py-2 space-y-1 bg-white text-xs">
                      {orphanDivisions.map(div => (
                        <div key={div.id} className="flex items-center gap-2 py-1 px-2 bg-blue-50 rounded">
                          <span className="text-[10px]">Abt:</span>
                          <span className="font-medium flex-1">{div.name}</span>
                          <select value={div.departmentId || ''} onChange={(e) => { const n = localDivisions.map(x => x.id === div.id ? {...x, departmentId: e.target.value} : x); setLocalDivisions(n); saveDivisions(n); }} className="p-1 border rounded text-[10px]">
                            <option value="">‚Üí Bereich w√§hlen</option>
                            {localDepartments.map(d => <option key={d.id} value={d.id}>{d.name}</option>)}
                          </select>
                        </div>
                      ))}
                      {orphanTeams.map(t => (
                        <div key={t.id} className="flex items-center gap-2 py-1 px-2 bg-indigo-50 rounded">
                          <span className="text-[10px]">Team:</span>
                          <span className="font-medium flex-1">{t.name}</span>
                          <select value={t.divisionId || ''} onChange={(e) => { const n = localTeams.map(x => x.id === t.id ? {...x, divisionId: e.target.value} : x); setLocalTeams(n); saveTeams(n); }} className="p-1 border rounded text-[10px]">
                            <option value="">‚Üí Abteilung w√§hlen</option>
                            {localDivisions.map(d => <option key={d.id} value={d.id}>{d.name}</option>)}
                          </select>
                        </div>
                      ))}
                      {orphanUsers.map(u => (
                        <div key={u.id} className="flex items-center gap-2 py-1 px-2 bg-gray-50 rounded">
                          <span className="text-[10px]">Person:</span>
                          <span className="font-medium flex-1">{u.name}</span>
                          <select value={u.teamId || ''} onChange={(e) => { const n = localUsers.map(x => x.id === u.id ? {...x, teamId: e.target.value} : x); setLocalUsers(n); saveUsers(n); }} className="p-1 border rounded text-[10px]">
                            <option value="">‚Üí Team w√§hlen</option>
                            {localTeams.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}
                          </select>
                        </div>
                      ))}
                      {orphanResources.map(r => (
                        <div key={r.id} className="flex items-center gap-2 py-1 px-2 bg-amber-50 rounded">
                          <span className="text-[10px]">{r.type === 'maschine' ? 'üè≠' : r.type === 'werkzeug' ? 'üîß' : 'üöõ'}</span>
                          <span className="font-medium flex-1">{r.name}</span>
                          <select value={r.abteilungId || ''} onChange={(e) => { const n = localResources.map(x => x.id === r.id ? {...x, abteilungId: e.target.value || null} : x); setLocalResources(n); saveResources(n); }} className="p-1 border rounded text-[10px]">
                            <option value="">‚Üí Abteilung w√§hlen</option>
                            {localDivisions.map(d => <option key={d.id} value={d.id}>{d.name}</option>)}
                          </select>
                        </div>
                      ))}
                    </div>
                  )}
                </div>
              );
            })()}
            
            {/* Bereich hinzuf√ºgen */}
            <button onClick={() => {
              const nd = { id: 'dept' + Date.now(), name: 'Neuer Bereich' };
              const n = [...localDepartments, nd]; setLocalDepartments(n); saveDepartments(n); setExpandedUsers({...expandedUsers, ['dept_' + nd.id]: true});
            }} className="w-full py-2 text-xs text-slate-600 hover:bg-slate-50 rounded-lg border-2 border-dashed border-slate-300 flex items-center justify-center gap-1.5">
              <Plus className="w-3.5 h-3.5" /> Bereich hinzuf√ºgen
            </button>
            
          </div>
        </div>
      </div>
    );
  };


  const TeamDashboard = () => {
    // Berechne Team-Auslastung √ºber alle angezeigten Wochen
    const calculateTeamUtilization = (teamId) => {
      const members = getTeamMembers(teamId);
      let totalHours = 0;
      let totalCapacity = 0;
      
      Array.from({length: WEEKS_TO_SHOW}, (_, weekOffset) => {
        const weekNum = currentWeek + weekOffset;
        const weekDates = getWeekDates(weekNum, currentYear);
        
        members.forEach(member => {
          weekDates.forEach(d => {
            const ds = formatDate(d);
            tasks.forEach(t => {
              if (t.userId === member.id && ds >= t.startDate && ds <= t.endDate) {
                // NUR Stunden f√ºr DIESEN Tag addieren!
                totalHours += calculateDayNetHours(member.id, d, t.startHour, t.endHour);
              }
            });
          });
          totalCapacity += getWeekCapacity(member, weekDates);
        });
      });
      
      const utilizationPercent = totalCapacity > 0 ? (totalHours / totalCapacity) * 100 : 0;
      return {
        totalHours: Math.round(totalHours),
        totalCapacity: Math.round(totalCapacity),
        utilizationPercent: Math.round(utilizationPercent),
        freeCapacity: Math.round(totalCapacity - totalHours)
      };
    };

    // NEU: Berechne Team-Auslastung PRO WOCHE
    const calculateTeamUtilizationPerWeek = (teamId) => {
      const members = getTeamMembers(teamId);
      const weeklyData = [];
      
      Array.from({length: WEEKS_TO_SHOW}, (_, weekOffset) => {
        const weekNum = currentWeek + weekOffset;
        const weekDates = getWeekDates(weekNum, currentYear);
        
        let weekHours = 0;
        let weekCapacity = 0;
        
        members.forEach(member => {
          weekDates.forEach(d => {
            const ds = formatDate(d);
            tasks.forEach(t => {
              if (t.userId === member.id && ds >= t.startDate && ds <= t.endDate) {
                // NUR Stunden f√ºr DIESEN Tag addieren!
                weekHours += calculateDayNetHours(member.id, d, t.startHour, t.endHour);
              }
            });
          });
          weekCapacity += getWeekCapacity(member, weekDates);
        });
        
        const utilizationPercent = weekCapacity > 0 ? (weekHours / weekCapacity) * 100 : 0;
        weeklyData.push({
          weekNum,
          hours: Math.round(weekHours),
          capacity: Math.round(weekCapacity),
          utilization: Math.round(utilizationPercent),
          free: Math.round(weekCapacity - weekHours)
        });
      });
      
      return weeklyData;
    };

    // Bestimme relevante Teams basierend auf Rolle
    let relevantTeams = [];
    let viewMode = 'team';
    
    if (currentUser.teamRole === 'entrepreneur') {
      relevantTeams = teams;
      viewMode = 'entrepreneur';
    } else if (currentUser.teamRole === 'department_head') {
      if (currentUser.departmentId) {
        // Finde alle divisions im Bereich
        const departmentDivisions = divisions.filter(d => d.departmentId === currentUser.departmentId);
        const divisionIds = departmentDivisions.map(d => d.id);
        // Finde alle teams in diesen divisions
        relevantTeams = teams.filter(t => divisionIds.includes(t.divisionId));
      } else {
        relevantTeams = teams;
      }
      viewMode = 'department';
    } else if (currentUser.teamRole === 'lead') {
      relevantTeams = teams.filter(t => t.id === currentUser.teamId);
      viewMode = 'team';
    }

    return (
      <div className="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50">
        <div className="bg-white shadow-lg sticky top-0 z-10">
          <div className="max-w-full mx-auto px-6 py-4 flex justify-between">
            <div className="flex items-center gap-3">
              <BarChart3 className="w-6 h-6 text-indigo-600" />
              <h1 className="text-xl font-bold">
                {viewMode === 'entrepreneur' && 'Unternehmens-Dashboard - Alle Teams'}
                {viewMode === 'department' && `Bereichs-Dashboard${currentUser.departmentId ? ' - ' + departments.find(d => d.id === currentUser.departmentId)?.name : ' - Alle Bereiche'}`}
                {viewMode === 'team' && 'Team-Dashboard'}
              </h1>
            </div>
            <div className="flex gap-2 items-center">
              {/* Schriftgr√∂√üe-Slider */}
              <div className="flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-2xl">
                <span className="text-xs text-gray-600">A</span>
                <input 
                  type="range" 
                  min="10" 
                  max="30" 
                  value={dashboardFontSize} 
                  onChange={(e) => setDashboardFontSize(Number(e.target.value))}
                  className="w-32"
                  title={`Schriftgr√∂√üe: ${dashboardFontSize}px`}
                />
                <span className="text-lg font-bold text-gray-800">A</span>
              </div>
              
              {/* Undo/Redo/History Buttons */}
              <button 
                onClick={undo} 
                disabled={undoStack.length === 0}
                className={`p-3 rounded-2xl ${undoStack.length > 0 ? 'hover:bg-gray-100' : 'opacity-30 cursor-not-allowed'}`}
                title={`R√ºckg√§ngig (${undoStack.length} verf√ºgbar)`}>
                ‚Ü∂
              </button>
              <button 
                onClick={redo} 
                disabled={redoStack.length === 0}
                className={`p-3 rounded-2xl ${redoStack.length > 0 ? 'hover:bg-gray-100' : 'opacity-30 cursor-not-allowed'}`}
                title={`Wiederholen (${redoStack.length} verf√ºgbar)`}>
                ‚Ü∑
              </button>
              <button 
                onClick={() => setShowHistory(!showHistory)} 
                className={`p-3 rounded-2xl ${showHistory ? 'bg-blue-100' : 'hover:bg-gray-100'}`}
                title="√Ñnderungshistorie">
                üìú
              </button>
              
              {/* Navigation Buttons */}
              <button 
                onClick={() => { setShowDashboard(false); setShowProjectDashboard(false); setShowProjectPlanning(false); }} 
                className="px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200"
              >
                <Calendar className="w-4 h-4 inline mr-2" />Planung
              </button>
              <button 
                className="px-4 py-2 rounded-2xl bg-green-600 text-white"
              >
                <BarChart3 className="w-4 h-4 inline mr-2" />Team Dashboard
              </button>
              <button 
                onClick={() => { setShowDashboard(false); setShowProjectDashboard(true); setShowProjectPlanning(false); }} 
                className="px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200"
              >
                <BarChart3 className="w-4 h-4 inline mr-2" />Projekt Dashboard
              </button>
              <button 
                onClick={() => { setShowDashboard(false); setShowProjectDashboard(false); setShowProjectPlanning(true); }} 
                className="px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200"
              >
                üèóÔ∏è Projektplanung
              </button>
              
              {currentUser.role === 'admin' && (
                <button onClick={() => setShowAdmin(true)} className="px-4 py-2 bg-purple-600 text-white rounded-2xl">
                  Admin
                </button>
              )}
              <button onClick={() => setShowSettings(true)} className="p-3 hover:bg-gray-100 rounded-2xl">
                <Settings className="w-5 h-5" />
              </button>
              <button onClick={() => { setCurrentUser(null); setSelectedUser(null); setShowLogin(true); setShowDashboard(false); }} 
                className="px-4 py-2 bg-gray-100 rounded-2xl">
                <LogOut className="w-4 h-4 inline mr-2" />Abmelden
              </button>
            </div>
          </div>
        </div>

        <div className="w-full px-2 py-6">
          <div className="bg-white shadow mb-4 rounded-2xl">
            <div className="px-6 py-4 flex justify-between items-center">
              <button onClick={() => setCurrentWeek(w => w === 1 ? 52 : w - 1)} className="px-4 py-2 bg-indigo-600 text-white rounded-2xl">
                <ChevronLeft className="w-5 h-5" />
              </button>
              <div className="font-bold">KW {currentWeek} - {currentWeek + WEEKS_TO_SHOW - 1}</div>
              <button onClick={() => setCurrentWeek(w => w === 52 ? 1 : w + 1)} className="px-4 py-2 bg-indigo-600 text-white rounded-2xl">
                <ChevronRight className="w-5 h-5" />
              </button>
            </div>
          </div>

          {/* TEAM-√úBERSICHTSKARTEN */}
          <div className="grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4 mb-6 dashboard-cards" style={{gridTemplateColumns: 'repeat(auto-fit, minmax(500px, 1fr))'}}>
            {relevantTeams.map(team => {
              const teamUtil = calculateTeamUtilization(team.id);
              const weeklyUtil = calculateTeamUtilizationPerWeek(team.id);
              const isExpanded = expandedTeams[team.id];
              // Hierarchie: team -> division -> department
              const teamDivision = divisions.find(d => d.id === team.divisionId);
              const teamDept = teamDivision ? departments.find(d => d.id === teamDivision.departmentId) : null;
              const members = getTeamMembers(team.id);
              
              return (
                <div key={team.id} className="bg-white rounded-2xl shadow-lg overflow-hidden border-2 border-gray-100">
                  {/* Team Header mit Auslastung */}
                  <div 
                    onClick={() => setExpandedTeams({...expandedTeams, [team.id]: !isExpanded})}
                    className="bg-gradient-to-r from-indigo-500 to-purple-500 p-4 cursor-pointer hover:from-indigo-600 hover:to-purple-600 transition-colors"
                  >
                    <div className="flex justify-between items-start mb-3">
                      <div className="flex-1">
                        <h3 className="text-lg font-bold text-white">{team.name}</h3>
                        {viewMode === 'entrepreneur' && (
                          <p className="text-sm text-purple-100">
                            {teamDivision?.name}{teamDept ? ` ‚Ä¢ ${teamDept.name}` : ''}
                          </p>
                        )}
                        <p className="text-xs text-purple-200 mt-1">{members.length} Mitarbeiter</p>
                      </div>
                      <div className="text-white">
                        {isExpanded ? <ChevronUp className="w-5 h-5" /> : <ChevronDown className="w-5 h-5" />}
                      </div>
                    </div>
                    
                    {/* Gro√üe Auslastungs-Anzeige */}
                    <div className="bg-white/20 rounded-xl p-3 backdrop-blur-sm">
                      <div className="flex justify-between items-end mb-2">
                        <div>
                          <div className="text-3xl font-bold text-white">{teamUtil.utilizationPercent}%</div>
                          <div className="text-xs text-purple-100">Auslastung</div>
                        </div>
                        <div className="text-right">
                          <div className="text-sm font-semibold text-white">{teamUtil.totalHours}h / {teamUtil.totalCapacity}h</div>
                          <div className="text-xs text-purple-100">
                            {teamUtil.freeCapacity > 0 ? `${teamUtil.freeCapacity}h frei` : '√úberlastet!'}
                          </div>
                        </div>
                      </div>
                      
                      {/* Balken */}
                      <div className="w-full bg-white/30 rounded-full h-3 overflow-hidden mb-3">
                        <div 
                          className={`h-full transition-all ${
                            teamUtil.utilizationPercent > 100 ? 'bg-red-400' :
                            teamUtil.utilizationPercent > 90 ? 'bg-orange-400' :
                            teamUtil.utilizationPercent > 70 ? 'bg-yellow-400' :
                            'bg-green-400'
                          }`}
                          style={{width: `${Math.min(teamUtil.utilizationPercent, 100)}%`}}
                        />
                      </div>
                      
                      {/* Wochen-√úbersicht */}
                      <div className="grid grid-cols-4 gap-2">
                        {weeklyUtil.map((week, idx) => (
                          <div key={idx} className="bg-white/30 rounded-lg p-2">
                            <div className="text-xs font-semibold text-white mb-1 text-center">KW {week.weekNum}</div>
                            
                            {/* Prozent-Anzeige */}
                            <div className={`text-lg font-bold text-center mb-2 ${
                              week.utilization > 100 ? 'text-red-200' :
                              week.utilization > 90 ? 'text-orange-200' :
                              week.utilization > 70 ? 'text-yellow-200' :
                              'text-green-200'
                            }`}>
                              {week.utilization}%
                            </div>
                            
                            {/* F√ºllstandsbalken */}
                            <div className="w-full bg-white/20 rounded-full h-2 overflow-hidden mb-2">
                              <div 
                                className={`h-full transition-all ${
                                  week.utilization > 100 ? 'bg-red-300' :
                                  week.utilization > 90 ? 'bg-orange-300' :
                                  week.utilization > 70 ? 'bg-yellow-300' :
                                  'bg-green-300'
                                }`}
                                style={{width: `${Math.min(week.utilization, 100)}%`}}
                              />
                            </div>
                            
                            {/* Stunden */}
                            <div className="text-xs text-purple-100 text-center">{week.hours}h / {week.capacity}h</div>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                  
                  {/* Mitglieder-Liste (aufklappbar) */}
                  {isExpanded && (
                    <div className="p-4 bg-gray-50">
                      <h4 className="font-semibold text-sm text-gray-600 mb-3">Teammitglieder:</h4>
                      <div className="grid grid-cols-1 xl:grid-cols-2 gap-2">
                        {members.map(member => {
                          const isMemberExpanded = expandedMembers[member.id];
                          
                          // Berechne Mitarbeiter-Auslastung
                          let memberTotalHours = 0;
                          let memberTotalCapacity = 0;
                          Array.from({length: WEEKS_TO_SHOW}, (_, weekOffset) => {
                            const weekNum = currentWeek + weekOffset;
                            const weekDates = getWeekDates(weekNum, currentYear);
                            weekDates.forEach(d => {
                              const ds = formatDate(d);
                              tasks.forEach(t => {
                                if (t.userId === member.id && ds >= t.startDate && ds <= t.endDate) {
                                  // NUR Stunden f√ºr DIESEN Tag addieren, nicht den ganzen Task!
                                  memberTotalHours += calculateDayNetHours(member.id, d, t.startHour, t.endHour);
                                }
                              });
                            });
                            memberTotalCapacity += getWeekCapacity(member, weekDates);
                          });
                          const memberUtil = memberTotalCapacity > 0 ? (memberTotalHours / memberTotalCapacity) * 100 : 0;
                          
                          return (
                            <div key={member.id} className="bg-white rounded-xl border border-gray-200 overflow-hidden">
                              <div 
                                onClick={() => setExpandedMembers({...expandedMembers, [member.id]: !isMemberExpanded})}
                                className="p-3 flex justify-between items-center cursor-pointer hover:bg-gray-50"
                              >
                                <div className="flex items-center gap-3 flex-1">
                                  <div className="flex-1 min-w-0">
                                    <div className="flex items-center gap-3 mb-2">
                                      <span className="font-medium text-gray-800" style={{fontSize: `${dashboardFontSize + 2}px`}}>{member.name}</span>
                                      <button 
                                        onClick={(e) => { e.stopPropagation(); setDetailViewUser(member); }}
                                        className="p-1 hover:bg-indigo-100 rounded transition-colors" 
                                        title="Detailansicht"
                                      >
                                        <Eye className="w-4 h-4 text-indigo-600" />
                                      </button>
                                    </div>
                                    {/* F√ºllstandsbalken */}
                                    <div className="w-full bg-gray-200 rounded-full h-2 overflow-hidden">
                                      <div 
                                        className={`h-full transition-all ${
                                          memberUtil > 100 ? 'bg-red-500' :
                                          memberUtil > 90 ? 'bg-orange-500' :
                                          memberUtil > 70 ? 'bg-yellow-500' :
                                          'bg-green-500'
                                        }`}
                                        style={{width: `${Math.min(memberUtil, 100)}%`}}
                                      />
                                    </div>
                                  </div>
                                </div>
                                <div className="flex items-center gap-3">
                                  <div className="text-right">
                                    <div className={`font-semibold ${
                                      memberUtil > 100 ? 'text-red-600' :
                                      memberUtil > 90 ? 'text-orange-600' :
                                      memberUtil > 70 ? 'text-yellow-600' :
                                      'text-green-600'
                                    }`} style={{fontSize: `${dashboardFontSize + 2}px`}}>
                                      {Math.round(memberUtil)}%
                                    </div>
                                    <div className="text-gray-500" style={{fontSize: `${dashboardFontSize}px`}}>{Math.round(memberTotalHours)}h / {Math.round(memberTotalCapacity)}h</div>
                                  </div>
                                  {isMemberExpanded ? <ChevronUp className="w-4 h-4 text-gray-400" /> : <ChevronDown className="w-4 h-4 text-gray-400" />}
                                </div>
                              </div>
                              
                              {/* Wochen-Details pro Mitarbeiter */}
                              {isMemberExpanded && (
                                <div className="px-3 pb-3 pt-1 bg-gray-50 border-t">
                                  <div className="flex gap-2 overflow-hidden">
                                    {Array.from({length: WEEKS_TO_SHOW}, (_, weekOffset) => {
                                      const weekNum = currentWeek + weekOffset;
                                      const weekDates = getWeekDates(weekNum, currentYear);
                                      
                                      // Wochen-Gesamt berechnen
                                      let weekTotal = 0;
                                      let weekCapacity = getWeekCapacity(member, weekDates);
                                      weekDates.forEach(d => {
                                        const ds = formatDate(d);
                                        tasks.forEach(t => {
                                          if (t.userId === member.id && ds >= t.startDate && ds <= t.endDate) {
                                            weekTotal += calculateDayNetHours(member.id, d, t.startHour, t.endHour);
                                          }
                                        });
                                      });
                                      const weekUtil = weekCapacity > 0 ? (weekTotal / weekCapacity) * 100 : 0;
                                      
                                      return (
                                        <div key={weekNum} className="flex-shrink-0 bg-white rounded-lg p-2 border border-gray-200" style={{minWidth: '220px'}}>
                                          <div className="font-semibold mb-1 text-center text-gray-700" style={{fontSize: `${dashboardFontSize + 1}px`}}>KW {weekNum}</div>
                                          
                                          {/* Wochen-F√ºllstandsbalken */}
                                          <div className="mb-2">
                                            <div className="flex justify-between items-center mb-1" style={{fontSize: `${dashboardFontSize}px`}}>
                                              <span className={`font-semibold ${
                                                weekUtil > 100 ? 'text-red-600' :
                                                weekUtil > 90 ? 'text-orange-600' :
                                                weekUtil > 70 ? 'text-yellow-600' :
                                                'text-green-600'
                                              }`}>{Math.round(weekUtil)}%</span>
                                              <span className="text-gray-500 text-xs">{weekTotal.toFixed(1)}h / {weekCapacity}h</span>
                                            </div>
                                            <div className="w-full bg-gray-200 rounded-full h-1.5 overflow-hidden">
                                              <div 
                                                className={`h-full transition-all ${
                                                  weekUtil > 100 ? 'bg-red-500' :
                                                  weekUtil > 90 ? 'bg-orange-500' :
                                                  weekUtil > 70 ? 'bg-yellow-500' :
                                                  'bg-green-500'
                                                }`}
                                                style={{width: `${Math.min(weekUtil, 100)}%`}}
                                              />
                                            </div>
                                          </div>
                                          
                                          <div className="space-y-1">
                                            {weekDates.slice(1, 6).map((d, i) => {
                                              const ds = formatDate(d);
                                              let tot = 0;
                                              tasks.forEach(t => {
                                                if (t.userId === member.id && ds >= t.startDate && ds <= t.endDate) {
                                                  // Nur Stunden f√ºr DIESEN Tag berechnen, nicht den ganzen Task!
                                                  tot += calculateDayNetHours(member.id, d, t.startHour, t.endHour);
                                                }
                                              });
                                              const isVac = isVacation(member.id, d);
                                              const isNonWork = isNonWorkingDay(member, d);
                                              const dayCapacity = getDailyHours(member, d);
                                              const utilization = dayCapacity > 0 ? (tot / dayCapacity) * 100 : 0;
                                              
                                              return (
                                                <div key={i} className="space-y-1">
                                                  <div className="flex justify-between items-center" style={{fontSize: `${dashboardFontSize}px`}}>
                                                    <span className="text-gray-600">
                                                      {['Mo','Di','Mi','Do','Fr'][i]} {d.getDate()}.{d.getMonth()+1}
                                                    </span>
                                                    <span className={`font-semibold ${
                                                      isVac ? 'text-orange-600' : 
                                                      isNonWork ? 'text-gray-400' :
                                                      tot > dayCapacity ? 'text-red-600' : 
                                                      tot > 0 ? 'text-green-600' : 
                                                      'text-gray-400'
                                                    }`}>
                                                      {isVac ? 'üèñÔ∏è' : isNonWork ? 'frei' : `${tot.toFixed(2)}h`}
                                                    </span>
                                                  </div>
                                                  
                                                  {/* F√ºllstandsanzeige */}
                                                  {!isVac && !isNonWork && dayCapacity > 0 && (
                                                    <div className="w-full bg-gray-200 rounded-full h-1.5 overflow-hidden">
                                                      <div 
                                                        className={`h-full transition-all ${
                                                          utilization > 100 ? 'bg-red-500' :
                                                          utilization > 90 ? 'bg-orange-500' :
                                                          utilization > 70 ? 'bg-yellow-500' :
                                                          utilization > 0 ? 'bg-green-500' :
                                                          'bg-gray-400'
                                                        }`}
                                                        style={{width: `${Math.min(utilization, 100)}%`}}
                                                        title={`${Math.round(utilization)}% ausgelastet`}
                                                      />
                                                    </div>
                                                  )}
                                                </div>
                                              );
                                            })}
                                          </div>
                                          
                                          {/* Notizen f√ºr diese Woche - IMMER SICHTBAR */}
                                          {(() => {
                                            const weekNote = getWeekNote(member.id, weekNum);
                                            const noteText = weekNote?.text?.trim() || '';
                                            return (
                                              <div className="mt-2 pt-2 border-t border-gray-200">
                                                <div className="flex items-start gap-1">
                                                  <StickyNote className="w-3 h-3 text-indigo-500 mt-0.5 flex-shrink-0" />
                                                  <div className="flex-1" style={{fontSize: `${dashboardFontSize}px`}}>
                                                    {noteText ? (
                                                      <div className="text-gray-700 bg-yellow-50 p-1.5 rounded border border-yellow-200 whitespace-pre-line">{noteText}</div>
                                                    ) : (
                                                      <div className="text-gray-400 italic">Keine Notizen</div>
                                                    )}
                                                  </div>
                                                </div>
                                              </div>
                                            );
                                          })()}
                                        </div>
                                      );
                                    })}
                                  </div>
                                </div>
                              )}
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  )}
                </div>
              );
            })}
          </div>
        </div>

        {/* Detailansicht Modal */}
        {detailViewUser && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
            <div className="bg-white rounded-3xl p-6 w-full max-h-[90vh] overflow-y-auto" style={{maxWidth: '95%'}}>
              <div className="flex justify-between mb-6">
                <h2 className="text-2xl font-bold">Detailansicht: {detailViewUser.name}</h2>
                <button onClick={() => setDetailViewUser(null)} className="text-2xl">‚úï</button>
              </div>
              
              <div className="flex gap-4">
                <div className="w-56 bg-gray-50 rounded-2xl p-4 flex-shrink-0 flex flex-col" style={{maxHeight: '500px'}}>
                  <h3 className="font-bold mb-3">Projekte</h3>
                  <div className="space-y-2 overflow-y-auto flex-1">
                    {projects.sort((a, b) => a.name.localeCompare(b.name)).map(p => (
                      <div key={p.id} className="flex items-center gap-2 p-3 rounded-xl bg-white border-2" style={{borderColor: p.color}}>
                        <div className="w-4 h-4 rounded" style={{backgroundColor: p.color}}></div>
                        <span className="flex-1 text-sm">{p.name}</span>
                      </div>
                    ))}
                  </div>
                </div>
                <div className="flex-1 overflow-x-auto" ref={ganttScrollRef}>
                  <div className="flex gap-4">
                    {Array.from({length: WEEKS_TO_SHOW}, (_, i) => {
                      const weekNum = currentWeek + i;
                      return <WeekColumn key={weekNum} weekNum={weekNum} user={detailViewUser} />;
                    })}
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}

        {showAdmin && <AdminPanel />}
        
        {/* Settings Modal */}
        {showSettings && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
            <div className="bg-white rounded-3xl p-6 max-w-md w-full">
              <div className="flex justify-between mb-6">
                <h2 className="text-2xl font-bold">Einstellungen</h2>
                <button onClick={() => setShowSettings(false)} className="text-2xl">‚úï</button>
              </div>
              <p className="text-gray-600">
                Die vollst√§ndigen Einstellungen sind in der Planung-Ansicht verf√ºgbar.<br/><br/>
                Bitte gehe zur Planung, um alle Einstellungen zu bearbeiten.
              </p>
              <button 
                onClick={() => { setShowSettings(false); setShowDashboard(false); setShowProjectDashboard(false); }}
                className="mt-4 w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"
              >
                Zur Planung wechseln
              </button>
            </div>
          </div>
        )}
      </div>
    );
  };

  const WeekColumn = ({ weekNum, user }) => {
    const weekDates = getWeekDates(weekNum, currentYear);
    if (weekDates.length === 0) return null;
    const weekNote = getWeekNote(user.id, weekNum);
    const isNoteExpanded = expandedNotes[`${user.id}-${weekNum}`] !== false;
    const [localNoteText, setLocalNoteText] = React.useState(weekNote?.text || '');
    React.useEffect(() => { setLocalNoteText(weekNote?.text || ''); }, [weekNote?.text]);

    return (
      <div className="flex-shrink-0" style={{width: 7 * DW + 50}}>
        <div className="bg-gray-50 rounded-2xl p-4">
          <h3 className="text-lg font-bold mb-2 text-center">KW {weekNum}</h3>
          
          {/* Button: Aus Vorwoche kopieren */}
          <div className="mb-3 flex justify-center">
            <button 
              onClick={() => copyTasksFromPreviousWeek(user.id, weekNum)}
              className="px-3 py-1.5 bg-indigo-500 text-white text-xs rounded-lg hover:bg-indigo-600 transition-colors flex items-center gap-1"
              title="Alle Aufgaben aus KW {weekNum - 1} in diese Woche kopieren"
            >
              <Copy className="w-3 h-3" />
              Aus KW {weekNum - 1} kopieren
            </button>
          </div>
          
          <div className="flex mb-1" style={{marginLeft: '40px'}}>
            <div style={{display: 'grid', gridTemplateColumns: `repeat(7, ${DW}px)`, width: 7 * DW}}>
              {weekDates.map((d, i) => {
                const isVacationDay = isVacation(user.id, d);
                const isWeekend = d.getDay() === 0 || d.getDay() === 6;
                const isNonWork = isNonWorkingDay(user, d);
                return (
                  <div key={i} className="flex justify-center">
                    {!isWeekend && !isNonWork && (
                      <button onClick={(e) => { e.preventDefault(); e.stopPropagation(); toggleVacation(user.id, d); }}
                        className={`p-1 rounded transition-all ${isVacationDay ? 'bg-orange-400 text-white hover:bg-orange-500' : 'bg-gray-100 text-gray-400 hover:bg-gray-200'}`}
                        title={isVacationDay ? 'Urlaub entfernen' : 'Urlaub markieren'}>
                        <Umbrella className="w-4 h-4" />
                      </button>
                    )}
                  </div>
                );
              })}
            </div>
          </div>
          <div className="flex mb-2" style={{marginLeft: '40px'}}>
            <div style={{display: 'grid', gridTemplateColumns: `repeat(7, ${DW}px)`, width: 7 * DW}}>
              {weekDates.map((d, i) => {
                const isWe = d.getDay() === 0 || d.getDay() === 6;
                const isNonWork = isNonWorkingDay(user, d);
                const dayS = getDaySchedule(user, d);
                return (
                  <div key={i} className={`text-center flex flex-col justify-center ${(isWe || isNonWork) ? 'bg-gray-300' : 'bg-white border border-gray-200'}`} style={{height: '60px'}}>
                    <div className="text-xs font-semibold">{['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'][d.getDay()]}</div>
                    <div className="text-sm">{d.getDate()}.{d.getMonth() + 1}</div>
                    {!isWe && (
                      <div className={`text-xs mt-0.5 ${isNonWork ? 'text-gray-500 font-semibold' : 'text-gray-400'}`}>
                        {isNonWork ? 'frei' : `${h2t(dayS.start)}‚Äì${h2t(dayS.end)}`}
                      </div>
                    )}
                  </div>
                );
              })}
            </div>
          </div>
          <div className="flex">
            <div className="flex flex-col justify-between text-xs text-gray-500 pr-2" style={{width: '40px'}}>
              {Array.from({length: GRID_ROWS}, (_, i) => GRID_END - 1 - i).map(h => (
                <div key={h} className="text-right" style={{height: HH, lineHeight: `${HH}px`}}>{h}:00</div>
              ))}
            </div>
            <div className="relative bg-white rounded-xl" style={{width: 7 * DW, height: GRID_ROWS * HH}}
              onDrop={(e) => {
                e.preventDefault();
                if (draggedProject) {
                  const rect = e.currentTarget.getBoundingClientRect();
                  const x = e.clientX - rect.left;
                  const y = e.clientY - rect.top;
                  const day = Math.floor(x / DW);
                  const hourFloat = GRID_END - (y / HH);
                  const hour = Math.round(hourFloat * 4) / 4; // Auf 0,25h runden
                  
                  // Pr√ºfe ob Urlaubstag
                  const dropDate = weekDates[day];
                  const isVacationDay = dropDate && isVacation(user.id, dropDate);
                  
                  if (day >= 0 && day < 7 && hour >= GRID_START && hour < GRID_END && !isVacationDay) {
                    addTask(user.id, draggedProject.id, weekDates[day], hour, Math.min(hour + 2, GRID_END));
                  }
                  setDraggedProject(null);
                }
              }}
              onDragOver={(e) => e.preventDefault()}>
              <div className="absolute inset-0" style={{display: 'grid', gridTemplateColumns: `repeat(7, ${DW}px)`, gridTemplateRows: `repeat(${GRID_ROWS}, ${HH}px)`}}>
                {Array.from({length: GRID_ROWS * 7}, (_, i) => {
                  const dayIndex  = i % 7;
                  const rowIndex  = Math.floor(i / 7);
                  const hourSlot  = GRID_END - 1 - rowIndex;
                  const dateForDay = weekDates[dayIndex];
                  const isWe       = dateForDay?.getDay() === 0 || dateForDay?.getDay() === 6;
                  const isVacDay   = dateForDay && isVacation(user.id, dateForDay);
                  const isNonWork  = dateForDay && isNonWorkingDay(user, dateForDay);
                  const isWorkH    = dateForDay && isWorkingHour(user, dateForDay, hourSlot);
                  // Farb-Priorit√§t: Urlaub > Wochenende/frei > au√üerhalb Arbeitszeit > normal
                  let bg = '';
                  if (isVacDay)              bg = 'bg-orange-100';
                  else if (isWe || isNonWork) bg = 'bg-gray-200';
                  else if (!isWorkH)         bg = 'bg-gray-100';
                  return <div key={i} className={`border border-gray-100 ${bg}`}></div>;
                })}
              </div>
              {/* Pausenbalken als proportionale Overlays */}
              {weekDates.map((d, dayIdx) => {
                const dayNum = d.getDay();
                if (dayNum === 0 || dayNum === 6) return null;
                
                // Richtigen Schedule holen
                const userSchedule = user?.dailySchedule || DEFAULT_SCHEDULE;
                const sched = userSchedule[dayNum] || DEFAULT_SCHEDULE[dayNum];
                if (!sched) return null;
                
                const breakBars = [];
                
                // Nicht-Arbeitszeit VOR Arbeitsbeginn (grau) - 0,25h genau
                if (sched.start > GRID_START) {
                  const bottom = 0;
                  const height = (sched.start - GRID_START) * HH;
                  breakBars.push(
                    <div key={`${dayIdx}-before`} 
                      className="absolute bg-gray-100 pointer-events-none"
                      style={{
                        left: dayIdx * DW,
                        width: DW,
                        bottom: bottom,
                        height: height,
                        borderTop: '1px solid rgba(0,0,0,0.1)'
                      }}
                    />
                  );
                }
                
                // Nicht-Arbeitszeit NACH Arbeitsende (grau) - 0,25h genau
                if (sched.end < GRID_END) {
                  const bottom = (sched.end - GRID_START) * HH;
                  const height = (GRID_END - sched.end) * HH;
                  breakBars.push(
                    <div key={`${dayIdx}-after`} 
                      className="absolute bg-gray-100 pointer-events-none"
                      style={{
                        left: dayIdx * DW,
                        width: DW,
                        bottom: bottom,
                        height: height,
                        borderBottom: '1px solid rgba(0,0,0,0.1)'
                      }}
                    />
                  );
                }
                
                // Pause 1 - nur wenn explizit konfiguriert
                if (sched.break1Start !== undefined && sched.break1Duration > 0) {
                  const bottom = (sched.break1Start - GRID_START) * HH;
                  const height = sched.break1Duration * HH;
                  breakBars.push(
                    <div key={`${dayIdx}-b1`} 
                      className="absolute break-stripe pointer-events-none rounded"
                      style={{
                        left: dayIdx * DW,
                        width: DW,
                        bottom: bottom,
                        height: height
                      }}
                    />
                  );
                }
                
                // Pause 2 - nur wenn explizit konfiguriert UND Vollzeit
                const workEnd = sched.end || 17;
                const hasBreak2 = workEnd > 13;
                if (hasBreak2 && sched.break2Start !== undefined && sched.break2Duration > 0) {
                  const bottom = (sched.break2Start - GRID_START) * HH;
                  const height = sched.break2Duration * HH;
                  breakBars.push(
                    <div key={`${dayIdx}-b2`} 
                      className="absolute break-stripe pointer-events-none rounded"
                      style={{
                        left: dayIdx * DW,
                        width: DW,
                        bottom: bottom,
                        height: height
                      }}
                    />
                  );
                }
                
                return breakBars;
              }).flat()}
              {tasks.filter(t => t.userId === user.id).map(t => {
                const isDrag = draggedTask?.task?.id === t.id;
                const isResize = resizingTask?.task?.id === t.id;
                const startDate = isDrag && draggedTask.previewStartDate ? draggedTask.previewStartDate : t.startDate;
                const endDate = isDrag && draggedTask.previewEndDate ? draggedTask.previewEndDate : isResize && resizingTask.previewEndDate ? resizingTask.previewEndDate : t.endDate;
                const startHour = isDrag && draggedTask.previewStartHour !== undefined ? draggedTask.previewStartHour : isResize && resizingTask.previewStartHour !== undefined ? resizingTask.previewStartHour : t.startHour;
                const endHour = isDrag && draggedTask.previewEndHour !== undefined ? draggedTask.previewEndHour : isResize && resizingTask.previewEndHour !== undefined ? resizingTask.previewEndHour : t.endHour;
                const st = new Date(startDate + 'T12:00:00');
                const ed = new Date(endDate + 'T12:00:00');
                const fd = new Date(weekDates[0]);
                fd.setHours(12, 0, 0, 0);
                const diff = Math.round((st - fd) / 86400000);
                if (diff < 0 || diff >= 7) return null;
                const days = Math.round((ed - st) / 86400000) + 1;
                const proj = projects.find(p => p.id === t.projectId);
                const netHours = calculateNetHours(startHour, endHour, startDate, endDate, t.userId);
                const bottomPos = (startHour - GRID_START) * HH;
                const heightVal = Math.max((endHour - startHour) * HH, HH);
                return (
                  <div key={t.id} onMouseDown={(e) => { e.preventDefault(); setDraggedTask({ task: t, startX: e.clientX, startY: e.clientY }); }}
                    style={{ left: diff * DW, width: days * DW, bottom: bottomPos, height: heightVal, backgroundColor: proj?.color, opacity: 0.7 }} 
                    className="absolute rounded-lg shadow-lg flex flex-col items-center justify-center text-white font-bold cursor-move group">
                    <div onMouseDown={(e) => { e.stopPropagation(); setResizingTask({ task: t, dir: 'top', startX: e.clientX, startY: e.clientY, origEnd: t.endHour }); }}
                      className="absolute top-0 left-0 right-0 h-2 cursor-ns-resize hover:bg-black/20 z-10" />
                    <div className="text-xs pointer-events-none">{proj?.name}</div>
                    <div className="text-xs pointer-events-none opacity-80">{h2t(startHour)}‚Äì{h2t(endHour)}</div>
                    <div className="text-xs pointer-events-none">
                      {netHours.break > 0 ? (
                        <span title={`${netHours.gross.toFixed(2)}h brutto - ${netHours.break.toFixed(2)}h Pause`}>
                          {netHours.net.toFixed(2)}h
                        </span>
                      ) : (
                        `${netHours.net.toFixed(2)}h`
                      )}
                    </div>
                    <div onMouseDown={(e) => { e.stopPropagation(); setResizingTask({ task: t, dir: 'right', startX: e.clientX, startY: e.clientY }); }}
                      className="absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize hover:bg-black/20 z-10" />
                    <div onMouseDown={(e) => { e.stopPropagation(); setResizingTask({ task: t, dir: 'bottom', startX: e.clientX, startY: e.clientY, origStart: t.startHour }); }}
                      className="absolute bottom-0 left-0 right-0 h-2 cursor-ns-resize hover:bg-black/20 z-10" />
                    
                    {/* Button: In n√§chste Woche kopieren */}
                    <button 
                      onMouseDown={(e) => e.stopPropagation()} 
                      onClick={(e) => { e.stopPropagation(); copyTaskToNextWeek(t); }} 
                      className="absolute top-1 right-7 opacity-0 group-hover:opacity-100 bg-green-500 hover:bg-green-600 rounded-lg p-1 z-20 min-w-[18px] min-h-[18px] flex items-center justify-center"
                      title="In n√§chste Woche kopieren"
                    >
                      <ArrowRight className="w-3 h-3" />
                    </button>
                    
                    {/* Button: L√∂schen */}
                    <button onMouseDown={(e) => e.stopPropagation()} onClick={(e) => { e.stopPropagation(); deleteTask(t.id); }} 
                      className="absolute top-1 right-1 opacity-0 group-hover:opacity-100 bg-red-500 rounded-lg p-1 z-20 min-w-[18px] min-h-[18px] flex items-center justify-center">
                      <Trash2 className="w-3 h-3" />
                    </button>
                  </div>
                );
              })}
            </div>
          </div>
          <div className="border-t-2 mt-3 pt-3" style={{marginLeft: '40px'}}>
            <div style={{display: 'grid', gridTemplateColumns: `repeat(7, ${DW}px)`, width: 7 * DW}}>
              {weekDates.map((d, i) => {
                const ds = formatDate(d);
                let tot = 0;
                const dayNum = d.getDay();
                const sched = (user?.dailySchedule || DEFAULT_SCHEDULE)[dayNum];
                
                tasks.forEach(t => { 
                  if (t.userId === user.id && ds >= t.startDate && ds <= t.endDate) {
                    // Netto-Stunden f√ºr diesen Tag berechnen
                    const dayGross = t.endHour - t.startHour;
                    let dayNet = dayGross;
                    
                    // Nur Werktage
                    if (dayNum !== 0 && dayNum !== 6 && sched) {
                      // Pause 1 √úberschneidung
                      const break1Start = sched.break1Start || 0;
                      const break1Duration = sched.break1Duration || 0;
                      const break1End = break1Start + break1Duration;
                      
                      if (break1Duration > 0) {
                        const overlap1Start = Math.max(t.startHour, break1Start);
                        const overlap1End = Math.min(t.endHour, break1End);
                        if (overlap1Start < overlap1End) {
                          dayNet -= (overlap1End - overlap1Start);
                        }
                      }
                      
                      // Pause 2 √úberschneidung (nur wenn nicht Teilzeit)
                      const workEnd = sched.end || 17;
                      const hasBreak2 = workEnd > 13;
                      
                      if (hasBreak2) {
                        const break2Start = sched.break2Start || 0;
                        const break2Duration = sched.break2Duration || 0;
                        const break2End = break2Start + break2Duration;
                        
                        if (break2Duration > 0) {
                          const overlap2Start = Math.max(t.startHour, break2Start);
                          const overlap2End = Math.min(t.endHour, break2End);
                          if (overlap2Start < overlap2End) {
                            dayNet -= (overlap2End - overlap2Start);
                          }
                        }
                      }
                    }
                    
                    tot += dayNet;
                  }
                });
                const isWe = d.getDay() === 0 || d.getDay() === 6;
                const isVac = isVacation(user.id, d);
                const isNonWork = isNonWorkingDay(user, d);
                const dayCapacity = getDailyHours(user, d);
                return (
                  <div key={i} className="text-center px-1">
                    <div className={`py-1 rounded font-bold ${
                      isVac ? 'bg-orange-400 text-white' : 
                      isNonWork ? 'bg-gray-300 text-gray-500' :
                      isWe ? 'bg-gray-300' : 
                      tot > dayCapacity ? 'bg-red-400 text-white' : 
                      tot > 0 ? 'bg-green-400 text-white' : 
                      'bg-gray-200'
                    }`}>
                      {isVac ? 'üèñÔ∏è' : isNonWork ? 'frei' : tot > 0 ? `${tot.toFixed(2)}h` : ''}
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
          <div className="mt-3">
            <button onClick={() => { 
              // Scroll-Position speichern
              if (ganttScrollRef.current) {
                setSavedScrollPosition(ganttScrollRef.current.scrollLeft);
              }
              const key = `${user.id}-${weekNum}`; 
              setExpandedNotes(prev => ({...prev, [key]: prev[key] === false ? true : false})); 
            }} 
              className="flex items-center gap-2 text-sm text-indigo-600 hover:text-indigo-800">
              <StickyNote className="w-4 h-4" />
              Notizen KW {weekNum}
            </button>
            {isNoteExpanded && (
              <textarea value={localNoteText} onChange={(e) => setLocalNoteText(e.target.value)}
                onBlur={() => updateWeekNote(user.id, weekNum, localNoteText)}
                className="w-full mt-2 p-2 border rounded" rows="3" placeholder="Notizen f√ºr diese Woche..." />
            )}
          </div>
        </div>
      </div>
    );
  };

  // üîê PASSWORT-SCREEN - wird als erstes gezeigt
  if (!isAuthenticated) {
    const handlePasswordSubmit = (e) => {
      e.preventDefault();
      if (passwordInput === APP_PASSWORD) {
        setIsAuthenticated(true);
        setPasswordError(false);
      } else {
        setPasswordError(true);
        setPasswordInput('');
      }
    };
    
    return (
      <div className="min-h-screen flex items-center justify-center relative overflow-hidden" style={{ backgroundImage: 'url(data:image/jpeg;base64,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)', backgroundSize: 'cover', backgroundPosition: 'center' }}>
        {/* Dark overlay to mute original text */}
        <div className="absolute inset-0" style={{ background: 'linear-gradient(135deg, rgba(0,30,60,0.55) 0%, rgba(0,40,50,0.65) 50%, rgba(0,20,50,0.75) 100%)' }} />
        
        {/* Hoffmann Interior Logo - top left, angled */}
        <div className="absolute top-0 left-0" style={{ width: 280, height: 130 }}>
          <div className="absolute inset-0" style={{ background: 'white', clipPath: 'polygon(0 0, 100% 0, 72% 100%, 0 100%)' }} />
          <div className="absolute top-5 left-5 flex items-center gap-3">
            <svg width="36" height="44" viewBox="0 0 36 44" fill="none">
              <path d="M0 44L14 0h8L8 44H0z" fill="#1a3a5c"/>
              <path d="M12 44L26 0h10L22 44H12z" fill="#2a5a8c"/>
            </svg>
            <div>
              <div style={{ fontSize: 17, fontWeight: 800, letterSpacing: 2, color: '#1a3a5c', lineHeight: 1.1, fontFamily: 'system-ui' }}>HOFFMANN</div>
              <div style={{ fontSize: 14, fontWeight: 400, letterSpacing: 4, color: '#1a3a5c', lineHeight: 1.2, fontFamily: 'system-ui' }}>INTERIOR</div>
            </div>
          </div>
        </div>
        
        {/* Kapazit√§tsplaner V5 - centered overlay */}
        <div className="absolute top-16 left-0 right-0 text-center pointer-events-none">
          <h1 className="text-white font-bold tracking-wide" style={{ fontSize: 44, textShadow: '0 2px 20px rgba(0,0,0,0.5)', letterSpacing: 3, fontFamily: 'system-ui' }}>Kapazit√§tsplaner V5</h1>
        </div>
        
        {/* Login card */}
        <div className="bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl p-8 max-w-md w-full relative z-10 mt-16">
          <div className="text-center mb-6">
            <div className="w-16 h-16 mx-auto mb-4 bg-indigo-600 rounded-full flex items-center justify-center">
              <svg className="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
              </svg>
            </div>
            <p className="text-gray-500 text-sm">Bitte Passwort eingeben</p>
          </div>
          
          <form onSubmit={handlePasswordSubmit} className="space-y-4">
            <div>
              <input
                type="password"
                value={passwordInput}
                onChange={(e) => {setPasswordInput(e.target.value); setPasswordError(false);}}
                placeholder="Passwort"
                className={`w-full p-4 border-2 rounded-2xl text-lg focus:outline-none focus:border-indigo-600 transition-colors ${
                  passwordError ? 'border-red-500 bg-red-50' : 'border-gray-300'
                }`}
                autoFocus
              />
              {passwordError && (
                <p className="text-red-600 text-sm mt-2 flex items-center gap-2">
                  <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                    <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                  </svg>
                  Falsches Passwort. Bitte erneut versuchen.
                </p>
              )}
            </div>
            
            <button
              type="submit"
              className="w-full p-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-2xl font-bold text-lg hover:shadow-xl transition-shadow"
            >
              Anmelden
            </button>
          </form>
          
          <div className="mt-6 pt-6 border-t text-center">
            <p className="text-sm text-gray-500">
              Standard-Passwort: <code className="bg-gray-100 px-2 py-1 rounded">Team2025</code>
            </p>
            <p className="text-xs text-gray-400 mt-2">
              Hinweis: Passwort kann in der Datei ge√§ndert werden
            </p>
          </div>
        </div>
      </div>
    );
  }

  if (showLogin) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-indigo-100 to-purple-100 flex items-center justify-center">
        <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full">
          <Calendar className="w-16 h-16 mx-auto text-indigo-600 mb-4" />
          <h1 className="text-3xl font-bold text-center mb-6">Kapazit√§tsplaner V5</h1>
          <div className="space-y-3">
            {users.map(u => (
              <button key={u.id} onClick={() => { setCurrentUser(u); setShowLogin(false); setShowDashboard(u.teamRole === 'lead' || u.teamRole === 'department_head' || u.teamRole === 'entrepreneur'); }} 
                className="w-full p-4 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-2xl hover:shadow-xl transition-shadow">
                {u.name} {u.teamRole === 'lead' && '(F√ºhrungskraft)'} {u.teamRole === 'department_head' && '(Bereichsleitung)'} {u.teamRole === 'entrepreneur' && '(Unternehmer)'}
              </button>
            ))}
          </div>
        </div>
      </div>
    );
  }

  if (showDashboard && (currentUser.teamRole === 'lead' || currentUser.teamRole === 'department_head' || currentUser.teamRole === 'entrepreneur' || currentUser.role === 'admin')) {
    return <TeamDashboard />;
  }

  // Projekt-Dashboard - F√úR ALLE zug√§nglich
  if (showProjectDashboard) {
    const ProjectDashboard = () => {
      // Helper-Funktionen
      const openSettings = () => {
        setShowSettings(true);
      };
      
      // Filter speichern - SOFORT State updaten, im Hintergrund speichern
      const updateFilter = (filterName, value) => {
        const newFilters = {...projectDashboardFilters, [filterName]: value};
        setProjectDashboardFilters(newFilters);
        // Im Hintergrund speichern ohne zu warten
        const key = `project-filters-${currentUser.id}`;
        window.storage.set(key, JSON.stringify(newFilters)).catch(() => {});
      };
      
      // Berechne Stunden pro Projekt, gruppiert nach Department
      const calculateProjectHoursByDivision = (projectId, filters, project) => {
        const divisionHours = {};
        let totalHours = 0;
        
        // IST-Stunden berechnen
        tasks.forEach(t => {
          if (t.projectId === projectId) {
            const user = users.find(u => u.id === t.userId);
            if (!user) return;
            
            const team = teams.find(tm => tm.id === user?.teamId);
            const division = team ? divisions.find(d => d.id === team.divisionId) : null;
            const dept = division ? departments.find(d => d.id === division.departmentId) : null;
            
            // Filter anwenden
            if (filters.department !== 'all' && dept?.id !== filters.department) return;
            if (filters.division && filters.division !== 'all' && division?.id !== filters.division) return;
            if (filters.team !== 'all' && team?.id !== filters.team) return;
            if (filters.user !== 'all' && user?.id !== filters.user) return;
            
            const divName = division?.name || 'Ohne Abteilung';
            const divId = division?.id || 'none';
            const deptName = dept?.name || '';
            
            const netHours = calculateNetHours(t.startHour, t.endHour, t.startDate, t.endDate, t.userId);
            
            if (!divisionHours[divId]) {
              divisionHours[divId] = { 
                name: divName,
                departmentName: deptName,
                actualHours: 0,
                plannedHours: 0
              };
            }
            divisionHours[divId].actualHours += netHours.net;
            totalHours += netHours.net;
          }
        });
        
        // SOLL-Stunden aus projectPhases holen (Phasen basieren auf divisions!)
        projectPhases.forEach(phase => {
          if (phase.projectId === projectId && phase.hoursNeeded > 0) {
            const divId = phase.divisionId;
            const division = divisions.find(d => d.id === divId);
            const dept = division ? departments.find(d => d.id === division.departmentId) : null;
            
            if (!divisionHours[divId]) {
              divisionHours[divId] = {
                name: phase.divisionName || division?.name || 'Unbekannt',
                departmentName: dept?.name || '',
                actualHours: 0,
                plannedHours: 0
              };
            }
            divisionHours[divId].plannedHours += phase.hoursNeeded;
          }
        });
        
        return { divisionHours, totalHours };
      };
      
      // Filtern nach Projekt-Name UND Bereich
      const filteredProjects = projects.filter(p => {
        // Projekt-Name Filter
        if (!p.name.toLowerCase().includes(projectDashboardFilters.projectSearch.toLowerCase())) {
          return false;
        }
        
        // Bereich Filter: Nur Projekte zeigen die f√ºr den gew√§hlten Bereich Stunden haben
        if (projectDashboardFilters.department !== 'all') {
          const deptHours = (p.departmentHours || {})[projectDashboardFilters.department] || 0;
          // Pr√ºfe auch ob IST-Stunden f√ºr diesen Bereich existieren
          let hasActualHours = false;
          tasks.forEach(t => {
            if (t.projectId === p.id) {
              const user = users.find(u => u.id === t.userId);
              const team = teams.find(tm => tm.id === user?.teamId);
              const division = team ? divisions.find(d => d.id === team.divisionId) : null;
              const dept = division ? departments.find(d => d.id === division.departmentId) : null;
              if (dept?.id === projectDashboardFilters.department) {
                hasActualHours = true;
              }
            }
          });
          
          if (deptHours === 0 && !hasActualHours) {
            return false;
          }
        }
        
        // Abteilung Filter (NEU)
        if (projectDashboardFilters.division && projectDashboardFilters.division !== 'all') {
          let hasHoursInDivision = false;
          tasks.forEach(t => {
            if (t.projectId === p.id) {
              const user = users.find(u => u.id === t.userId);
              const team = teams.find(tm => tm.id === user?.teamId);
              if (team?.divisionId === projectDashboardFilters.division) {
                hasHoursInDivision = true;
              }
            }
          });
          if (!hasHoursInDivision) return false;
        }
        
        // Team Filter
        if (projectDashboardFilters.team !== 'all') {
          let hasHoursInTeam = false;
          tasks.forEach(t => {
            if (t.projectId === p.id) {
              const user = users.find(u => u.id === t.userId);
              if (user?.teamId === projectDashboardFilters.team) {
                hasHoursInTeam = true;
              }
            }
          });
          if (!hasHoursInTeam) return false;
        }
        
        return true;
      });
      
      return (
        <>
          <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50">
          <div className="bg-white shadow-lg sticky top-0 z-10">
            <div className="max-w-full mx-auto px-6 py-4">
              {/* Header mit Navigation */}
              <div className="flex justify-between items-center mb-4">
                <div className="flex items-center gap-3">
                  <span className="text-3xl">üìä</span>
                  <h1 className="text-xl font-bold">Projekt-Dashboard - Stunden√ºbersicht nach Bereichen</h1>
                </div>
                
                {/* Navigation Buttons */}
                <div className="flex gap-2">
                  {/* Undo/Redo/History Buttons */}
                  <button 
                    onClick={undo} 
                    disabled={undoStack.length === 0}
                    className={`p-3 rounded-2xl ${undoStack.length > 0 ? 'hover:bg-gray-100' : 'opacity-30 cursor-not-allowed'}`}
                    title={`R√ºckg√§ngig (${undoStack.length} verf√ºgbar)`}>
                    ‚Ü∂
                  </button>
                  <button 
                    onClick={redo} 
                    disabled={redoStack.length === 0}
                    className={`p-3 rounded-2xl ${redoStack.length > 0 ? 'hover:bg-gray-100' : 'opacity-30 cursor-not-allowed'}`}
                    title={`Wiederholen (${redoStack.length} verf√ºgbar)`}>
                    ‚Ü∑
                  </button>
                  <button 
                    onClick={() => setShowHistory(!showHistory)} 
                    className={`p-3 rounded-2xl ${showHistory ? 'bg-blue-100' : 'hover:bg-gray-100'}`}
                    title="√Ñnderungshistorie">
                    üìú
                  </button>
                  
                  {/* Navigation */}
                  <button 
                    onClick={() => { setShowDashboard(false); setShowProjectDashboard(false); setShowProjectPlanning(false); }} 
                    className="px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200"
                  >
                    <Calendar className="w-4 h-4 inline mr-2" />Planung
                  </button>
                  <button 
                    onClick={() => { setShowDashboard(true); setShowProjectDashboard(false); setShowProjectPlanning(false); }} 
                    className="px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200"
                  >
                    <BarChart3 className="w-4 h-4 inline mr-2" />Team Dashboard
                  </button>
                  <button 
                    className="px-4 py-2 rounded-2xl bg-blue-600 text-white"
                  >
                    <BarChart3 className="w-4 h-4 inline mr-2" />Projekt Dashboard
                  </button>
                  <button 
                    onClick={() => { setShowDashboard(false); setShowProjectDashboard(false); setShowProjectPlanning(true); }} 
                    className="px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200"
                  >
                    üèóÔ∏è Projektplanung
                  </button>
                  {currentUser.role === 'admin' && (
                    <button onClick={() => setShowAdmin(true)} className="px-4 py-2 bg-purple-600 text-white rounded-2xl">
                      Admin
                    </button>
                  )}
                  <button onClick={openSettings} className="p-3 hover:bg-gray-100 rounded-2xl">
                    <Settings className="w-5 h-5" />
                  </button>
                  <button 
                    onClick={() => { setCurrentUser(null); setSelectedUser(null); setShowLogin(true); setShowProjectDashboard(false); }} 
                    className="px-4 py-2 bg-gray-100 rounded-2xl"
                  >
                    <LogOut className="w-4 h-4 inline mr-2" />Abmelden
                  </button>
                </div>
              </div>
              
              {/* Filter */}
              <div className="grid grid-cols-1 md:grid-cols-5 gap-3 pb-4 border-b">
                {/* Bereich Filter */}
                <div>
                  <label className="text-xs font-semibold text-gray-600 mb-1 block">Bereich</label>
                  <select 
                    value={projectDashboardFilters.department}
                    onChange={(e) => updateFilter('department', e.target.value)}
                    className="w-full p-2 border rounded-lg text-sm"
                  >
                    <option value="all">Alle Bereiche</option>
                    {departments.sort((a, b) => a.name.localeCompare(b.name)).map(d => (
                      <option key={d.id} value={d.id}>{d.name}</option>
                    ))}
                  </select>
                </div>
                
                {/* Abteilung Filter (NEU) */}
                <div>
                  <label className="text-xs font-semibold text-gray-600 mb-1 block">Abteilung</label>
                  <select 
                    value={projectDashboardFilters.division || 'all'}
                    onChange={(e) => updateFilter('division', e.target.value)}
                    className="w-full p-2 border rounded-lg text-sm"
                  >
                    <option value="all">Alle Abteilungen</option>
                    {divisions.sort((a, b) => a.name.localeCompare(b.name)).map(div => {
                      const dept = departments.find(d => d.id === div.departmentId);
                      return (
                        <option key={div.id} value={div.id}>
                          {div.name}{dept ? ` (${dept.name})` : ''}
                        </option>
                      );
                    })}
                  </select>
                </div>
                
                {/* Team Filter */}
                <div>
                  <label className="text-xs font-semibold text-gray-600 mb-1 block">Team</label>
                  <select 
                    value={projectDashboardFilters.team}
                    onChange={(e) => updateFilter('team', e.target.value)}
                    className="w-full p-2 border rounded-lg text-sm"
                  >
                    <option value="all">Alle Teams</option>
                    {teams.sort((a, b) => a.name.localeCompare(b.name)).map(t => {
                      const div = divisions.find(d => d.id === t.divisionId);
                      const dept = div ? departments.find(d => d.id === div.departmentId) : null;
                      return (
                        <option key={t.id} value={t.id}>
                          {t.name}{div ? ` (${div.name})` : ''}{dept ? ` ‚Ä¢ ${dept.name}` : ''}
                        </option>
                      );
                    })}
                  </select>
                </div>
                
                {/* Mitglied Filter */}
                <div>
                  <label className="text-xs font-semibold text-gray-600 mb-1 block">Mitglied</label>
                  <select 
                    value={projectDashboardFilters.user}
                    onChange={(e) => updateFilter('user', e.target.value)}
                    className="w-full p-2 border rounded-lg text-sm"
                  >
                    <option value="all">Alle Mitglieder</option>
                    {users.filter(u => u.role !== 'admin').sort((a, b) => a.name.localeCompare(b.name)).map(u => (
                      <option key={u.id} value={u.id}>{u.name}</option>
                    ))}
                  </select>
                </div>
                
                {/* Projekt Suche */}
                <div>
                  <label className="text-xs font-semibold text-gray-600 mb-1 block">Projekt suchen</label>
                  <input 
                    type="text"
                    value={projectDashboardFilters.projectSearch}
                    onChange={(e) => updateFilter('projectSearch', e.target.value)}
                    placeholder="Projekt eingeben..."
                    className="w-full p-2 border rounded-lg text-sm"
                  />
                </div>
              </div>
              
              {/* Filter Reset */}
              {(projectDashboardFilters.department !== 'all' || 
                projectDashboardFilters.division !== 'all' ||
                projectDashboardFilters.team !== 'all' || 
                projectDashboardFilters.user !== 'all' || 
                projectDashboardFilters.projectSearch !== '') && (
                <div className="pt-2">
                  <button 
                    onClick={() => {
                      const resetFilters = {department: 'all', division: 'all', team: 'all', user: 'all', projectSearch: ''};
                      setProjectDashboardFilters(resetFilters);
                      window.storage.set(`project-filters-${currentUser.id}`, JSON.stringify(resetFilters));
                    }}
                    className="text-sm text-indigo-600 hover:text-indigo-800"
                  >
                    ‚úï Filter zur√ºcksetzen
                  </button>
                </div>
              )}
            </div>
          </div>

          <div className="w-full px-4 py-6">
            <div className="grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-6">
              {filteredProjects.sort((a, b) => a.name.localeCompare(b.name)).map(project => {
                const { divisionHours, totalHours } = calculateProjectHoursByDivision(project.id, projectDashboardFilters, project);
                
                // Nur Abteilungen mit SOLL>0 ODER IST>0 anzeigen
                const divArray = Object.entries(divisionHours)
                  .filter(([id, data]) => data.actualHours > 0 || data.plannedHours > 0)
                  .map(([id, data]) => ({
                    id,
                    name: data.name,
                    departmentName: data.departmentName,
                    actualHours: data.actualHours,
                    plannedHours: data.plannedHours,
                    utilization: data.plannedHours > 0 ? (data.actualHours / data.plannedHours) * 100 : 0,
                    percentage: totalHours > 0 ? (data.actualHours / totalHours) * 100 : 0
                  }))
                  .sort((a, b) => a.name.localeCompare(b.name)); // Alphabetisch!
                
                // Projekt ohne Abteilungen mit Stunden ausblenden
                if (divArray.length === 0) return null;
                
                // Gesamt-SOLL berechnen
                const totalPlannedHours = divArray.reduce((sum, d) => sum + d.plannedHours, 0);
                const totalUtilization = totalPlannedHours > 0 ? (totalHours / totalPlannedHours) * 100 : 0;
                
                return (
                  <div key={project.id} className="bg-white rounded-2xl shadow-lg overflow-hidden border-2 border-gray-100">
                    {/* Projekt Header */}
                    <div className="p-4 border-b" style={{backgroundColor: project.color + '20'}}>
                      <div className="flex items-center gap-3 mb-3">
                        <div 
                          className="w-6 h-6 rounded-full" 
                          style={{backgroundColor: project.color}}
                        />
                        <h3 className="text-lg font-bold text-gray-800 flex-1">{project.name}</h3>
                      </div>
                      
                      {/* Gesamt IST & SOLL */}
                      <div className="grid grid-cols-2 gap-3">
                        <div className="bg-white/50 rounded-lg p-2">
                          <div className="text-xs text-gray-600 mb-1">IST-Stunden</div>
                          <div className="text-2xl font-bold text-gray-700">{totalHours.toFixed(1)}h</div>
                        </div>
                        <div className="bg-white/50 rounded-lg p-2">
                          <div className="text-xs text-gray-600 mb-1">SOLL-Stunden</div>
                          <div className="text-2xl font-bold text-indigo-600">
                            {totalPlannedHours > 0 ? `${totalPlannedHours.toFixed(0)}h` : '-'}
                          </div>
                        </div>
                      </div>
                      
                      {/* Gesamt-Fortschritt (nur wenn SOLL > 0) */}
                      {totalPlannedHours > 0 && (
                        <div className="mt-3">
                          <div className="flex justify-between items-center mb-1">
                            <span className="text-xs text-gray-600">Gesamt-Fortschritt</span>
                            <span className={`text-sm font-bold ${
                              totalUtilization > 100 ? 'text-red-600' :
                              totalUtilization > 90 ? 'text-orange-600' :
                              totalUtilization > 70 ? 'text-yellow-600' :
                              'text-green-600'
                            }`}>
                              {Math.round(totalUtilization)}%
                            </span>
                          </div>
                          <div className="w-full bg-gray-200 rounded-full h-2 overflow-hidden">
                            <div 
                              className={`h-full transition-all ${
                                totalUtilization > 100 ? 'bg-red-500' :
                                totalUtilization > 90 ? 'bg-orange-500' :
                                totalUtilization > 70 ? 'bg-yellow-500' :
                                'bg-green-500'
                              }`}
                              style={{width: `${Math.min(totalUtilization, 100)}%`}}
                            />
                          </div>
                        </div>
                      )}
                      
                      {/* √úberplanung Warnung */}
                      {totalPlannedHours > 0 && totalUtilization > 100 && (
                        <div className="mt-2 text-xs text-red-600 bg-red-50 rounded p-2">
                          ‚ö†Ô∏è √úberplant um {(totalHours - totalPlannedHours).toFixed(1)}h ({Math.round(totalUtilization - 100)}%)
                        </div>
                      )}
                    </div>
                    
                    {/* Abteilungen-Aufschl√ºsselung */}
                    <div className="p-4 space-y-3">
                      <div className="text-xs font-semibold text-gray-600 mb-2">Stunden pro Abteilung:</div>
                      
                      {divArray.map((div, idx) => (
                        <div key={div.id} className="bg-gray-50 rounded-lg p-3 border border-gray-200">
                          <div className="flex justify-between items-start mb-2">
                            <div className="flex-1">
                              <span className="font-semibold text-gray-700">{div.name}</span>
                              {div.departmentName && (
                                <span className="text-xs text-gray-500 ml-2">({div.departmentName})</span>
                              )}
                            </div>
                            <div className="text-right">
                              <div className="flex items-center gap-2">
                                <span className="text-lg font-bold text-gray-700">{div.actualHours.toFixed(1)}h</span>
                                {div.plannedHours > 0 && (
                                  <>
                                    <span className="text-gray-400">/</span>
                                    <span className="text-sm text-indigo-600">{div.plannedHours.toFixed(0)}h</span>
                                  </>
                                )}
                              </div>
                              {div.plannedHours > 0 && (
                                <div className={`text-xs font-semibold ${
                                  div.utilization > 100 ? 'text-red-600' :
                                  div.utilization > 90 ? 'text-orange-600' :
                                  div.utilization > 70 ? 'text-yellow-600' :
                                  'text-green-600'
                                }`}>
                                  {Math.round(div.utilization)}% Fortschritt
                                </div>
                              )}
                            </div>
                          </div>
                          
                          {/* F√ºllstandsbalken (IST vs SOLL wenn vorhanden, sonst Anteil am Gesamt) */}
                          {div.plannedHours > 0 ? (
                            <div className="w-full bg-gray-200 rounded-full h-2 overflow-hidden">
                              <div 
                                className={`h-full transition-all ${
                                  div.utilization > 100 ? 'bg-red-500' :
                                  div.utilization > 90 ? 'bg-orange-500' :
                                  div.utilization > 70 ? 'bg-yellow-500' :
                                  'bg-green-500'
                                }`}
                                style={{width: `${Math.min(div.utilization, 100)}%`}}
                              />
                            </div>
                          ) : (
                            <div className="w-full bg-gray-200 rounded-full h-2 overflow-hidden">
                              <div 
                                className={`h-full transition-all ${
                                  idx === 0 ? 'bg-indigo-500' :
                                  idx === 1 ? 'bg-blue-500' :
                                  idx === 2 ? 'bg-cyan-500' :
                                  'bg-teal-500'
                                }`}
                                style={{width: `${div.percentage}%`}}
                                title={`${Math.round(div.percentage)}% Anteil am Gesamt`}
                              />
                            </div>
                          )}
                          
                          {/* Warnung bei √úberplanung */}
                          {div.plannedHours > 0 && div.utilization > 100 && (
                            <div className="text-xs text-red-600 mt-1">
                              ‚ö†Ô∏è +{(div.actualHours - div.plannedHours).toFixed(1)}h √ºber Soll
                            </div>
                          )}
                        </div>
                      ))}
                      
                      {/* Verteilungs-Visualisierung (nur wenn >1 Abteilung) */}
                      {divArray.length > 1 && (
                        <div className="mt-4 pt-4 border-t">
                          <div className="text-xs font-semibold text-gray-500 mb-2 text-center">IST-Verteilung</div>
                          <div className="flex h-4 rounded-full overflow-hidden">
                            {divArray.map((div, idx) => (
                              <div 
                                key={div.id}
                                className={`${
                                  idx === 0 ? 'bg-indigo-500' :
                                  idx === 1 ? 'bg-blue-500' :
                                  idx === 2 ? 'bg-cyan-500' :
                                  'bg-teal-500'
                                }`}
                                style={{width: `${div.percentage}%`}}
                                title={`${div.name}: ${div.actualHours.toFixed(1)}h (${Math.round(div.percentage)}%)`}
                              />
                            ))}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                );
              })}
            </div>
            
            {/* Keine Projekte gefunden */}
            {filteredProjects.every(p => {
              const { divisionHours } = calculateProjectHoursByDivision(p.id, projectDashboardFilters, p);
              const hasAnyHours = Object.values(divisionHours).some(d => d.actualHours > 0 || d.plannedHours > 0);
              return !hasAnyHours;
            }) && (
              <div className="text-center py-12">
                <div className="text-6xl mb-4">üìä</div>
                <h2 className="text-2xl font-bold text-gray-600 mb-2">
                  {projectDashboardFilters.department !== 'all' || 
                   projectDashboardFilters.division !== 'all' ||
                   projectDashboardFilters.team !== 'all' || 
                   projectDashboardFilters.user !== 'all' || 
                   projectDashboardFilters.projectSearch !== '' 
                    ? 'Keine Projekte gefunden'
                    : 'Noch keine Projekt-Stunden'
                  }
                </h2>
                <p className="text-gray-500">
                  {projectDashboardFilters.department !== 'all' || 
                   projectDashboardFilters.division !== 'all' ||
                   projectDashboardFilters.team !== 'all' || 
                   projectDashboardFilters.user !== 'all' || 
                   projectDashboardFilters.projectSearch !== '' 
                    ? 'Versuche andere Filter-Einstellungen'
                    : 'Erstelle Tasks mit Projektzuordnung oder definiere Soll-Stunden in den Einstellungen'
                  }
                </p>
              </div>
            )}
          </div>
        </div>
        
        {/* Settings Modal */}
        {showSettings && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
            <div className="bg-white rounded-3xl p-6 max-w-md w-full">
              <div className="flex justify-between mb-6">
                <h2 className="text-2xl font-bold">Einstellungen</h2>
                <button onClick={() => setShowSettings(false)} className="text-2xl">‚úï</button>
              </div>
              <p className="text-gray-600">
                Die vollst√§ndigen Einstellungen sind in der Planung-Ansicht verf√ºgbar.<br/><br/>
                Bitte gehe zur Planung, um alle Einstellungen zu bearbeiten.
              </p>
              <button 
                onClick={() => { setShowSettings(false); setShowDashboard(false); setShowProjectDashboard(false); }}
                className="mt-4 w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"
              >
                Zur Planung wechseln
              </button>
            </div>
          </div>
        )}
        </>
      );
    };
    
    return <ProjectDashboard />;
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // PROJEKTPLANUNG DASHBOARD - Das neue Feature! üî•
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // PROJEKTPLANUNG DASHBOARD - Hierarchische Arbeitspakete V11
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  
  // Globaler Scroll-Speicher - AUSSERHALB von React!
  const _scrollPositions = window._sidebarScrollPositions || (window._sidebarScrollPositions = {});
  
  if (showProjectPlanning) {
    const ProjectPlanningDashboard = () => {
      const [expandedPackages, setExpandedPackages] = React.useState({});
      const [contextMenu, setContextMenu] = React.useState(null);
      const [draggedWP, setDraggedWP] = React.useState(null);
      const [resizingWP, setResizingWP] = React.useState(null);
      const [editingName, setEditingName] = React.useState(null);
      const [selectedWP, setSelectedWP] = React.useState(null);
      const [selectedWPs, setSelectedWPs] = React.useState([]); // Multi-Select: Array von WP-IDs
      const [lastClickedWP, setLastClickedWP] = React.useState(null); // F√ºr Shift-Auswahl
      const [hoveredWP, setHoveredWP] = React.useState(null);
      const [hoveredDep, setHoveredDep] = React.useState(null);
      const [dependencies, setDependencies] = React.useState([]);
      const [linkingFrom, setLinkingFrom] = React.useState(null);
      const [linkMousePos, setLinkMousePos] = React.useState(null);
      // Workload-Panel States die schnell wechseln (M√úSSEN hier innen sein, sonst remounted der Parent die ganze Gantt-Ansicht)
      const [workloadContextMenu, setWorkloadContextMenu] = React.useState(null);
      const [vacationDrag, setVacationDrag] = React.useState(null);
      const [vacationTypePicker, setVacationTypePicker] = React.useState(null);
      // sidebarWPId und filterAssigned kommen aus dem Parent-Scope
      const [showAssignments, setShowAssignments] = React.useState(true);
      const [showHours, setShowHours] = React.useState(true); // Stunden neben Balken anzeigen
      const [previewPositions, setPreviewPositions] = React.useState({}); // Live-Preview f√ºr abh√§ngige Balken
      const [originalPositions, setOriginalPositions] = React.useState({}); // Original-Positionen f√ºr Schatten
      const [baselineMenuOpen, setBaselineMenuOpen] = React.useState(false); // Baseline-Dropdown
      const [viewMenuOpen, setViewMenuOpen] = React.useState(false); // Ansicht-Men√º
      const [rowDragWP, setRowDragWP] = React.useState(null); // WP das vertikal gezogen wird
      const [dropTarget, setDropTarget] = React.useState(null); // {wpId, position: 'before'|'after'|'child'}
      const [columnMenuOpen, setColumnMenuOpen] = React.useState(false); // Spalten-Men√º
      // Nutze Parent-States f√ºr persistente Breiten
      const leftPanelWidth = ganttLeftPanelWidth;
      const setLeftPanelWidth = setGanttLeftPanelWidth;
      const columnWidths = ganttColumnWidths;
      const setColumnWidths = setGanttColumnWidths;
      if (!window._ganttResizingPanel) window._ganttResizingPanel = { active: false };
      const [isResizingPanel, _setIsResizingPanel] = React.useState(window._ganttResizingPanel.active);
      const setIsResizingPanel = (val) => { window._ganttResizingPanel.active = val; _setIsResizingPanel(val); };
      const [resizingColumn, setResizingColumn] = React.useState(null); // {key, startX, startWidth}
      // Nutze Parent-States f√ºr Sidebar (damit sie beim Zoom erhalten bleiben)
      const selectedProjectId = ganttSelectedProjectId;
      const setSelectedProjectId = setGanttSelectedProjectId;
      const selectedFolderId = ganttSelectedFolderId;
      const setSelectedFolderId = setGanttSelectedFolderId;
      const projectSidebarCollapsed = ganttProjectSidebarCollapsed;
      const setProjectSidebarCollapsed = setGanttProjectSidebarCollapsed;
      const [collapsedFolders, setCollapsedFolders] = React.useState({}); // Zugeklappte Ordner
      const [draggingProject, setDraggingProject] = React.useState(null); // Projekt das gezogen wird
      const [draggingFolder, setDraggingFolder] = React.useState(null); // Ordner der gezogen wird
      const [dragOverFolder, setDragOverFolder] = React.useState(null); // Ordner √ºber dem gehovered wird
      const [dragOverProject, setDragOverProject] = React.useState(null); // Projekt √ºber dem gehovered wird (f√ºr Sortierung)
      const [editingFolderId, setEditingFolderId] = React.useState(null); // Ordner der bearbeitet wird
      const [showArchive, setShowArchive] = React.useState(false); // Archiv ein-/ausblenden
      const [editingProjectId, setEditingProjectId] = React.useState(null); // Projekt umbenennen
      const [dayContextMenu, setDayContextMenu] = React.useState(null); // { x, y, date } f√ºr Rechtsklick auf Tag
      const [editingHoliday, setEditingHoliday] = React.useState(null); // { date, type, name } f√ºr Bearbeitung
      const [detailsCollapsed, setDetailsCollapsed] = [ganttDetailsCollapsed, setGanttDetailsCollapsed]; // Details-Panel - Parent-State
      const originalPositionsRef = React.useRef({}); // Ref f√ºr Loop-freien Zugriff
      const ganttScrollRef = React.useRef(null); // Ref f√ºr Gantt-Scroll-Container
      const headerScrollRef = React.useRef(null); // Ref f√ºr Header-Scroll (synchronisiert mit ganttHScrollRef)
      
      // Globaler Scroll-Speicher (au√üerhalb React)
      if (!window._ganttScrollTop) window._ganttScrollTop = { value: 0, isDragging: false };
      if (!window._ganttScrollLeft) window._ganttScrollLeft = { value: Math.max(0, WEEKS_BEFORE * 7 * DAY_WIDTH - 100), initialized: false };
      const ganttHScrollRef = React.useRef(null);
      const workloadScrollRef = React.useRef(null);
      const workloadLeftRef = React.useRef(null);
      
      // Track actual gantt content width so workload can match it
      const [ganttContentWidth, setGanttContentWidth] = React.useState(WEEKS_TO_SHOW * 7 * DAY_WIDTH);
      
      React.useLayoutEffect(() => {
        if (ganttHScrollRef.current) {
          const w = ganttHScrollRef.current.scrollWidth;
          if (w !== ganttContentWidth) setGanttContentWidth(w);
        }
      });
      
      // Sync workload scroll when panel opens
      React.useEffect(() => {
        if (workloadPanelHeight > 0 && workloadScrollRef.current) {
          // Ensure content width is current
          if (ganttHScrollRef.current) {
            setGanttContentWidth(ganttHScrollRef.current.scrollWidth);
          }
          const sync = () => {
            if (workloadScrollRef.current && window._ganttScrollLeft?.value !== undefined) {
              workloadScrollRef.current.scrollLeft = window._ganttScrollLeft.value;
            }
          };
          // Multiple retries for render timing
          sync();
          requestAnimationFrame(sync);
          setTimeout(sync, 50);
          setTimeout(sync, 150);
        }
      }, [workloadPanelHeight, ganttContentWidth]);
      
      // Nutze Parent-States f√ºr Zoom und Spalten
      const zoomLevel = ganttZoomLevel;
      const setZoomLevel = setGanttZoomLevel;
      
      // sidebarWP wird immer frisch aus workPackages geholt
      const sidebarWP = sidebarWPId ? workPackages.find(w => w.id === sidebarWPId) : null;
      
      // Sortierte Listen
      const sortedUsers = React.useMemo(() => [...users].sort((a, b) => a.name.localeCompare(b.name, 'de')), [users]);
      const sortedDivisions = React.useMemo(() => [...divisions].sort((a, b) => a.name.localeCompare(b.name, 'de')), [divisions]);
      
      // WICHTIG: Hilfsfunktionen f√ºr korrekte lokale Datums-Verarbeitung (keine UTC-Konvertierung!)
      const parseLocalDate = (dateStr) => {
        if (!dateStr) return null;
        if (dateStr instanceof Date) return dateStr;
        const parts = String(dateStr).split('-');
        if (parts.length !== 3) return null;
        // Setze Stunden auf 12:00 um Rundungsfehler zu vermeiden
        return new Date(parseInt(parts[0]), parseInt(parts[1]) - 1, parseInt(parts[2]), 12, 0, 0, 0);
      };
      
      const toLocalDateString = (date) => {
        if (!date) return '';
        const d = date instanceof Date ? date : new Date(date);
        const year = d.getFullYear();
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const day = String(d.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
      };
      
      // Zoom-abh√§ngige Breite
      const DAY_WIDTH = Math.round(35 * zoomLevel / 100);
      const ROW_HEIGHT = 32;
      const WEEKS_BEFORE = 12; // 12 Wochen in die Vergangenheit
      const WEEKS_FORWARD = Math.ceil(20 * 100 / zoomLevel);
      const WEEKS_TO_SHOW = WEEKS_BEFORE + WEEKS_FORWARD;
      const currentWeekNum = getWeekNumber(new Date());
      const timelineStartWeek = currentWeekNum - WEEKS_BEFORE;
      const weekNumbers = Array.from({length: WEEKS_TO_SHOW}, (_, i) => timelineStartWeek + i);
      const allDays = React.useMemo(() => {
        const days = [];
        weekNumbers.forEach(wn => { getWeekDates(wn, new Date().getFullYear()).forEach(d => days.push(d)); });
        return days;
      }, [weekNumbers.length, timelineStartWeek]);
      
      const wpColors = ['#6366f1', '#8b5cf6', '#ec4899', '#f43f5e', '#f97316', '#eab308', '#22c55e', '#14b8a6', '#0ea5e9', '#64748b'];
      
      const monthNames = ['Jan', 'Feb', 'M√§r', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'];
      
      React.useEffect(() => {
        const loadDeps = async () => {
          const saved = await window.storage.get('wpDependencies').catch(() => null);
          if (saved) setDependencies(JSON.parse(saved.value));
        };
        loadDeps();
      }, []);
      
      // Scroll zur aktuellen Woche beim allerersten Mount
      if (!window._ganttInitScrolled) window._ganttInitScrolled = false;
      React.useEffect(() => {
        if (window._ganttInitScrolled) return;
        const scrollToToday = () => {
          const todayX = WEEKS_BEFORE * 7 * DAY_WIDTH;
          const scrollTarget = Math.max(0, todayX - 100);
          if (ganttHScrollRef.current) {
            ganttHScrollRef.current.scrollLeft = scrollTarget;
            window._ganttScrollLeft.value = scrollTarget;
            window._ganttInitScrolled = true;
          }
          if (headerScrollRef.current) {
            headerScrollRef.current.scrollLeft = scrollTarget;
          }
        };
        requestAnimationFrame(scrollToToday);
        setTimeout(scrollToToday, 100);
        setTimeout(scrollToToday, 300);
      }, [DAY_WIDTH]);
      
      const saveDependencies = (deps) => {
        setDependencies(deps);
        window.storage.set('wpDependencies', JSON.stringify(deps));
      };
      
      // Hilfsfunktionen f√ºr Wochenend- und Feiertags-Berechnung
      const isWeekendDay = (date) => {
        const d = parseLocalDate(date) || new Date(date);
        return d.getDay() === 0 || d.getDay() === 6; // 0 = Sonntag, 6 = Samstag
      };
      
      // Pr√ºft ob ein Tag ein freier Tag ist (Wochenende ODER Feiertag)
      const isNonWorkDay = (date, allowWeekend = false) => {
        const d = parseLocalDate(date) || new Date(date);
        const dateStr = toLocalDateString(d);
        // Feiertag pr√ºfen
        if (holidays[dateStr]) return true;
        // Wochenende pr√ºfen (au√üer wenn erlaubt)
        if (!allowWeekend && isWeekendDay(d)) return true;
        return false;
      };
      
      const addWorkingDays = (startDate, days, allowWeekend) => {
        const result = parseLocalDate(startDate) || new Date(startDate);
        let remaining = days;
        
        if (allowWeekend && Object.keys(holidays).length === 0) {
          // Nur wenn keine Feiertage definiert sind, einfache Berechnung
          result.setDate(result.getDate() + days);
          return result;
        }
        
        while (remaining > 0) {
          result.setDate(result.getDate() + 1);
          if (!isNonWorkDay(result, allowWeekend)) {
            remaining--;
          }
        }
        return result;
      };
      
      const countWorkingDays = (startDate, endDate, allowWeekend) => {
        const start = parseLocalDate(startDate) || new Date(startDate);
        const end = parseLocalDate(endDate) || new Date(endDate);
        
        if (allowWeekend && Object.keys(holidays).length === 0) {
          return Math.ceil((end - start) / (1000 * 60 * 60 * 24));
        }
        
        let count = 0;
        const current = new Date(start);
        
        while (current <= end) {
          if (!isNonWorkDay(current, allowWeekend)) {
            count++;
          }
          current.setDate(current.getDate() + 1);
        }
        return count;
      };
      
      // Springt √ºber freie Tage (Wochenende + Feiertage)
      const skipNonWorkDays = (date, forward = true, allowWeekend = false) => {
        const d = parseLocalDate(date) || new Date(date);
        while (isNonWorkDay(d, allowWeekend)) {
          d.setDate(d.getDate() + (forward ? 1 : -1));
        }
        return d;
      };
      
      const skipWeekend = (date, forward = true) => {
        const d = parseLocalDate(date) || new Date(date);
        while (isWeekendDay(d)) {
          d.setDate(d.getDate() + (forward ? 1 : -1));
        }
        return d;
      };
      
      // Baseline-Funktionen
      const createBaseline = (name) => {
        if (!selectedProjectId) {
          alert('Bitte w√§hlen Sie zuerst ein einzelnes Projekt aus, um eine Baseline zu erstellen.');
          return null;
        }
        const projectWPs = workPackages.filter(wp => wp.projectId === selectedProjectId);
        const baseline = {
          id: `baseline_${Date.now()}`,
          projectId: selectedProjectId,
          name: name || `Baseline ${new Date().toLocaleDateString('de-DE')} ${new Date().toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' })}`,
          createdAt: new Date().toISOString(),
          workPackages: projectWPs.map(wp => ({ id: wp.id, startDate: wp.startDate, endDate: wp.endDate }))
        };
        const newBaselines = [...baselines, baseline];
        setBaselines(newBaselines);
        window.storage.set('wpBaselines', JSON.stringify(newBaselines));
        return baseline;
      };
      
      const deleteBaseline = (baselineId) => {
        const newBaselines = baselines.filter(b => b.id !== baselineId);
        setBaselines(newBaselines);
        window.storage.set('wpBaselines', JSON.stringify(newBaselines));
        if (activeBaseline?.id === baselineId) setActiveBaseline(null);
      };
      
      const loadBaseline = (baselineId) => {
        const baseline = baselines.find(b => b.id === baselineId);
        if (baseline) {
          setActiveBaseline(activeBaseline?.id === baselineId ? null : baseline);
        }
      };
      
      const restoreBaseline = (baselineId) => {
        const baseline = baselines.find(b => b.id === baselineId);
        if (baseline) {
          const updated = workPackages.map(wp => {
            const savedWP = baseline.workPackages.find(bwp => bwp.id === wp.id);
            if (savedWP) {
              return { ...wp, startDate: savedWP.startDate, endDate: savedWP.endDate };
            }
            return wp;
          });
          saveWorkPackages(updated);
          setActiveBaseline(null);
        }
      };
      
      const getChildren = (wpId, allWPs) => allWPs.filter(wp => wp.parentId === wpId).sort((a, b) => (a.order || 0) - (b.order || 0));
      
      const getAllDescendants = (wpId, allWPs) => {
        const children = getChildren(wpId, allWPs);
        let descendants = [...children];
        children.forEach(child => { descendants = [...descendants, ...getAllDescendants(child.id, allWPs)]; });
        return descendants;
      };
      
      const calculateDatesFromChildren = (wpId, allWPs) => {
        const getAllLeafDates = (id) => {
          const children = getChildren(id, allWPs);
          if (children.length === 0) {
            const wp = allWPs.find(w => w.id === id);
            return wp ? [{ start: wp.startDate, end: wp.endDate }] : [];
          }
          return children.flatMap(child => getAllLeafDates(child.id));
        };
        const dates = getAllLeafDates(wpId);
        if (dates.length === 0) return null;
        const validDates = dates.filter(d => d.start && d.end);
        if (validDates.length === 0) return null;
        const starts = validDates.map(d => new Date(d.start));
        const ends = validDates.map(d => new Date(d.end));
        return { startDate: formatDate(new Date(Math.min(...starts))), endDate: formatDate(new Date(Math.max(...ends))) };
      };
      
      const calculateTotalHours = (wpId) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return 0;
        const children = getChildren(wpId, workPackages);
        if (children.length === 0) return wp.plannedHours || 0;
        return children.reduce((sum, child) => sum + calculateTotalHours(child.id), 0);
      };
      
      const calculateAssignedHours = (wp) => {
        if (!wp) return 0;
        const respHours = (wp.responsibles || []).reduce((sum, r) => sum + (typeof r === 'object' ? (r.hours || 0) : 0), 0);
        const editHours = (wp.editors || []).reduce((sum, e) => sum + (typeof e === 'object' ? (e.hours || 0) : 0), 0);
        return respHours + editHours;
      };
      
      const getAssignmentText = (wp) => {
        const assignments = [];
        (wp.responsibles || []).forEach(r => {
          const userId = typeof r === 'object' ? r.userId : r;
          const hours = typeof r === 'object' ? r.hours : 0;
          const user = users.find(u => u.id === userId);
          if (user) {
            const nameParts = user.name.split(' ');
            const shortName = nameParts.length > 1 ? `${nameParts[0][0]}.${nameParts[nameParts.length-1]}` : user.name;
            assignments.push(hours > 0 ? `${shortName} ${hours}h` : shortName);
          }
        });
        (wp.editors || []).forEach(e => {
          const userId = typeof e === 'object' ? e.userId : e;
          const hours = typeof e === 'object' ? e.hours : 0;
          const user = users.find(u => u.id === userId);
          if (user) {
            const nameParts = user.name.split(' ');
            const shortName = nameParts.length > 1 ? `${nameParts[0][0]}.${nameParts[nameParts.length-1]}` : user.name;
            if (!assignments.some(a => a.startsWith(shortName.split(' ')[0]))) {
              assignments.push(hours > 0 ? `${shortName} ${hours}h` : shortName);
            }
          }
        });
        return assignments.join(', ');
      };
      
      // Workload-Berechnung: Stunden pro Person pro Tag
      const calculateWorkload = React.useMemo(() => {
        const workload = {}; // { userId: { 'YYYY-MM-DD': { total: X, details: [{wpName, hours}] } } }
        
        workPackages.forEach(wp => {
          if (!wp.startDate || !wp.endDate) return;
          const hasChildren = workPackages.some(w => w.parentId === wp.id);
          if (hasChildren) return; // Nur Blatt-Pakete
          
          // Sammle alle Zuweisungen (responsibles + editors)
          const allAssignments = [
            ...((wp.responsibles || []).map(r => typeof r === 'object' ? r : { userId: r, hours: 0 })),
            ...((wp.editors || []).map(e => typeof e === 'object' ? e : { userId: e, hours: 0 }))
          ];
          
          if (allAssignments.length === 0) return;
          
          // Arbeitstage im WP berechnen
          const start = parseLocalDate(wp.startDate);
          const end = parseLocalDate(wp.endDate);
          const workDays = [];
          const d = new Date(start);
          while (d <= end) {
            const dow = d.getDay();
            const ds = formatDate(d);
            const isHoliday = holidays[ds];
            if (dow !== 0 && dow !== 6 && !isHoliday) {
              workDays.push(ds);
            } else if (wp.allowWeekend && dow !== 0 && dow !== 6) {
              workDays.push(ds);
            }
            d.setDate(d.getDate() + 1);
          }
          
          if (workDays.length === 0) return;
          
          allAssignments.forEach(assignment => {
            const userId = assignment.userId;
            const totalHours = assignment.hours || 0;
            if (totalHours <= 0) return;
            
            if (!workload[userId]) workload[userId] = {};
            
            // dailyOverrides pr√ºfen
            const overrides = wp.dailyOverrides?.[userId];
            const hoursPerDay = totalHours / workDays.length;
            
            workDays.forEach(day => {
              const dayHours = overrides?.[day] !== undefined ? overrides[day] : hoursPerDay;
              if (!workload[userId][day]) workload[userId][day] = { total: 0, details: [] };
              workload[userId][day].total += dayHours;
              workload[userId][day].details.push({ wpName: wp.name, hours: dayHours, wpId: wp.id, color: wp.color });
            });
          });
        });
        
        return workload;
      }, [workPackages, holidays]);
      
      const isUserAssigned = (assignments, userId) => {
        if (!assignments) return false;
        return assignments.some(a => (typeof a === 'object' ? a.userId : a) === userId);
      };
      
      const getUserHours = (assignments, userId) => {
        if (!assignments) return 0;
        const found = assignments.find(a => (typeof a === 'object' ? a.userId : a) === userId);
        return found && typeof found === 'object' ? (found.hours || 0) : 0;
      };
      
      // Alle WPs eines Users (Blatt-Pakete mit Zuweisung und Stunden)
      const getUserWorkPackages = (userId) => {
        return workPackages.filter(wp => {
          if (!wp.startDate || !wp.endDate) return false;
          const hasChildren = workPackages.some(w => w.parentId === wp.id);
          if (hasChildren) return false;
          const allAssign = [
            ...((wp.responsibles || []).map(r => typeof r === 'object' ? r : { userId: r, hours: 0 })),
            ...((wp.editors || []).map(e => typeof e === 'object' ? e : { userId: e, hours: 0 }))
          ];
          return allAssign.some(a => a.userId === userId && a.hours > 0);
        });
      };
      
      // Arbeitstage eines WPs berechnen
      const getWPWorkDays = (wp) => {
        const start = parseLocalDate(wp.startDate);
        const end = parseLocalDate(wp.endDate);
        const days = [];
        const d = new Date(start);
        while (d <= end) {
          const dow = d.getDay();
          const ds = formatDate(d);
          if (dow !== 0 && dow !== 6 && !holidays[ds]) days.push(ds);
          d.setDate(d.getDate() + 1);
        }
        return days;
      };
      
      // Aktive Tage eines Users f√ºr ein WP ermitteln
      const getActiveDaysForWP = (wp, userId) => {
        const workDays = getWPWorkDays(wp);
        const overrides = wp.dailyOverrides?.[userId];
        if (!overrides || Object.keys(overrides).length === 0) return workDays; // alle aktiv
        return workDays.filter(d => (overrides[d] ?? -1) > 0);
      };
      
      // Tag togglen: Stunden gleichm√§√üig auf aktive Tage verteilen
      const toggleWPDayForUser = (wpId, userId, dayStr) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return;
        const allAssign = [
          ...((wp.responsibles || []).map(r => typeof r === 'object' ? r : { userId: r, hours: 0 })),
          ...((wp.editors || []).map(e => typeof e === 'object' ? e : { userId: e, hours: 0 }))
        ];
        const assignment = allAssign.find(a => a.userId === userId);
        if (!assignment || !assignment.hours) return;
        const totalHours = assignment.hours;
        const workDays = getWPWorkDays(wp);
        if (!workDays.includes(dayStr)) return;
        
        // Aktuelle Overrides holen oder initialisieren
        const current = { ...(wp.dailyOverrides?.[userId] || {}) };
        if (Object.keys(current).length === 0) {
          const hpd = totalHours / workDays.length;
          workDays.forEach(d => { current[d] = hpd; });
        }
        
        // Toggle
        const isActive = (current[dayStr] || 0) > 0;
        current[dayStr] = isActive ? 0 : 1; // tempor√§r
        
        // Aktive Tage und Neuverteilung
        const activeDays = workDays.filter(d => current[d] > 0);
        if (activeDays.length === 0) return; // mindestens 1 Tag muss aktiv sein
        
        const hpd = totalHours / activeDays.length;
        workDays.forEach(d => { current[d] = activeDays.includes(d) ? hpd : 0; });
        
        const newOverrides = { ...(wp.dailyOverrides || {}), [userId]: current };
        updateWorkPackage(wpId, 'dailyOverrides', newOverrides);
      };
      
      // Verschiebt alle dailyOverrides-Datums-Keys um daysDiff Tage
      const shiftDailyOverrides = (dailyOverrides, daysDiff) => {
        if (!dailyOverrides || daysDiff === 0) return dailyOverrides;
        const shifted = {};
        Object.entries(dailyOverrides).forEach(([userId, dayMap]) => {
          if (!dayMap || typeof dayMap !== 'object') { shifted[userId] = dayMap; return; }
          const newDayMap = {};
          Object.entries(dayMap).forEach(([dateStr, hours]) => {
            const d = parseLocalDate(dateStr);
            d.setDate(d.getDate() + daysDiff);
            newDayMap[formatDate(d)] = hours;
          });
          shifted[userId] = newDayMap;
        });
        return shifted;
      };
      
      // Gleichm√§√üige Verteilung: dailyOverrides f√ºr User l√∂schen ‚Üí Fallback auf Default
      const resetDailyOverrides = (wpId, userId) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp || !wp.dailyOverrides) return;
        const newOverrides = { ...wp.dailyOverrides };
        delete newOverrides[userId];
        updateWorkPackage(wpId, 'dailyOverrides', Object.keys(newOverrides).length > 0 ? newOverrides : undefined);
      };
      
      // Scroll zum Arbeitspaket im Gantt-Diagramm
      const scrollToWPInGantt = (wpId) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return;
        
        // Projektfilter anpassen falls n√∂tig
        if (selectedProjectId && selectedProjectId !== wp.projectId) {
          setSelectedProjectId(null); setSelectedFolderId(null);
        } else if (selectedFolderId) {
          const proj = projects.find(p => p.id === wp.projectId);
          if (proj && proj.folderId !== selectedFolderId) { setSelectedProjectId(null); setSelectedFolderId(null); }
        }
        // Alle Eltern-Pakete aufklappen
        const parentsToExpand = {};
        let pId = wp.parentId;
        while (pId) { parentsToExpand[pId] = true; const p = workPackages.find(w => w.id === pId); pId = p?.parentId; }
        if (Object.keys(parentsToExpand).length > 0) setExpandedPackages(prev => ({ ...prev, ...parentsToExpand }));
        // Sidebar highlighten
        setSidebarWPId(wpId);
        
        // Polling: Zeile im DOM finden und hinscrollen
        let n = 0;
        const go = () => {
          n++;
          const row = document.querySelector('[data-wp-row="' + wpId + '"]') || document.querySelector('[data-wp-row-right="' + wpId + '"]');
          if (row) {
            // scrollIntoView auf das Flow-Element (nicht den absoluten Balken)
            row.scrollIntoView({ block: 'center', behavior: 'instant' });
            // 3-fach Blink-Highlight auf dem Gantt-Balken
            setTimeout(() => {
              const bar = document.querySelector('[data-wp-id="' + wpId + '"]');
              if (bar) {
                let blink = 0;
                const glow = '0 0 0 3px #6366f1, 0 0 12px 4px rgba(99,102,241,0.4)';
                bar.style.transition = 'box-shadow 0.15s';
                const doBlink = () => {
                  bar.style.boxShadow = blink % 2 === 0 ? glow : '';
                  blink++;
                  if (blink < 7) { // 3x an, 3x aus, 1x final an
                    setTimeout(doBlink, 200);
                  } else {
                    // Final glow kurz stehen lassen, dann ausblenden
                    bar.style.boxShadow = glow;
                    setTimeout(() => { bar.style.transition = 'box-shadow 0.5s'; bar.style.boxShadow = ''; }, 800);
                  }
                };
                doBlink();
              }
            }, 50);
          } else if (n < 25) {
            setTimeout(go, 80);
          }
        };
        setTimeout(go, 50);
      };
      
      // Ressourcen-Feinplanung: Workload √∂ffnen, auf beteiligte User filtern
      const showWPResourcePlanning = (wpId) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return;
        const userIds = [...new Set([
          ...((wp.responsibles || []).map(a => typeof a === 'object' ? a.userId : a)),
          ...((wp.editors || []).map(a => typeof a === 'object' ? a.userId : a))
        ])];
        if (userIds.length === 0) {
          // Keine Mitarbeiter zugewiesen ‚Üí Sidebar √∂ffnen zum Zuweisen
          setSidebarWPId(wpId);
          return;
        }
        // Workload Panel √∂ffnen
        if (workloadPanelHeight === 0) setWorkloadPanelHeight(350);
        // Filter setzen
        setWorkloadFilter('mitarbeiter');
        setWlFocusWP({ wpId: wp.id, wpName: wp.name, userIds, color: wp.color || projects.find(p => p.id === wp.projectId)?.color || '#6366f1' });
        // User aufklappen
        setWorkloadExpandedUsers(prev => {
          const next = { ...prev };
          userIds.forEach(uid => { next[uid] = true; });
          return next;
        });
      };
      
      const toggleUserAssignment = React.useCallback((wpId, field, userId, isChecked, hours = 0) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return;
        let current = wp[field] || [];
        current = current.map(a => typeof a === 'object' ? a : { userId: a, hours: 0 });
        let updated;
        if (isChecked) {
          if (!current.some(a => a.userId === userId)) {
            updated = [...current, { userId, hours }];
          } else {
            updated = current;
          }
        } else {
          updated = current.filter(a => a.userId !== userId);
        }
        const newWPs = workPackages.map(w => w.id === wpId ? { ...w, [field]: updated } : w);
        saveWorkPackages(newWPs);
      }, [workPackages]);
      
      const updateUserHours = React.useCallback((wpId, field, userId, hours) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return;
        let current = wp[field] || [];
        current = current.map(a => typeof a === 'object' ? a : { userId: a, hours: 0 });
        const updated = current.map(a => a.userId === userId ? { ...a, hours } : a);
        const newWPs = workPackages.map(w => w.id === wpId ? { ...w, [field]: updated } : w);
        saveWorkPackages(newWPs);
      }, [workPackages]);
      
      const getFlatSortedList = (projectId) => {
        const projectWPs = workPackages.filter(wp => wp.projectId === projectId);
        const result = [];
        const addWithChildren = (parentId, level, parentIsLastPath = []) => {
          const children = projectWPs.filter(wp => wp.parentId === parentId).sort((a, b) => (a.order || 0) - (b.order || 0));
          children.forEach((wp, idx) => {
            const hasChildren = projectWPs.some(w => w.parentId === wp.id);
            const isExpanded = expandedPackages[wp.id] !== false;
            const isLastChild = idx === children.length - 1;
            result.push({ ...wp, _level: level, _hasChildren: hasChildren, _isLastChild: isLastChild, _parentIsLastPath: [...parentIsLastPath] });
            if (hasChildren && isExpanded) addWithChildren(wp.id, level + 1, [...parentIsLastPath, isLastChild]);
          });
        };
        addWithChildren(null, 0);
        return result;
      };
      
      // Maximale Tiefe der Hierarchie berechnen
      const getMaxLevel = () => {
        let max = 0;
        const countLevel = (parentId, level) => {
          const children = workPackages.filter(w => w.parentId === parentId && workPackages.some(c => c.parentId === w.id));
          if (children.length > 0) {
            if (level + 1 > max) max = level + 1;
            children.forEach(c => countLevel(c.id, level + 1));
          }
        };
        workPackages.filter(w => !w.parentId).forEach(w => {
          if (workPackages.some(c => c.parentId === w.id)) { max = Math.max(max, 0); countLevel(w.id, 0); }
        });
        return max;
      };
      
      // Aktuelle Aufklapp-Tiefe ermitteln
      const getCurrentExpandLevel = () => {
        const maxLvl = getMaxLevel();
        for (let lvl = 0; lvl <= maxLvl; lvl++) {
          const parentsAtLevel = workPackages.filter(wp => {
            const getLevel = (id, l) => { const parent = workPackages.find(w => w.id === id)?.parentId; return parent ? getLevel(parent, l + 1) : l; };
            return getLevel(wp.id, 0) === lvl && workPackages.some(c => c.parentId === wp.id);
          });
          if (parentsAtLevel.some(wp => expandedPackages[wp.id] === false)) return lvl;
        }
        return maxLvl + 1;
      };
      
      // Eine Ebene mehr aufklappen
      const expandOneLevel = () => {
        const targetLevel = getCurrentExpandLevel();
        const newExpanded = { ...expandedPackages };
        workPackages.forEach(wp => {
          if (!workPackages.some(c => c.parentId === wp.id)) return;
          const getLevel = (id, l) => { const parent = workPackages.find(w => w.id === id)?.parentId; return parent ? getLevel(parent, l + 1) : l; };
          const lvl = getLevel(wp.id, 0);
          if (lvl <= targetLevel) newExpanded[wp.id] = true;
        });
        setExpandedPackages(newExpanded);
      };
      
      // Eine Ebene zuklappen
      const collapseOneLevel = () => {
        const currentLevel = getCurrentExpandLevel();
        const targetLevel = Math.max(0, currentLevel - 1);
        const newExpanded = { ...expandedPackages };
        workPackages.forEach(wp => {
          if (!workPackages.some(c => c.parentId === wp.id)) return;
          const getLevel = (id, l) => { const parent = workPackages.find(w => w.id === id)?.parentId; return parent ? getLevel(parent, l + 1) : l; };
          const lvl = getLevel(wp.id, 0);
          if (lvl >= targetLevel) newExpanded[wp.id] = false;
        });
        setExpandedPackages(newExpanded);
      };
      
      // Auf bestimmte Ebene aufklappen
      const expandToLevel = (targetLevel) => {
        const newExpanded = { ...expandedPackages };
        workPackages.forEach(wp => {
          if (!workPackages.some(c => c.parentId === wp.id)) return;
          const getLevel = (id, l) => { const parent = workPackages.find(w => w.id === id)?.parentId; return parent ? getLevel(parent, l + 1) : l; };
          const lvl = getLevel(wp.id, 0);
          newExpanded[wp.id] = lvl < targetLevel;
        });
        setExpandedPackages(newExpanded);
      };
      
      const dateToX = (dateStr) => {
        if (!dateStr) return 0;
        // Verwende parseLocalDate f√ºr konsistente Datums-Verarbeitung
        const date = parseLocalDate(dateStr);
        if (!date) return 0;
        const startOfTimeline = getWeekDates(timelineStartWeek, new Date().getFullYear())[0];
        return Math.round((date - startOfTimeline) / (1000 * 60 * 60 * 24)) * DAY_WIDTH;
      };
      
      const xToDate = (x) => {
        const startOfTimeline = getWeekDates(timelineStartWeek, new Date().getFullYear())[0];
        const days = Math.floor(x / DAY_WIDTH);
        const date = new Date(startOfTimeline);
        date.setDate(date.getDate() + days);
        return formatDate(date);
      };
      
      const addWorkPackage = (projectId, parentId = null, customStartDate = null) => {
        const siblings = workPackages.filter(wp => wp.projectId === projectId && wp.parentId === parentId);
        const maxOrder = siblings.length > 0 ? Math.max(...siblings.map(s => s.order || 0)) : 0;
        // Bei Tochter-Arbeitspaketen: Startdatum des Eltern-WPs √ºbernehmen
        const parentWP = parentId ? workPackages.find(w => w.id === parentId) : null;
        const baseDate = customStartDate || (parentWP?.startDate) || null;
        const startDate = baseDate ? new Date(baseDate + 'T12:00:00') : new Date();
        const endDate = new Date(startDate);
        endDate.setDate(endDate.getDate() + 4); // Standard: 5 Tage
        const newWP = {
          id: `wp_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
          projectId, parentId, name: 'Neues Arbeitspaket',
          startDate: formatDate(startDate), endDate: formatDate(endDate),
          order: maxOrder + 1, color: null, responsibles: [], editors: [], divisionIds: [], plannedHours: 0
        };
        saveWorkPackages([...workPackages, newWP]);
        setEditingName(newWP.id);
      };
      
      const addWorkPackageBelow = (wpId) => {
        const refWP = workPackages.find(w => w.id === wpId);
        if (!refWP) return;
        const refOrder = refWP.order || 0;
        // Alle Geschwister mit h√∂herer Order um 1 nach unten schieben
        const updated = workPackages.map(wp => 
          wp.projectId === refWP.projectId && wp.parentId === refWP.parentId && (wp.order || 0) > refOrder
            ? { ...wp, order: (wp.order || 0) + 1 }
            : wp
        );
        const startDate = refWP.startDate ? new Date(refWP.startDate + 'T12:00:00') : new Date();
        const endDate = new Date(startDate);
        endDate.setDate(endDate.getDate() + 4);
        const newWP = {
          id: `wp_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
          projectId: refWP.projectId, parentId: refWP.parentId, name: 'Neues Arbeitspaket',
          startDate: formatDate(startDate), endDate: formatDate(endDate),
          order: refOrder + 1, color: null, responsibles: [], editors: [], divisionIds: [], plannedHours: 0
        };
        saveWorkPackages([...updated, newWP]);
        setEditingName(newWP.id);
      };
      
      const deleteWorkPackage = (wpId) => {
        const toDelete = [wpId, ...getAllDescendants(wpId, workPackages).map(d => d.id)];
        saveWorkPackages(workPackages.filter(wp => !toDelete.includes(wp.id)));
        saveDependencies(dependencies.filter(d => !toDelete.includes(d.fromId) && !toDelete.includes(d.toId)));
        if (selectedWP?.id === wpId) setSelectedWP(null);
        if (sidebarWPId === wpId) setSidebarWPId(null);
      };
      
      const addDependency = (fromId, toId, type = 'FS') => {
        if (fromId === toId) return;
        if (dependencies.some(d => d.fromId === fromId && d.toId === toId && d.type === type)) return;
        const fromWP = workPackages.find(w => w.id === fromId);
        const toWP = workPackages.find(w => w.id === toId);
        let lagDays = 0;
        if (fromWP && toWP) {
          if (type === 'SS' && fromWP.startDate && toWP.startDate) {
            // Start-to-Start: Lag basiert auf Startdaten
            lagDays = Math.round((parseLocalDate(toWP.startDate) - parseLocalDate(fromWP.startDate)) / (1000 * 60 * 60 * 24));
          } else if (type === 'FS' && fromWP.endDate && toWP.startDate) {
            // Finish-to-Start: Lag basiert auf Ende‚ÜíStart
            lagDays = Math.round((parseLocalDate(toWP.startDate) - parseLocalDate(fromWP.endDate)) / (1000 * 60 * 60 * 24));
          }
        }
        saveDependencies([...dependencies, { id: `dep_${Date.now()}`, fromId, toId, lagDays, type }]);
      };
      
      const deleteDependency = (depId) => saveDependencies(dependencies.filter(d => d.id !== depId));
      
      const updateWorkPackage = React.useCallback((wpId, field, value) => {
        const updated = workPackages.map(wp => wp.id === wpId ? { ...wp, [field]: value } : wp);
        saveWorkPackages(updated);
        if (selectedWP?.id === wpId) setSelectedWP(prev => prev ? { ...prev, [field]: value } : null);
      }, [workPackages, selectedWP]);
      
      const indentWorkPackage = (wpId) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return;
        const siblings = workPackages.filter(w => w.projectId === wp.projectId && w.parentId === wp.parentId).sort((a, b) => (a.order || 0) - (b.order || 0));
        const myIndex = siblings.findIndex(s => s.id === wpId);
        if (myIndex <= 0) return;
        const newParent = siblings[myIndex - 1];
        const newSiblings = workPackages.filter(w => w.parentId === newParent.id);
        const maxOrder = newSiblings.length > 0 ? Math.max(...newSiblings.map(s => s.order || 0)) : 0;
        const updated = workPackages.map(w => w.id === wpId ? { ...w, parentId: newParent.id, order: maxOrder + 1 } : w);
        saveWorkPackages(updated);
        setExpandedPackages(prev => ({ ...prev, [newParent.id]: true }));
      };
      
      const outdentWorkPackage = (wpId) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp || !wp.parentId) return;
        const parent = workPackages.find(w => w.id === wp.parentId);
        if (!parent) return;
        const newOrder = (parent.order || 0) + 0.5;
        const updated = workPackages.map(w => w.id === wpId ? { ...w, parentId: parent.parentId, order: newOrder } : w);
        const reordered = updated.filter(w => w.projectId === wp.projectId && w.parentId === parent.parentId).sort((a, b) => (a.order || 0) - (b.order || 0)).map((w, i) => ({ ...w, order: i + 1 }));
        const others = updated.filter(w => w.projectId !== wp.projectId || w.parentId !== parent.parentId);
        saveWorkPackages([...others, ...reordered]);
      };
      
      // Bulk-Operationen f√ºr Multi-Select
      const bulkIndent = () => {
        if (selectedWPs.length === 0) return;
        const idsToProcess = [...selectedWPs]; // Kopie der IDs
        // Sortiere nach Order damit die Reihenfolge stimmt
        const sorted = idsToProcess.map(id => workPackages.find(w => w.id === id)).filter(Boolean).sort((a, b) => (a.order || 0) - (b.order || 0));
        sorted.forEach(wp => indentWorkPackage(wp.id));
        // Selection bleibt erhalten - keine √Ñnderung an selectedWPs
      };
      
      const bulkOutdent = () => {
        if (selectedWPs.length === 0) return;
        const idsToProcess = [...selectedWPs]; // Kopie der IDs
        // Sortiere umgekehrt nach Order f√ºr Outdent
        const sorted = idsToProcess.map(id => workPackages.find(w => w.id === id)).filter(Boolean).sort((a, b) => (b.order || 0) - (a.order || 0));
        sorted.forEach(wp => outdentWorkPackage(wp.id));
        // Selection bleibt erhalten - keine √Ñnderung an selectedWPs
      };
      
      const bulkDelete = () => {
        if (selectedWPs.length === 0) return;
        if (!confirm(`${selectedWPs.length} Arbeitspakete l√∂schen?`)) return;
        const updated = workPackages.filter(wp => !selectedWPs.includes(wp.id));
        saveWorkPackages(updated);
        setSelectedWPs([]);
      };
      
      const bulkSetColor = (color) => {
        if (selectedWPs.length === 0) return;
        const updated = workPackages.map(wp => selectedWPs.includes(wp.id) ? { ...wp, color } : wp);
        saveWorkPackages(updated);
      };
      
      // Sidebar √∂ffnen (Scroll wird automatisch durch useLayoutEffect wiederhergestellt)
      const openSidebar = (wpId) => {
        setSelectedWPs([]);
        setSidebarWPId(wpId);
      };
      
      // Click-Handler f√ºr WP-Auswahl (STRG/SHIFT) oder Sidebar √∂ffnen (normaler Klick)
      const handleWPClick = (e, wp, flatList) => {
        e.stopPropagation();
        
        if (e.ctrlKey || e.metaKey) {
          // STRG/CMD: Toggle einzelnes WP
          setSelectedWPs(prev => prev.includes(wp.id) ? prev.filter(id => id !== wp.id) : [...prev, wp.id]);
          setLastClickedWP(wp.id);
        } else if (e.shiftKey && lastClickedWP) {
          // SHIFT: Bereich ausw√§hlen
          const lastIndex = flatList.findIndex(w => w.id === lastClickedWP);
          const currentIndex = flatList.findIndex(w => w.id === wp.id);
          if (lastIndex !== -1 && currentIndex !== -1) {
            const start = Math.min(lastIndex, currentIndex);
            const end = Math.max(lastIndex, currentIndex);
            const rangeIds = flatList.slice(start, end + 1).map(w => w.id);
            setSelectedWPs(prev => [...new Set([...prev, ...rangeIds])]);
          }
        } else {
          // Normaler Klick: Sidebar √∂ffnen (wie Doppelklick auf Gantt-Balken)
          openSidebar(wp.id);
          setLastClickedWP(wp.id);
        }
      };
      
      // Auswahl aufheben bei Klick au√üerhalb
      const clearSelection = () => {
        if (selectedWPs.length > 0) {
          setSelectedWPs([]);
        }
      };
      
      // Verschiebt ein WP an eine neue Position (vor/nach einem anderen WP oder als Kind)
      const moveWorkPackage = (draggedId, targetId, position) => {
        if (draggedId === targetId) return;
        const draggedWp = workPackages.find(w => w.id === draggedId);
        const targetWp = workPackages.find(w => w.id === targetId);
        if (!draggedWp || !targetWp) return;
        
        // Pr√ºfe ob target ein Nachkomme von dragged ist (w√ºrde Zirkelbezug erzeugen)
        const isDescendant = (parentId, checkId) => {
          if (parentId === checkId) return true;
          const children = workPackages.filter(w => w.parentId === parentId);
          return children.some(c => isDescendant(c.id, checkId));
        };
        if (isDescendant(draggedId, targetId)) return;
        
        let newParentId, newOrder;
        
        if (position === 'child') {
          // Als Kind des Targets einf√ºgen
          newParentId = targetId;
          const children = workPackages.filter(w => w.parentId === targetId);
          newOrder = children.length > 0 ? Math.max(...children.map(c => c.order || 0)) + 1 : 1;
        } else {
          // Vor oder nach dem Target als Geschwister
          newParentId = targetWp.parentId;
          const siblings = workPackages.filter(w => w.projectId === targetWp.projectId && w.parentId === newParentId && w.id !== draggedId);
          const targetOrder = targetWp.order || 0;
          newOrder = position === 'before' ? targetOrder - 0.5 : targetOrder + 0.5;
        }
        
        // Update das gezogene WP
        let updated = workPackages.map(w => w.id === draggedId ? { ...w, parentId: newParentId, order: newOrder } : w);
        
        // Reorder alle Geschwister um saubere Nummern zu haben
        const siblingsToReorder = updated.filter(w => w.projectId === draggedWp.projectId && w.parentId === newParentId);
        const reordered = siblingsToReorder.sort((a, b) => (a.order || 0) - (b.order || 0)).map((w, i) => ({ ...w, order: i + 1 }));
        const others = updated.filter(w => w.projectId !== draggedWp.projectId || w.parentId !== newParentId);
        
        saveWorkPackages([...others, ...reordered]);
        
        // Expand parent wenn als Kind eingef√ºgt
        if (position === 'child') {
          setExpandedPackages(prev => ({ ...prev, [targetId]: true }));
        }
      };
      
      const toggleExpand = (wpId) => setExpandedPackages(prev => ({ ...prev, [wpId]: prev[wpId] === false ? true : false }));
      
      const moveWithDependencies = (wpId, newStartDate, newEndDate) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return;
        
        const oldEndDate = parseLocalDate(wp.endDate);
        const newEnd = parseLocalDate(newEndDate);
        const daysDiff = Math.round((newEnd - oldEndDate) / (1000 * 60 * 60 * 24));
        
        let updated = workPackages.map(w => w.id === wpId ? { ...w, startDate: newStartDate, endDate: newEndDate } : w);
        let updatedDeps = [...dependencies];
        
        if (daysDiff > 0) {
          // Nach RECHTS geschoben (sp√§ter) ‚Üí je nach Modus
          if (resizeMode === 'rigid') {
            // Starr: Alle Nachfolger sofort mitschieben, Lag bleibt erhalten
            const processSuccessorsRigid = (sourceId, shiftAmount) => {
              dependencies.filter(d => d.fromId === sourceId).forEach(dep => {
                const depWP = updated.find(w => w.id === dep.toId);
                if (depWP && depWP.startDate) {
                  // √úberspringe gesperrte WPs
                  if (depWP.locked) return;
                  const newDepStart = parseLocalDate(depWP.startDate);
                  newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                  const newDepEnd = parseLocalDate(depWP.endDate);
                  newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                  updated = updated.map(w => w.id === dep.toId ? { ...w, startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) } : w);
                  processSuccessorsRigid(dep.toId, shiftAmount);
                }
              });
            };
            processSuccessorsRigid(wpId, daysDiff);
          } else {
            // Magnetisch: Puffer erst aufbrauchen, dann verschieben
            const processSuccessorsMagnetic = (sourceId, remainingShift) => {
              dependencies.filter(d => d.fromId === sourceId).forEach(dep => {
                const depIndex = updatedDeps.findIndex(d => d.id === dep.id);
                const currentLag = dep.lagDays || 0;
                const depWP = updated.find(w => w.id === dep.toId);
                
                // √úberspringe gesperrte WPs
                if (depWP && depWP.locked) return;
                
                if (currentLag >= remainingShift) {
                  // Lag reicht aus - nur Lag reduzieren, B bleibt
                  if (depIndex >= 0) {
                    updatedDeps[depIndex] = { ...updatedDeps[depIndex], lagDays: currentLag - remainingShift };
                  }
                } else {
                  // Lag reicht nicht - Lag auf 0 setzen und Rest verschieben
                  const shiftAmount = remainingShift - currentLag;
                  if (depIndex >= 0) {
                    updatedDeps[depIndex] = { ...updatedDeps[depIndex], lagDays: 0 };
                  }
                  
                  if (depWP && depWP.startDate) {
                    const newDepStart = parseLocalDate(depWP.startDate);
                    newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                    const newDepEnd = parseLocalDate(depWP.endDate);
                    newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                    updated = updated.map(w => w.id === dep.toId ? { ...w, startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) } : w);
                    processSuccessorsMagnetic(dep.toId, shiftAmount);
                  }
                }
              });
            };
            processSuccessorsMagnetic(wpId, daysDiff);
          }
        } else if (daysDiff < 0) {
          // Nach LINKS geschoben (fr√ºher)
          if (resizeMode === 'rigid') {
            // Starr: Alle Nachfolger auch nach links mitschieben, Lag bleibt erhalten
            const processSuccessorsRigidLeft = (sourceId, shiftAmount) => {
              dependencies.filter(d => d.fromId === sourceId).forEach(dep => {
                const depWP = updated.find(w => w.id === dep.toId);
                if (depWP && depWP.startDate) {
                  if (depWP.locked) return;
                  const newDepStart = parseLocalDate(depWP.startDate);
                  newDepStart.setDate(newDepStart.getDate() + shiftAmount); // shiftAmount ist negativ
                  const newDepEnd = parseLocalDate(depWP.endDate);
                  newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                  updated = updated.map(w => w.id === dep.toId ? { ...w, startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) } : w);
                  processSuccessorsRigidLeft(dep.toId, shiftAmount);
                }
              });
            };
            processSuccessorsRigidLeft(wpId, daysDiff);
          } else {
            // Magnetisch: Abstand wird gr√∂√üer, B bleibt wo es ist
            dependencies.filter(d => d.fromId === wpId).forEach(dep => {
              const depIndex = updatedDeps.findIndex(d => d.id === dep.id);
              if (depIndex >= 0) {
                const currentLag = dep.lagDays || 0;
                updatedDeps[depIndex] = { ...updatedDeps[depIndex], lagDays: currentLag + Math.abs(daysDiff) };
              }
            });
          }
        }
        
        // dailyOverrides f√ºr alle verschobenen WPs mitverschieben
        updated = updated.map(w => {
          const orig = workPackages.find(o => o.id === w.id);
          if (orig && w.startDate !== orig.startDate && w.dailyOverrides) {
            const diff = Math.round((parseLocalDate(w.startDate) - parseLocalDate(orig.startDate)) / (1000 * 60 * 60 * 24));
            return { ...w, dailyOverrides: shiftDailyOverrides(w.dailyOverrides, diff) };
          }
          return w;
        });
        
        saveWorkPackages(updated);
        saveDependencies(updatedDeps);
      };
      
      const moveSummaryWithChildren = (wpId, daysDiff) => {
        const descendants = getAllDescendants(wpId, workPackages);
        // Wenn ein Kind fixiert ist, darf der Summary-Balken nicht verschoben werden
        if (descendants.some(d => d.locked)) return;
        const idsToMove = [wpId, ...descendants.map(d => d.id)];
        
        let updated = workPackages.map(wp => {
          if (idsToMove.includes(wp.id) && wp.startDate && wp.endDate) {
            const newStart = parseLocalDate(wp.startDate);
            newStart.setDate(newStart.getDate() + daysDiff);
            const newEnd = parseLocalDate(wp.endDate);
            newEnd.setDate(newEnd.getDate() + daysDiff);
            return { ...wp, startDate: formatDate(newStart), endDate: formatDate(newEnd) };
          }
          return wp;
        });
        
        let updatedDeps = [...dependencies];
        
        if (daysDiff > 0) {
          // Nach RECHTS ‚Üí externe Abh√§ngigkeiten je nach Modus behandeln
          if (resizeMode === 'rigid') {
            // Starr: Alle externen Nachfolger sofort mitschieben
            const processExternalRigid = (sourceIds, shiftAmount) => {
              dependencies.filter(d => sourceIds.includes(d.fromId) && !idsToMove.includes(d.toId)).forEach(dep => {
                const depWP = updated.find(w => w.id === dep.toId);
                if (depWP && depWP.startDate) {
                  if (depWP.locked) return;
                  const newDepStart = parseLocalDate(depWP.startDate);
                  newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                  const newDepEnd = parseLocalDate(depWP.endDate);
                  newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                  updated = updated.map(w => w.id === dep.toId ? { ...w, startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) } : w);
                  processExternalRigid([dep.toId], shiftAmount);
                }
              });
            };
            processExternalRigid(idsToMove, daysDiff);
          } else {
            // Magnetisch: Puffer aufbrauchen, dann verschieben
            const processExternalMagnetic = (sourceIds, remainingShift) => {
              dependencies.filter(d => sourceIds.includes(d.fromId) && !idsToMove.includes(d.toId)).forEach(dep => {
                const depWP = updated.find(w => w.id === dep.toId);
                if (depWP && depWP.locked) return;
                const depIndex = updatedDeps.findIndex(d => d.id === dep.id);
                const currentLag = dep.lagDays || 0;
                
                if (currentLag >= remainingShift) {
                  if (depIndex >= 0) {
                    updatedDeps[depIndex] = { ...updatedDeps[depIndex], lagDays: currentLag - remainingShift };
                  }
                } else {
                  const shiftAmount = remainingShift - currentLag;
                  if (depIndex >= 0) {
                    updatedDeps[depIndex] = { ...updatedDeps[depIndex], lagDays: 0 };
                  }
                  
                  const depWP = updated.find(w => w.id === dep.toId);
                  if (depWP && depWP.startDate) {
                    const newDepStart = parseLocalDate(depWP.startDate);
                    newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                    const newDepEnd = parseLocalDate(depWP.endDate);
                    newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                    updated = updated.map(w => w.id === dep.toId ? { ...w, startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) } : w);
                    processExternalMagnetic([dep.toId], shiftAmount);
                  }
                }
              });
            };
            processExternalMagnetic(idsToMove, daysDiff);
          }
        } else if (daysDiff < 0) {
          // Nach LINKS
          if (resizeMode === 'rigid') {
            // Starr: Alle externen Nachfolger auch nach links mitschieben
            const processExternalRigidLeft = (sourceIds, shiftAmount) => {
              dependencies.filter(d => sourceIds.includes(d.fromId) && !idsToMove.includes(d.toId)).forEach(dep => {
                const depWP = updated.find(w => w.id === dep.toId);
                if (depWP && depWP.startDate) {
                  if (depWP.locked) return;
                  const newDepStart = parseLocalDate(depWP.startDate);
                  newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                  const newDepEnd = parseLocalDate(depWP.endDate);
                  newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                  updated = updated.map(w => w.id === dep.toId ? { ...w, startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) } : w);
                  processExternalRigidLeft([dep.toId], shiftAmount);
                }
              });
            };
            processExternalRigidLeft(idsToMove, daysDiff);
          } else {
            // Magnetisch: Abstand wird gr√∂√üer, externe Nachfolger bleiben
            dependencies.filter(d => idsToMove.includes(d.fromId) && !idsToMove.includes(d.toId)).forEach(dep => {
              const depIndex = updatedDeps.findIndex(d => d.id === dep.id);
              if (depIndex >= 0) {
                const currentLag = dep.lagDays || 0;
                updatedDeps[depIndex] = { ...updatedDeps[depIndex], lagDays: currentLag + Math.abs(daysDiff) };
              }
            });
          }
        }
        
        // dailyOverrides f√ºr alle verschobenen WPs mitverschieben
        updated = updated.map(w => {
          const orig = workPackages.find(o => o.id === w.id);
          if (orig && w.startDate !== orig.startDate && w.dailyOverrides) {
            const diff = Math.round((parseLocalDate(w.startDate) - parseLocalDate(orig.startDate)) / (1000 * 60 * 60 * 24));
            return { ...w, dailyOverrides: shiftDailyOverrides(w.dailyOverrides, diff) };
          }
          return w;
        });
        
        saveWorkPackages(updated);
        saveDependencies(updatedDeps);
      };
      
      const resizeWithDependencies = (wpId, newEndDate) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return;
        
        const oldEndDate = parseLocalDate(wp.endDate);
        const newEnd = parseLocalDate(newEndDate);
        const daysDiff = Math.round((newEnd - oldEndDate) / (1000 * 60 * 60 * 24));
        
        let updated = workPackages.map(w => w.id === wpId ? { ...w, endDate: newEndDate } : w);
        let updatedDeps = [...dependencies];
        
        if (daysDiff > 0) {
          if (resizeMode === 'rigid') {
            // Starr: Alle Nachfolger sofort mitschieben, Lag bleibt erhalten
            const processSuccessorsRigid = (sourceId, shiftAmount) => {
              dependencies.filter(d => d.fromId === sourceId).forEach(dep => {
                const depWP = updated.find(w => w.id === dep.toId);
                if (depWP && depWP.startDate) {
                  if (depWP.locked) return;
                  const newDepStart = parseLocalDate(depWP.startDate);
                  newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                  const newDepEnd = parseLocalDate(depWP.endDate);
                  newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                  updated = updated.map(w => w.id === dep.toId ? { ...w, startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) } : w);
                  processSuccessorsRigid(dep.toId, shiftAmount);
                }
              });
            };
            processSuccessorsRigid(wpId, daysDiff);
          } else {
            // Magnetisch: Puffer erst aufbrauchen, dann verschieben
            const processSuccessorsMagnetic = (sourceId, remainingShift) => {
              dependencies.filter(d => d.fromId === sourceId).forEach(dep => {
                const _depWPLock = updated.find(w => w.id === dep.toId);
                if (_depWPLock && _depWPLock.locked) return;
                const depIndex = updatedDeps.findIndex(d => d.id === dep.id);
                const currentLag = dep.lagDays || 0;
                
                if (currentLag >= remainingShift) {
                  if (depIndex >= 0) {
                    updatedDeps[depIndex] = { ...updatedDeps[depIndex], lagDays: currentLag - remainingShift };
                  }
                } else {
                  const shiftAmount = remainingShift - currentLag;
                  if (depIndex >= 0) {
                    updatedDeps[depIndex] = { ...updatedDeps[depIndex], lagDays: 0 };
                  }
                  
                  const depWP = updated.find(w => w.id === dep.toId);
                  if (depWP && depWP.startDate) {
                    const newDepStart = parseLocalDate(depWP.startDate);
                    newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                    const newDepEnd = parseLocalDate(depWP.endDate);
                    newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                    updated = updated.map(w => w.id === dep.toId ? { ...w, startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) } : w);
                    processSuccessorsMagnetic(dep.toId, shiftAmount);
                  }
                }
              });
            };
            processSuccessorsMagnetic(wpId, daysDiff);
          }
        } else if (daysDiff < 0) {
          // Balken wird VERKLEINERT ‚Üí Abstand wird gr√∂√üer, B bleibt wo es ist
          dependencies.filter(d => d.fromId === wpId).forEach(dep => {
            const depIndex = updatedDeps.findIndex(d => d.id === dep.id);
            if (depIndex >= 0) {
              const currentLag = dep.lagDays || 0;
              updatedDeps[depIndex] = { ...updatedDeps[depIndex], lagDays: currentLag + Math.abs(daysDiff) };
            }
          });
        }
        
        saveWorkPackages(updated);
        saveDependencies(updatedDeps);
      };
      
      // Berechne Preview-Positionen f√ºr abh√§ngige Balken w√§hrend Drag/Resize
      const calculatePreviewPositions = (wpId, newEndDate) => {
        const wp = workPackages.find(w => w.id === wpId);
        if (!wp) return {};
        
        const oldEndDate = parseLocalDate(wp.endDate);
        const newEnd = parseLocalDate(newEndDate);
        const daysDiff = Math.round((newEnd - oldEndDate) / (1000 * 60 * 60 * 24));
        
        if (daysDiff === 0) return {};
        
        const previews = {};
        
        if (daysDiff > 0) {
          // Nach rechts
          if (resizeMode === 'rigid') {
            const processRigid = (sourceId, shiftAmount) => {
              dependencies.filter(d => d.fromId === sourceId).forEach(dep => {
                const depWP = workPackages.find(w => w.id === dep.toId);
                if (depWP && depWP.startDate) {
                  // Fixierte Termine nicht verschieben
                  if (depWP.locked) return;
                  const existingPreview = previews[dep.toId];
                  const baseStart = existingPreview ? parseLocalDate(existingPreview.startDate) : parseLocalDate(depWP.startDate);
                  const baseEnd = existingPreview ? parseLocalDate(existingPreview.endDate) : parseLocalDate(depWP.endDate);
                  const newDepStart = new Date(baseStart.getTime());
                  newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                  const newDepEnd = new Date(baseEnd.getTime());
                  newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                  previews[dep.toId] = { startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) };
                  processRigid(dep.toId, shiftAmount);
                }
              });
            };
            processRigid(wpId, daysDiff);
          } else {
            const processMagnetic = (sourceId, remainingShift) => {
              dependencies.filter(d => d.fromId === sourceId).forEach(dep => {
                const depWP = workPackages.find(w => w.id === dep.toId);
                if (depWP && depWP.startDate) {
                  // Fixierte Termine nicht verschieben
                  if (depWP.locked) return;
                  const currentLag = dep.lagDays || 0;
                  if (currentLag < remainingShift) {
                    const shiftAmount = remainingShift - currentLag;
                    const existingPreview = previews[dep.toId];
                    const baseStart = existingPreview ? parseLocalDate(existingPreview.startDate) : parseLocalDate(depWP.startDate);
                    const baseEnd = existingPreview ? parseLocalDate(existingPreview.endDate) : parseLocalDate(depWP.endDate);
                    const newDepStart = new Date(baseStart.getTime());
                    newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                    const newDepEnd = new Date(baseEnd.getTime());
                    newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                    previews[dep.toId] = { startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) };
                    processMagnetic(dep.toId, shiftAmount);
                  }
                }
              });
            };
            processMagnetic(wpId, daysDiff);
          }
        } else if (daysDiff < 0 && resizeMode === 'rigid') {
          // Nach links - nur bei rigid Mode werden Nachfolger mitgezogen
          const processRigidLeft = (sourceId, shiftAmount) => {
            dependencies.filter(d => d.fromId === sourceId).forEach(dep => {
              const depWP = workPackages.find(w => w.id === dep.toId);
              if (depWP && depWP.startDate) {
                // Fixierte Termine nicht verschieben
                if (depWP.locked) return;
                const existingPreview = previews[dep.toId];
                const baseStart = existingPreview ? parseLocalDate(existingPreview.startDate) : parseLocalDate(depWP.startDate);
                const baseEnd = existingPreview ? parseLocalDate(existingPreview.endDate) : parseLocalDate(depWP.endDate);
                const newDepStart = new Date(baseStart.getTime());
                newDepStart.setDate(newDepStart.getDate() + shiftAmount);
                const newDepEnd = new Date(baseEnd.getTime());
                newDepEnd.setDate(newDepEnd.getDate() + shiftAmount);
                previews[dep.toId] = { startDate: formatDate(newDepStart), endDate: formatDate(newDepEnd) };
                processRigidLeft(dep.toId, shiftAmount);
              }
            });
          };
          processRigidLeft(wpId, daysDiff);
        }
        
        return previews;
      };
      
      React.useEffect(() => {
        const handleMouseMove = (e) => {
          if (draggedWP) {
            const dx = e.clientX - draggedWP.startX;
            const daysDiff = Math.round(dx / DAY_WIDTH);
            
            if (draggedWP.isSummary) {
              setDraggedWP(prev => ({ ...prev, daysDiff }));
              // Preview f√ºr Summary-Drag berechnen
              if (daysDiff !== 0) {
                const wp = workPackages.find(w => w.id === draggedWP.wp.id);
                if (wp && wp.endDate) {
                  const newEnd = parseLocalDate(wp.endDate);
                  newEnd.setDate(newEnd.getDate() + daysDiff);
                  const previews = calculatePreviewPositions(draggedWP.wp.id, formatDate(newEnd));
                  setPreviewPositions(previews);
                  // Speichere Original-Positionen f√ºr Schatten (nur einmal)
                  if (Object.keys(originalPositionsRef.current).length === 0) {
                    const originals = { [draggedWP.wp.id]: { startDate: wp.startDate, endDate: wp.endDate } };
                    Object.keys(previews).forEach(id => {
                      const origWP = workPackages.find(w => w.id === id);
                      if (origWP) originals[id] = { startDate: origWP.startDate, endDate: origWP.endDate };
                    });
                    originalPositionsRef.current = originals;
                    setOriginalPositions(originals);
                  }
                }
              } else {
                setPreviewPositions({});
              }
            } else {
              let newStart = xToDate(draggedWP.originalX + dx);
              const wp = draggedWP.wp;
              const allowWeekend = wp.allowWeekend === true; // Default: NICHT erlaubt (Standard-Arbeitswoche)
              
              // Wenn freie Tage nicht erlaubt, zum n√§chsten Arbeitstag springen
              if (isNonWorkDay(newStart, allowWeekend)) {
                const skipped = skipNonWorkDays(newStart, true, allowWeekend);
                newStart = formatDate(skipped);
              }
              
              // Dauer berechnen (in Arbeitstagen oder KTn)
              const origStart = parseLocalDate(wp.startDate);
              const origEnd = parseLocalDate(wp.endDate);
              let duration;
              
              if (!allowWeekend || Object.keys(holidays).length > 0) {
                // Z√§hle Arbeitstage (ber√ºcksichtigt Wochenenden UND Feiertage)
                duration = countWorkingDays(origStart, origEnd, allowWeekend) - 1;
                const newEnd = addWorkingDays(parseLocalDate(newStart), duration, allowWeekend);
                setDraggedWP(prev => ({ ...prev, previewStart: newStart, previewEnd: formatDate(newEnd) }));
              } else {
                // Normale KT (nur wenn allowWeekend UND keine Feiertage)
                duration = (origEnd - origStart) / (1000 * 60 * 60 * 24);
                const newEnd = parseLocalDate(newStart);
                newEnd.setDate(newEnd.getDate() + duration);
                setDraggedWP(prev => ({ ...prev, previewStart: newStart, previewEnd: formatDate(newEnd) }));
              }
              
              // Preview f√ºr normale Drag berechnen
              const previewEnd = draggedWP.previewEnd || formatDate(new Date(parseLocalDate(newStart).setDate(parseLocalDate(newStart).getDate() + duration)));
              const previews = calculatePreviewPositions(wp.id, previewEnd);
              setPreviewPositions(previews);
              // Speichere Original-Positionen f√ºr Schatten (nur einmal)
              if (Object.keys(originalPositionsRef.current).length === 0) {
                const originals = { [wp.id]: { startDate: wp.startDate, endDate: wp.endDate } };
                Object.keys(previews).forEach(id => {
                  const origWP = workPackages.find(w => w.id === id);
                  if (origWP) originals[id] = { startDate: origWP.startDate, endDate: origWP.endDate };
                });
                originalPositionsRef.current = originals;
                setOriginalPositions(originals);
              }
            }
          }
          if (resizingWP) {
            const dx = e.clientX - resizingWP.startX;
            if (resizingWP.side === 'left') {
              // Links resizen - Start √§ndern
              const newStart = xToDate(resizingWP.originalStartX + dx);
              if (parseLocalDate(newStart) <= new Date(resizingWP.wp.endDate)) {
                setResizingWP(prev => ({ ...prev, previewStart: newStart }));
                // Speichere Original-Positionen f√ºr Schatten (nur einmal)
                if (Object.keys(originalPositionsRef.current).length === 0) {
                  const wp = resizingWP.wp;
                  const originals = { [wp.id]: { startDate: wp.startDate, endDate: wp.endDate } };
                  originalPositionsRef.current = originals;
                  setOriginalPositions(originals);
                }
              }
            } else {
              // Rechts resizen - Ende √§ndern (wie bisher)
              const newEnd = xToDate(resizingWP.originalEndX + dx);
              if (parseLocalDate(newEnd) >= new Date(resizingWP.wp.startDate)) {
                setResizingWP(prev => ({ ...prev, previewEnd: newEnd }));
                // Preview f√ºr Resize berechnen
                const previews = calculatePreviewPositions(resizingWP.wp.id, newEnd);
                setPreviewPositions(previews);
                // Speichere Original-Positionen f√ºr Schatten (nur einmal)
                if (Object.keys(originalPositionsRef.current).length === 0) {
                  const wp = resizingWP.wp;
                  const originals = { [wp.id]: { startDate: wp.startDate, endDate: wp.endDate } };
                  Object.keys(previews).forEach(id => {
                    const origWP = workPackages.find(w => w.id === id);
                    if (origWP) originals[id] = { startDate: origWP.startDate, endDate: origWP.endDate };
                  });
                  originalPositionsRef.current = originals;
                  setOriginalPositions(originals);
                }
              }
            }
          }
          if (linkingFrom) setLinkMousePos({ x: e.clientX, y: e.clientY });
        };
        const handleMouseUp = (e) => {
          if (draggedWP) {
            if (draggedWP.isSummary && draggedWP.daysDiff !== 0) {
              moveSummaryWithChildren(draggedWP.wp.id, draggedWP.daysDiff);
            } else if (draggedWP.previewStart) {
              moveWithDependencies(draggedWP.wp.id, draggedWP.previewStart, draggedWP.previewEnd);
            }
          }
          if (resizingWP) {
            if (resizingWP.side === 'left' && resizingWP.previewStart) {
              // Links resizen - nur Start √§ndern, Ende bleibt
              const updated = workPackages.map(w => w.id === resizingWP.wp.id ? { ...w, startDate: resizingWP.previewStart } : w);
              saveWorkPackages(updated);
            } else if (resizingWP.previewEnd) {
              resizeWithDependencies(resizingWP.wp.id, resizingWP.previewEnd);
            }
          }
          if (linkingFrom) {
            const target = e.target.closest('[data-wp-id]');
            if (target && target.dataset.wpId !== linkingFrom.id) addDependency(linkingFrom.id, target.dataset.wpId, linkingFrom.fromStart ? 'SS' : 'FS');
          }
          setDraggedWP(null); setResizingWP(null); setLinkingFrom(null); setLinkMousePos(null); setPreviewPositions({}); 
          originalPositionsRef.current = {};
          setOriginalPositions({});
        };
        if (draggedWP || resizingWP || linkingFrom) {
          // Markiere als Dragging
          window._ganttScrollTop.isDragging = true;
          
          const wrappedMouseMove = (e) => {
            // Scroll VOR dem Handler aktualisieren (vertikal + horizontal)
            if (ganttScrollRef.current) {
              window._ganttScrollTop.value = ganttScrollRef.current.scrollTop;
            }
            if (ganttHScrollRef.current) {
              window._ganttScrollLeft.value = ganttHScrollRef.current.scrollLeft;
            }
            handleMouseMove(e);
            // Scroll nach State-Update wiederherstellen (mehrfach zur Sicherheit)
            const restore = () => {
              if (ganttScrollRef.current && window._ganttScrollTop.isDragging) {
                ganttScrollRef.current.scrollTop = window._ganttScrollTop.value;
              }
              if (ganttHScrollRef.current && window._ganttScrollTop.isDragging) {
                ganttHScrollRef.current.scrollLeft = window._ganttScrollLeft.value;
              }
              if (headerScrollRef.current && window._ganttScrollTop.isDragging) {
                headerScrollRef.current.scrollLeft = window._ganttScrollLeft.value;
              }
              if (workloadScrollRef.current) workloadScrollRef.current.scrollLeft = window._ganttScrollLeft.value;
            };
            requestAnimationFrame(restore);
            setTimeout(restore, 0);
            setTimeout(restore, 16);
          };
          
          const wrappedMouseUp = (e) => {
            const scrollPosV = window._ganttScrollTop.value;
            const scrollPosH = window._ganttScrollLeft.value;
            handleMouseUp(e);
            // Scroll nach mouseUp wiederherstellen
            const restore = () => {
              if (ganttScrollRef.current) {
                ganttScrollRef.current.scrollTop = scrollPosV;
              }
              if (ganttHScrollRef.current) {
                ganttHScrollRef.current.scrollLeft = scrollPosH;
              }
              if (headerScrollRef.current) {
                headerScrollRef.current.scrollLeft = scrollPosH;
              }
            };
            requestAnimationFrame(restore);
            setTimeout(restore, 0);
            setTimeout(restore, 50);
            // Reset nach Delay
            setTimeout(() => {
              window._ganttScrollTop.isDragging = false;
            }, 100);
          };
          
          document.addEventListener('mousemove', wrappedMouseMove);
          document.addEventListener('mouseup', wrappedMouseUp);
          return () => { 
            document.removeEventListener('mousemove', wrappedMouseMove); 
            document.removeEventListener('mouseup', wrappedMouseUp); 
          };
        }
      }, [draggedWP, resizingWP, linkingFrom, workPackages, dependencies, DAY_WIDTH, resizeMode]);
      
      // Scroll-Position bei JEDEM Render wiederherstellen (Komponente wird bei Parent-State-√Ñnderungen remounted)
      if (!window._workloadScroll) window._workloadScroll = { top: 0 };
      React.useLayoutEffect(() => {
        if (window._ganttInitScrolled) {
          if (ganttScrollRef.current && window._ganttScrollTop.value !== undefined) {
            ganttScrollRef.current.scrollTop = window._ganttScrollTop.value;
          }
          if (ganttHScrollRef.current && window._ganttScrollLeft.value !== undefined) {
            ganttHScrollRef.current.scrollLeft = window._ganttScrollLeft.value;
          }
          if (headerScrollRef.current && window._ganttScrollLeft.value !== undefined) {
            headerScrollRef.current.scrollLeft = window._ganttScrollLeft.value;
          }
          if (window._ganttScrollLeft.value !== undefined) {
            if (workloadScrollRef.current) workloadScrollRef.current.scrollLeft = window._ganttScrollLeft.value;
          }
          // Workload vertical scroll restore
          if (workloadLeftRef.current) workloadLeftRef.current.scrollTop = window._workloadScroll.top;
          if (workloadScrollRef.current) workloadScrollRef.current.scrollTop = window._workloadScroll.top;
        }
      });
      
      React.useEffect(() => {
        if (!contextMenu) return;
        const handleClick = () => setContextMenu(null);
        const timer = setTimeout(() => document.addEventListener('click', handleClick), 10);
        return () => { clearTimeout(timer); document.removeEventListener('click', handleClick); };
      }, [contextMenu]);
      
      // Baseline-Men√º schlie√üen bei Klick au√üerhalb
      React.useEffect(() => {
        if (!baselineMenuOpen) return;
        const handleClick = () => setBaselineMenuOpen(false);
        const timer = setTimeout(() => document.addEventListener('click', handleClick), 10);
        return () => { clearTimeout(timer); document.removeEventListener('click', handleClick); };
      }, [baselineMenuOpen]);
      
      // Ansicht-Men√º schlie√üen bei Klick au√üerhalb
      React.useEffect(() => {
        if (!viewMenuOpen) return;
        const handleClick = () => setViewMenuOpen(false);
        const timer = setTimeout(() => document.addEventListener('click', handleClick), 10);
        return () => { clearTimeout(timer); document.removeEventListener('click', handleClick); };
      }, [viewMenuOpen]);
      
      // Spalten-Men√º schlie√üen bei Klick au√üerhalb
      React.useEffect(() => {
        if (!columnMenuOpen) return;
        const handleClick = () => setColumnMenuOpen(false);
        const timer = setTimeout(() => document.addEventListener('click', handleClick), 10);
        return () => { clearTimeout(timer); document.removeEventListener('click', handleClick); };
      }, [columnMenuOpen]);
      
      // Tag-Kontextmen√º schlie√üen bei Klick au√üerhalb
      React.useEffect(() => {
        if (!dayContextMenu) return;
        const handleClick = () => setDayContextMenu(null);
        const timer = setTimeout(() => document.addEventListener('click', handleClick), 10);
        return () => { clearTimeout(timer); document.removeEventListener('click', handleClick); };
      }, [dayContextMenu]);
      
      // Workload-Kontextmen√º schlie√üen bei Klick au√üerhalb
      React.useEffect(() => {
        if (!workloadContextMenu) return;
        const handleClick = () => setWorkloadContextMenu(null);
        const timer = setTimeout(() => document.addEventListener('click', handleClick), 10);
        return () => { clearTimeout(timer); document.removeEventListener('click', handleClick); };
      }, [workloadContextMenu]);
      
      // Vacation-Drag: global mousemove + mouseup
      React.useEffect(() => {
        if (!vacationDrag) return;
        const handleMouseMove = (e) => {
          const cell = e.target.closest('[data-vac-idx]');
          if (cell && cell.dataset.vacUserId === vacationDrag.userId) {
            const idx = parseInt(cell.dataset.vacIdx);
            setVacationDrag(prev => prev ? { ...prev, endIdx: idx } : null);
          }
        };
        const handleMouseUp = (e) => {
          if (vacationDrag && vacationDrag.endIdx !== undefined) {
            const minIdx = Math.min(vacationDrag.startIdx, vacationDrag.endIdx);
            const maxIdx = Math.max(vacationDrag.startIdx, vacationDrag.endIdx);
            const dates = [];
            for (let i = minIdx; i <= maxIdx; i++) {
              if (i >= 0 && i < allDays.length) {
                const day = allDays[i];
                const dow = day.getDay();
                if (dow !== 0 && dow !== 6) dates.push(formatDate(day));
              }
            }
            if (dates.length > 0) {
              const hasExisting = dates.some(ds => vacations.some(v => v.userId === vacationDrag.userId && v.date === ds));
              setVacationTypePicker({ x: e.clientX, y: e.clientY, userId: vacationDrag.userId, dates, hasExisting });
            }
          }
          setVacationDrag(null);
        };
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);
        return () => {
          document.removeEventListener('mousemove', handleMouseMove);
          document.removeEventListener('mouseup', handleMouseUp);
        };
      }, [vacationDrag, allDays, vacations]);
      
      // Vacation-Typ-Picker schlie√üen bei Klick au√üerhalb
      React.useEffect(() => {
        if (!vacationTypePicker) return;
        const handleClick = () => setVacationTypePicker(null);
        const timer = setTimeout(() => document.addEventListener('click', handleClick), 10);
        return () => { clearTimeout(timer); document.removeEventListener('click', handleClick); };
      }, [vacationTypePicker]);
      
      // ESC-Taste zum Aufheben der Multi-Auswahl
      React.useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'Escape' && selectedWPs.length > 0) {
            setSelectedWPs([]);
          }
        };
        document.addEventListener('keydown', handleKeyDown);
        return () => document.removeEventListener('keydown', handleKeyDown);
      }, [selectedWPs.length]);
      
      // Panel-Resize Handler (window-scope f√ºr Remount-Stabilit√§t)
      React.useEffect(() => {
        if (!isResizingPanel) return;
        const sidebarWidth = projectSidebarCollapsed ? 40 : 224;
        const handleMouseMove = (e) => {
          let newWidth = Math.round(Math.max(0, Math.min(800, e.clientX - sidebarWidth)));
          if (newWidth < 80) newWidth = 0;
          else if (newWidth < 200) newWidth = 200;
          // Direkt DOM manipulieren w√§hrend des Resize f√ºr fl√ºssiges Ergebnis
          const listEls = document.querySelectorAll('[data-panel-list]');
          listEls.forEach(el => { el.style.width = newWidth + 'px'; });
          window._ganttResizingPanel.lastWidth = newWidth;
        };
        const handleMouseUp = () => {
          const finalWidth = window._ganttResizingPanel.lastWidth;
          if (finalWidth !== undefined) setLeftPanelWidth(finalWidth);
          setIsResizingPanel(false);
          document.body.style.cursor = '';
          document.body.style.userSelect = '';
        };
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);
        document.body.style.cursor = 'col-resize';
        document.body.style.userSelect = 'none';
        return () => {
          document.removeEventListener('mousemove', handleMouseMove);
          document.removeEventListener('mouseup', handleMouseUp);
          document.body.style.cursor = '';
          document.body.style.userSelect = '';
        };
      }, [isResizingPanel, projectSidebarCollapsed]);
      
      // Column-Resize Handler (f√ºr individuelle Spaltenbreiten)
      React.useEffect(() => {
        if (!resizingColumn) return;
        let lastWidth = resizingColumn.startWidth;
        const handleMouseMove = (e) => {
          const diff = e.clientX - resizingColumn.startX;
          const newWidth = Math.round(Math.max(35, Math.min(200, resizingColumn.startWidth + diff)));
          if (newWidth !== lastWidth) {
            lastWidth = newWidth;
            setColumnWidths(prev => ({ ...prev, [resizingColumn.key]: newWidth }));
          }
        };
        const handleMouseUp = () => {
          setResizingColumn(null);
        };
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);
        document.body.style.cursor = 'col-resize';
        document.body.style.userSelect = 'none';
        return () => {
          document.removeEventListener('mousemove', handleMouseMove);
          document.removeEventListener('mouseup', handleMouseUp);
          document.body.style.cursor = '';
          document.body.style.userSelect = '';
        };
      }, [resizingColumn, setColumnWidths]);
      
      // Hilfsfunktion: Datum als dd.mm.yy formatieren
      const formatDateShort = (dateStr) => {
        if (!dateStr) return '';
        const d = new Date(dateStr);
        const day = String(d.getDate()).padStart(2, '0');
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const year = String(d.getFullYear()).slice(-2);
        return `${day}.${month}.${year}`;
      };
      
      // Row-Drag Handler
      React.useEffect(() => {
        if (!rowDragWP) return;
        
        const handleMouseUp = () => {
          if (dropTarget && rowDragWP) {
            moveWorkPackage(rowDragWP.id, dropTarget.wpId, dropTarget.position);
          }
          setRowDragWP(null);
          setDropTarget(null);
        };
        
        document.addEventListener('mouseup', handleMouseUp);
        return () => document.removeEventListener('mouseup', handleMouseUp);
      }, [rowDragWP, dropTarget]);
      
      const renderBracket = (wp, x, width, color) => {
        const totalHours = calculateTotalHours(wp.id);
        const isDragging = draggedWP?.wp.id === wp.id;
        const displayX = isDragging && draggedWP.daysDiff ? x + (draggedWP.daysDiff * DAY_WIDTH) : x;
        const assignmentText = showAssignments ? getAssignmentText(wp) : '';
        
        return (
          <React.Fragment>
            <div 
              className="absolute cursor-move group"
              style={{ left: displayX, width, top: 4, height: ROW_HEIGHT - 8, opacity: isDragging ? 0.6 : 1 }}
              data-wp-id={wp.id}
              onMouseEnter={(e) => { if (!draggedWP) { const rect = e.currentTarget.getBoundingClientRect(); setHoveredWP({ wp, x: rect.left, y: rect.bottom + 5, totalHours }); }}}
              onMouseLeave={() => setHoveredWP(null)}
              onClick={(e) => { e.stopPropagation(); if (sidebarWPId && !detailsCollapsed) { openSidebar(wp.id); } else { setSelectedWP(wp); } }}
              onDoubleClick={(e) => { e.stopPropagation(); e.preventDefault(); openSidebar(wp.id); }}
              onContextMenu={(e) => { e.preventDefault(); e.stopPropagation(); setContextMenu({ x: e.clientX, y: e.clientY, type: 'gantt-wp', wp, project: projects.find(p => p.id === wp.projectId) }); }}
              onMouseDown={(e) => { if (e.detail > 1) return; if (e.target.classList.contains('row-drag-handle')) return; if (getAllDescendants(wp.id, workPackages).some(d => d.locked)) return; e.preventDefault(); if (ganttScrollRef.current) { window._ganttScrollTop.value = ganttScrollRef.current.scrollTop; window._ganttScrollTop.isDragging = true; } if (ganttHScrollRef.current) { window._ganttScrollLeft.value = ganttHScrollRef.current.scrollLeft; } const calcDates = calculateDatesFromChildren(wp.id, workPackages); setDraggedWP({ wp, startX: e.clientX, originalX: dateToX(calcDates?.startDate), isSummary: true, daysDiff: 0 }); }}
            >
              <div className="absolute left-0 top-0 w-1.5 h-full" style={{ borderLeft: `2px solid ${color}`, borderTop: `2px solid ${color}`, borderTopLeftRadius: 3 }} />
              <div className="absolute top-0 left-1.5 right-1.5" style={{ borderTop: `2px solid ${color}` }} />
              <div className="absolute left-1/2 -translate-x-1/2 -top-1"><div className="w-2 h-2 rotate-45" style={{ backgroundColor: color }} /></div>
              <div className="absolute right-0 top-0 w-1.5 h-full" style={{ borderRight: `2px solid ${color}`, borderTop: `2px solid ${color}`, borderTopRightRadius: 3 }} />
              {/* Vertikaler Drag-Handle */}
              <div 
                className="row-drag-handle absolute left-1/2 -translate-x-1/2 top-2 w-4 h-2 cursor-grab opacity-0 group-hover:opacity-60 hover:opacity-100 flex justify-center gap-px rounded"
                style={{ backgroundColor: color }}
                onMouseDown={(e) => { e.stopPropagation(); e.preventDefault(); setRowDragWP(wp); }}
                title="Vertikal verschieben"
              >
                <div className="w-px h-full bg-white/60"></div>
                <div className="w-px h-full bg-white/60"></div>
                <div className="w-px h-full bg-white/60"></div>
              </div>
            </div>
            <div className="absolute text-xs whitespace-nowrap pointer-events-none" style={{ left: displayX + width + 8, top: ROW_HEIGHT / 2 - 7 }}>
              <span className="text-gray-700 font-medium">{wp.name}</span>
              {showHours && totalHours > 0 && <span className="text-gray-500 ml-2">{totalHours}h</span>}
              {assignmentText && <span className="text-indigo-500 ml-2">{assignmentText}</span>}
            </div>
          </React.Fragment>
        );
      };
      
      const renderBar = (wp, x, width, color, isChild) => {
        const isDragging = draggedWP?.wp.id === wp.id;
        const isResizing = resizingWP?.wp.id === wp.id;
        const hasChildren = getChildren(wp.id, workPackages).length > 0;
        const isSelected = selectedWP?.id === wp.id;
        const isSidebarActive = sidebarWPId === wp.id;
        const totalHours = calculateTotalHours(wp.id);
        const textWidth = wp.name.length * 6;
        const textFitsInBar = textWidth < width - 10;
        const assignmentText = showAssignments ? getAssignmentText(wp) : '';
        
        return (
          <React.Fragment>
            {/* Hover-Container f√ºr Link-Handles - Balkengr√∂√üe, Dots ragen raus */}
            <div 
              className="absolute"
              style={{ left: x, width: Math.max(width, DAY_WIDTH), top: 0, height: ROW_HEIGHT, zIndex: 5, overflow: 'visible' }}
              onMouseEnter={(e) => { if (!draggedWP && !resizingWP && !linkingFrom) { setHoveredWP({ wp, totalHours }); }}}
              onMouseLeave={(e) => { 
                if (!draggedWP && !resizingWP && !linkingFrom) setHoveredWP(null); 
              }}
            >
              {/* Link-Handles - weiter au√üen vom Balken */}
              {hoveredWP?.wp.id === wp.id && (
                <React.Fragment>
                  <div className="link-handle absolute w-5 h-5 rounded-full bg-indigo-500 border-2 border-white shadow-lg cursor-crosshair hover:bg-indigo-600 hover:scale-125 transition-all"
                    style={{ left: -20, top: '50%', transform: 'translateY(-50%)', zIndex: 35 }}
                    onMouseDown={(e) => { e.stopPropagation(); e.preventDefault(); const rect = e.target.getBoundingClientRect(); setLinkingFrom({ ...wp, startX: rect.left + rect.width / 2, startY: rect.top + rect.height / 2, fromStart: true }); setLinkMousePos({ x: e.clientX, y: e.clientY }); }}
                    title="Start-Abh√§ngigkeit (SS)" />
                  <div className="link-handle absolute w-5 h-5 rounded-full bg-indigo-500 border-2 border-white shadow-lg cursor-crosshair hover:bg-indigo-600 hover:scale-125 transition-all"
                    style={{ right: -20, top: '50%', transform: 'translateY(-50%)', zIndex: 35 }}
                    onMouseDown={(e) => { e.stopPropagation(); e.preventDefault(); const rect = e.target.getBoundingClientRect(); setLinkingFrom({ ...wp, startX: rect.left + rect.width / 2, startY: rect.top + rect.height / 2, fromStart: false }); setLinkMousePos({ x: e.clientX, y: e.clientY }); }}
                    title="Ende-Abh√§ngigkeit (FS)" />
                </React.Fragment>
              )}
            </div>
            <div data-wp-id={wp.id} className={`absolute rounded shadow-sm cursor-pointer group ${isSidebarActive ? 'ring-2 ring-blue-500 ring-offset-1' : isSelected ? 'ring-2 ring-indigo-500 ring-offset-1' : ''}`}
              style={{ left: x, width: Math.max(width, DAY_WIDTH), top: isChild ? 6 : 4, height: isChild ? ROW_HEIGHT - 12 : ROW_HEIGHT - 8, backgroundColor: color, opacity: isDragging || isResizing ? 0.6 : 1, zIndex: 6 }}
              onClick={(e) => { e.stopPropagation(); if (sidebarWPId && !detailsCollapsed) { openSidebar(wp.id); } else { setSelectedWP(wp); } }}
              onDoubleClick={(e) => { e.stopPropagation(); e.preventDefault(); openSidebar(wp.id); }}
              onContextMenu={(e) => { e.preventDefault(); e.stopPropagation(); setContextMenu({ x: e.clientX, y: e.clientY, type: 'gantt-wp', wp, project: projects.find(p => p.id === wp.projectId) }); }}
              onMouseEnter={(e) => { if (!draggedWP && !resizingWP && !linkingFrom) { setHoveredWP({ wp, totalHours }); }}}
              onMouseDown={(e) => { if (e.detail > 1) return; if (hasChildren || wp.locked || e.target.classList.contains('resize-handle') || e.target.classList.contains('link-handle') || e.target.classList.contains('row-drag-handle')) return; e.preventDefault(); if (ganttScrollRef.current) { window._ganttScrollTop.value = ganttScrollRef.current.scrollTop; window._ganttScrollTop.isDragging = true; } if (ganttHScrollRef.current) { window._ganttScrollLeft.value = ganttHScrollRef.current.scrollLeft; } setDraggedWP({ wp, startX: e.clientX, originalX: x, isSummary: false }); }}>
              {textFitsInBar && <div className="px-1 text-white text-xs truncate" style={{ fontSize: 10, lineHeight: `${isChild ? ROW_HEIGHT - 12 : ROW_HEIGHT - 8}px` }}>{wp.name}</div>}
              {!hasChildren && !wp.locked && <div className="resize-handle absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/30 rounded-l" onMouseDown={(e) => { e.stopPropagation(); if (ganttScrollRef.current) { window._ganttScrollTop.value = ganttScrollRef.current.scrollTop; window._ganttScrollTop.isDragging = true; } if (ganttHScrollRef.current) { window._ganttScrollLeft.value = ganttHScrollRef.current.scrollLeft; } setResizingWP({ wp, startX: e.clientX, originalStartX: x, originalEndX: x + width, side: 'left' }); }} />}
              {!hasChildren && !wp.locked && <div className="resize-handle absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize opacity-0 group-hover:opacity-100 bg-white/30 rounded-r" onMouseDown={(e) => { e.stopPropagation(); if (ganttScrollRef.current) { window._ganttScrollTop.value = ganttScrollRef.current.scrollTop; window._ganttScrollTop.isDragging = true; } if (ganttHScrollRef.current) { window._ganttScrollLeft.value = ganttHScrollRef.current.scrollLeft; } setResizingWP({ wp, startX: e.clientX, originalStartX: x, originalEndX: x + width, side: 'right' }); }} />}
              {/* Vertikaler Drag-Handle links am Balken */}
              <div 
                className="row-drag-handle absolute left-1 top-1/2 -translate-y-1/2 w-2 h-3 cursor-grab opacity-0 group-hover:opacity-60 hover:opacity-100 flex flex-col justify-center gap-px"
                onMouseDown={(e) => { e.stopPropagation(); e.preventDefault(); setRowDragWP(wp); }}
                title="Vertikal verschieben"
              >
                <div className="w-full h-px bg-white/80"></div>
                <div className="w-full h-px bg-white/80"></div>
                <div className="w-full h-px bg-white/80"></div>
              </div>
            </div>
            <div className="absolute text-xs whitespace-nowrap pointer-events-none" style={{ left: x + width + 22, top: ROW_HEIGHT / 2 - 7 }}>
              {wp.locked && <span className="text-orange-500 mr-1" title="Termin fixiert">üîí</span>}
              {showHours && totalHours > 0 && <span className="text-gray-500">{totalHours}h</span>}
              {!textFitsInBar && <span className="ml-1 text-gray-600">{wp.name}</span>}
              {assignmentText && <span className="text-indigo-500 ml-2">{assignmentText}</span>}
            </div>
          </React.Fragment>
        );
      };
      
      // Projekt-Filterung (muss VOR allProjectsData definiert werden!)
      // Priorit√§t: einzelnes Projekt > Ordner > alle
      const filteredProjects = selectedProjectId 
        ? (projects || []).filter(p => p.id === selectedProjectId && !p.archived) 
        : selectedFolderId
          ? (projects || []).filter(p => p.folderId === selectedFolderId && !p.archived)
          : (projects || []).filter(p => !p.archived);
      
      const allProjectsData = (filteredProjects || []).map(project => ({
        project,
        flatList: getFlatSortedList(project.id)
      }));
      
      // Berechne Monate f√ºr Header
      const getMonthsForWeeks = () => {
        const months = [];
        let currentMonth = null;
        let startWeekIdx = 0;
        
        weekNumbers.forEach((weekNum, idx) => {
          const weekDates = getWeekDates(weekNum, new Date().getFullYear());
          const monthIdx = weekDates[0].getMonth();
          const monthName = monthNames[monthIdx];
          
          if (monthName !== currentMonth) {
            if (currentMonth !== null) {
              months.push({ name: currentMonth, weeks: idx - startWeekIdx });
            }
            currentMonth = monthName;
            startWeekIdx = idx;
          }
        });
        months.push({ name: currentMonth, weeks: weekNumbers.length - startWeekIdx });
        return months;
      };
      
      const monthHeaders = getMonthsForWeeks();
      
      const UserAssignmentSection = ({ wpId, field, label, filterKey }) => {
        const wp = workPackages.find(w => w.id === wpId);
        const scrollRef = React.useRef(null);
        const scrollKey = `${wpId}-${field}`;
        
        // Scroll-Position nach jedem Render wiederherstellen
        React.useLayoutEffect(() => {
          if (scrollRef.current && _scrollPositions[scrollKey]) {
            scrollRef.current.scrollTop = _scrollPositions[scrollKey];
          }
        });
        
        if (!wp) return null;
        const assignments = wp[field] || [];
        const isFiltered = filterAssigned[filterKey];
        const filteredUsers = isFiltered ? sortedUsers.filter(u => isUserAssigned(assignments, u.id)) : sortedUsers;
        
        const saveScroll = () => {
          if (scrollRef.current) _scrollPositions[scrollKey] = scrollRef.current.scrollTop;
        };
        
        const handleToggle = (userId, checked) => {
          saveScroll();
          toggleUserAssignment(wpId, field, userId, checked, 0);
        };
        
        const handleHoursChange = (userId, value) => {
          saveScroll();
          updateUserHours(wpId, field, userId, parseFloat(value) || 0);
        };
        
        return (
          <div>
            <div className="flex items-center justify-between mb-1">
              <label className="text-xs font-semibold text-gray-600">{label}</label>
              <button onClick={(e) => { e.stopPropagation(); setFilterAssigned(prev => ({ ...prev, [filterKey]: !prev[filterKey] })); }} className={`text-xs px-2 py-0.5 rounded ${isFiltered ? 'bg-indigo-100 text-indigo-700' : 'bg-gray-100 text-gray-500 hover:bg-gray-200'}`}>
                {isFiltered ? 'Alle zeigen' : 'Nur zugewiesene'}
              </button>
            </div>
            <div ref={scrollRef} className="space-y-1 max-h-40 overflow-y-auto border rounded p-2">
              {filteredUsers.length === 0 ? (
                <div className="text-xs text-gray-400 italic">Keine Zuweisungen</div>
              ) : filteredUsers.map(user => {
                const isAssigned = isUserAssigned(assignments, user.id);
                const hours = getUserHours(assignments, user.id);
                return (
                  <div key={user.id} className="flex items-center gap-2 text-xs hover:bg-gray-50 p-1 rounded">
                    <input type="checkbox" checked={isAssigned} onClick={(e) => e.stopPropagation()} onChange={(e) => handleToggle(user.id, e.target.checked)} className="rounded flex-shrink-0" />
                    <span className="flex-1 truncate">{user.name}</span>
                    {isAssigned && (
                      <input 
                        type="number" 
                        min="0" 
                        step="0.5" 
                        key={`${user.id}-${hours}`}
                        defaultValue={hours || ''} 
                        placeholder="0" 
                        onClick={(e) => e.stopPropagation()} 
                        onBlur={(e) => handleHoursChange(user.id, e.target.value)}
                        onKeyDown={(e) => { if (e.key === 'Enter') e.target.blur(); }}
                        className="w-14 px-1 py-0.5 border rounded text-xs text-right" 
                      />
                    )}
                    {isAssigned && <span className="text-gray-400 text-xs">h</span>}
                  </div>
                );
              })}
            </div>
          </div>
        );
      };
      
      const DivisionAssignmentSection = ({ wpId }) => {
        const wp = workPackages.find(w => w.id === wpId);
        const scrollRef = React.useRef(null);
        const scrollKey = `${wpId}-divisions`;
        
        React.useLayoutEffect(() => {
          if (scrollRef.current && _scrollPositions[scrollKey]) {
            scrollRef.current.scrollTop = _scrollPositions[scrollKey];
          }
        });
        
        if (!wp) return null;
        const isFiltered = filterAssigned.divisions;
        const divisionIds = wp.divisionIds || [];
        const filteredDivisions = isFiltered ? sortedDivisions.filter(d => divisionIds.includes(d.id)) : sortedDivisions;
        
        const saveScroll = () => {
          if (scrollRef.current) _scrollPositions[scrollKey] = scrollRef.current.scrollTop;
        };
        
        const handleToggle = (divId, checked) => {
          saveScroll();
          const updated = checked ? [...divisionIds, divId] : divisionIds.filter(id => id !== divId);
          updateWorkPackage(wpId, 'divisionIds', updated);
        };
        
        return (
          <div>
            <div className="flex items-center justify-between mb-1">
              <label className="text-xs font-semibold text-gray-600">Abteilungen</label>
              <button onClick={(e) => { e.stopPropagation(); setFilterAssigned(prev => ({ ...prev, divisions: !prev.divisions })); }} className={`text-xs px-2 py-0.5 rounded ${isFiltered ? 'bg-indigo-100 text-indigo-700' : 'bg-gray-100 text-gray-500 hover:bg-gray-200'}`}>
                {isFiltered ? 'Alle zeigen' : 'Nur zugewiesene'}
              </button>
            </div>
            <div ref={scrollRef} className="space-y-1 max-h-32 overflow-y-auto border rounded p-2">
              {filteredDivisions.length === 0 ? (
                <div className="text-xs text-gray-400 italic">Keine Zuweisungen</div>
              ) : filteredDivisions.map(div => (
                <label key={div.id} className="flex items-center gap-2 text-xs cursor-pointer hover:bg-gray-50 p-1 rounded">
                  <input type="checkbox" checked={divisionIds.includes(div.id)} onClick={(e) => e.stopPropagation()} onChange={(e) => handleToggle(div.id, e.target.checked)} className="rounded" />
                  <span>{div.name}</span>
                </label>
              ))}
            </div>
          </div>
        );
      };
      
      const HEADER_HEIGHT = 76; // Monat + KW + Datum + Wochentag
      
      // Baselines f√ºr aktuelles Projekt
      const currentProjectBaselines = selectedProjectId 
        ? (baselines || []).filter(b => b.projectId === selectedProjectId)
        : [];
      
      return (
        <div className="h-screen bg-gray-50 flex flex-col">
          <div className="bg-white shadow px-4 py-3 flex items-center justify-between flex-shrink-0">
            <div className="flex items-center gap-3">
              <Calendar className="w-6 h-6 text-indigo-600" />
              <h1 className="text-xl font-bold">Projektplanung</h1>
              {selectedFolderId && !selectedProjectId && (
                <React.Fragment>
                  <ChevronRight className="w-4 h-4 text-gray-400" />
                  <span className="text-yellow-500">üìÅ</span>
                  <span className="text-lg font-semibold text-indigo-600">{(projectFolders || []).find(f => f.id === selectedFolderId)?.name}</span>
                  <span className="text-sm text-gray-400 ml-1">({filteredProjects.length} Projekte)</span>
                </React.Fragment>
              )}
              {selectedProjectId && (
                <React.Fragment>
                  <ChevronRight className="w-4 h-4 text-gray-400" />
                  <span className="text-lg font-semibold text-indigo-600">{(projects || []).find(p => p.id === selectedProjectId)?.name}</span>
                </React.Fragment>
              )}
              {!selectedProjectId && !selectedFolderId && <span className="text-sm text-gray-400 ml-2">({(projects || []).length} Projekte)</span>}
            </div>
            <button onClick={() => setShowProjectPlanning(false)} className="p-2 hover:bg-gray-100 rounded-lg"><X className="w-5 h-5" /></button>
          </div>
          
          <div className="bg-white border-b px-2 py-1 flex items-center gap-4 flex-shrink-0">
            {/* Anzeige Dropdown - enth√§lt alles */}
            <div className="relative">
              <button 
                onClick={() => setViewMenuOpen(!viewMenuOpen)}
                className="text-xs px-3 py-1.5 rounded bg-gray-100 text-gray-700 hover:bg-gray-200 flex items-center gap-1.5 font-medium"
              >
                <span>‚öôÔ∏è Anzeige</span>
                <ChevronDown className="w-3 h-3" />
              </button>
              {viewMenuOpen && (
                <div className="absolute left-0 top-full mt-1 bg-white rounded-lg shadow-xl border py-2 min-w-56 z-50" onClick={(e) => e.stopPropagation()}>
                  {/* Anzeige-Optionen */}
                  <div className="px-3 pb-1 text-xs font-semibold text-gray-400 uppercase">Anzeige</div>
                  <label className="flex items-center gap-2 px-3 py-1.5 hover:bg-gray-50 cursor-pointer text-sm">
                    <input type="checkbox" checked={showAssignments} onChange={(e) => setShowAssignments(e.target.checked)} className="rounded" />
                    <Users className="w-3.5 h-3.5 text-indigo-500" />
                    <span>Zuweisungen</span>
                  </label>
                  <label className="flex items-center gap-2 px-3 py-1.5 hover:bg-gray-50 cursor-pointer text-sm">
                    <input type="checkbox" checked={showHours} onChange={(e) => setShowHours(e.target.checked)} className="rounded" />
                    <span>‚è±Ô∏è</span>
                    <span>Stunden</span>
                  </label>
                  
                  {/* Spalten */}
                  <div className="border-t my-2" />
                  <div className="px-3 pb-1 text-xs font-semibold text-gray-400 uppercase">Spalten</div>
                  {[
                    { key: 'start', label: 'Start' },
                    { key: 'end', label: 'Ende' },
                    { key: 'hours', label: 'Plan h' },
                    { key: 'days', label: 'KT' }
                  ].map(col => (
                    <label key={col.key} className="flex items-center gap-2 px-3 py-1.5 hover:bg-gray-50 cursor-pointer text-sm">
                      <input type="checkbox" checked={ganttVisibleColumns[col.key]} onChange={(e) => setGanttVisibleColumns(prev => ({ ...prev, [col.key]: e.target.checked }))} className="rounded" />
                      <span>{col.label}</span>
                    </label>
                  ))}
                  
                  {/* Baselines - nur wenn Projekt ausgew√§hlt */}
                  {selectedProjectId && (
                    <React.Fragment>
                      <div className="border-t my-2" />
                      <div className="px-3 pb-1 text-xs font-semibold text-gray-400 uppercase">Baselines</div>
                      <button 
                        onClick={() => { createBaseline(); }} 
                        className="w-full px-3 py-1.5 text-left text-sm hover:bg-violet-50 flex items-center gap-2"
                      >
                        <Plus className="w-3.5 h-3.5 text-violet-600" />
                        <span>Neue Baseline erstellen</span>
                      </button>
                      {currentProjectBaselines.map(baseline => (
                        <div key={baseline.id} className="px-3 py-1.5 hover:bg-gray-50 flex items-center justify-between">
                          <div className="flex items-center gap-2 flex-1 min-w-0">
                            <button 
                              onClick={() => loadBaseline(baseline.id)}
                              className={`text-xs ${activeBaseline?.id === baseline.id ? 'text-violet-600' : 'text-gray-400'}`}
                            >
                              {activeBaseline?.id === baseline.id ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è'}
                            </button>
                            <span className="text-sm truncate">{baseline.name}</span>
                          </div>
                          <button onClick={() => deleteBaseline(baseline.id)} className="text-red-400 hover:text-red-600 text-xs ml-2">üóëÔ∏è</button>
                        </div>
                      ))}
                      {currentProjectBaselines.length === 0 && (
                        <div className="px-3 py-1.5 text-xs text-gray-400 italic">Keine Baselines</div>
                      )}
                    </React.Fragment>
                  )}
                </div>
              )}
            </div>
            
            {/* Zoom - separat */}
            <div className="flex items-center gap-2 ml-2">
              <span className="text-xs text-gray-500">Zoom:</span>
              <button onClick={() => setZoomLevel(Math.max(25, zoomLevel - 25))} className="w-6 h-6 rounded bg-gray-100 hover:bg-gray-200 text-gray-600 text-sm">-</button>
              <span className="text-xs w-10 text-center">{zoomLevel * 2}%</span>
              <button onClick={() => setZoomLevel(Math.min(100, zoomLevel + 25))} className="w-6 h-6 rounded bg-gray-100 hover:bg-gray-200 text-gray-600 text-sm">+</button>
            </div>
            
            {/* Abstand halten */}
            <label className="flex items-center gap-1.5 ml-3 cursor-pointer text-xs">
              <input type="checkbox" checked={resizeMode === 'rigid'} onChange={(e) => setResizeMode(e.target.checked ? 'rigid' : 'magnetic')} className="rounded w-3 h-3" />
              <span className="text-gray-600">üîó Abstand</span>
            </label>
            
            {/* Aktive Baseline Anzeige */}
            {activeBaseline && selectedProjectId && (
              <span className="text-xs text-violet-600 bg-violet-50 px-2 py-0.5 rounded ml-auto">
                üìå {activeBaseline.name}
              </span>
            )}
          </div>

          
          <div className="flex-1 flex overflow-hidden relative">
            {/* Projekt-Sidebar mit Ordner-Struktur */}
            <div className={`${projectSidebarCollapsed ? 'w-10' : 'w-56'} bg-slate-800 text-white flex flex-col flex-shrink-0 transition-all duration-200 border-r-2 border-slate-600`}>
              <div className="p-2 border-b border-slate-700 flex items-center justify-between bg-slate-900">
                {!projectSidebarCollapsed && <span className="text-xs font-semibold text-slate-400 uppercase tracking-wide">Projekte</span>}
                <button 
                  onClick={() => setProjectSidebarCollapsed(!projectSidebarCollapsed)} 
                  className="p-1 hover:bg-slate-700 rounded text-slate-400 hover:text-white transition-colors"
                >
                  {projectSidebarCollapsed ? <ChevronRight className="w-4 h-4" /> : <ChevronLeft className="w-4 h-4" />}
                </button>
              </div>
              {!projectSidebarCollapsed && (
                <div className="flex-1 overflow-y-auto">
                  {/* Alle Projekte Button */}
                  <button 
                    onClick={() => { setSelectedProjectId(null); setSelectedFolderId(null); setActiveBaseline(null); }}
                    className={`w-full px-3 py-2 text-left text-sm flex items-center gap-2 ${selectedProjectId === null && selectedFolderId === null ? 'bg-indigo-600' : 'hover:bg-slate-700'}`}
                  >
                    <span className="w-3 h-3 rounded bg-gradient-to-br from-indigo-400 to-purple-500" />
                    <span className="truncate">Alle Projekte</span>
                    <span className="text-xs text-slate-400 ml-auto">{(projects || []).length}</span>
                  </button>
                  
                  {/* Ordner mit Projekten - sortiert nach order */}
                  {(projectFolders || []).sort((a, b) => (a.order || 0) - (b.order || 0)).map((folder, folderIdx) => {
                    const folderProjects = (projects || []).filter(p => p.folderId === folder.id && !p.archived);
                    const isCollapsed = collapsedFolders[folder.id];
                    const isDragOver = dragOverFolder === folder.id;
                    const isFolderSelected = selectedFolderId === folder.id && selectedProjectId === null;
                    const isFolderDragOver = draggingFolder && draggingFolder !== folder.id && dragOverFolder === folder.id;
                    
                    return (
                      <div key={folder.id}>
                        {/* Ordner-Header */}
                        <div 
                          draggable
                          onDragStart={(e) => { e.stopPropagation(); setDraggingFolder(folder.id); }}
                          onDragEnd={() => { setDraggingFolder(null); setDragOverFolder(null); }}
                          className={`w-full px-2 py-1.5 text-left text-sm flex items-center gap-1 cursor-pointer ${isFolderSelected ? 'bg-indigo-600' : isFolderDragOver ? 'bg-slate-600 border-t-2 border-indigo-400' : isDragOver && draggingProject ? 'bg-indigo-500' : 'hover:bg-slate-700'} ${draggingFolder === folder.id ? 'opacity-50' : ''}`}
                          onClick={() => { setSelectedFolderId(folder.id); setSelectedProjectId(null); setActiveBaseline(null); setCollapsedFolders(prev => ({ ...prev, [folder.id]: false })); }}
                          onDragOver={(e) => { e.preventDefault(); setDragOverFolder(folder.id); }}
                          onDragLeave={() => setDragOverFolder(null)}
                          onDrop={(e) => {
                            e.preventDefault();
                            setDragOverFolder(null);
                            // Ordner sortieren
                            if (draggingFolder && draggingFolder !== folder.id) {
                              const sorted = (projectFolders || []).sort((a, b) => (a.order || 0) - (b.order || 0));
                              const targetIdx = sorted.findIndex(f => f.id === folder.id);
                              const withoutDragged = sorted.filter(f => f.id !== draggingFolder);
                              const draggedF = sorted.find(f => f.id === draggingFolder);
                              if (draggedF) {
                                withoutDragged.splice(targetIdx, 0, draggedF);
                                const updated = withoutDragged.map((f, i) => ({ ...f, order: i }));
                                saveProjectFolders(updated);
                              }
                              setDraggingFolder(null);
                            }
                            // Projekt in Ordner verschieben
                            if (draggingProject) {
                              const updated = (projects || []).map(p => p.id === draggingProject ? { ...p, folderId: folder.id } : p);
                              saveProjects(updated);
                              setDraggingProject(null);
                            }
                          }}
                        >
                          <button className="p-0.5 hover:bg-slate-600 rounded" onClick={(e) => { e.stopPropagation(); setCollapsedFolders(prev => ({ ...prev, [folder.id]: !prev[folder.id] })); }}>
                            {isCollapsed ? <ChevronRight className="w-3 h-3" /> : <ChevronDown className="w-3 h-3" />}
                          </button>
                          <span className="text-yellow-400">üìÅ</span>
                          {editingFolderId === folder.id ? (
                            <input
                              autoFocus
                              type="text"
                              defaultValue={folder.name}
                              className="flex-1 bg-slate-700 text-white text-sm px-1 rounded border-0 outline-none"
                              onClick={(e) => e.stopPropagation()}
                              onBlur={(e) => {
                                const updated = (projectFolders || []).map(f => f.id === folder.id ? { ...f, name: e.target.value } : f);
                                saveProjectFolders(updated);
                                setEditingFolderId(null);
                              }}
                              onKeyDown={(e) => { if (e.key === 'Enter') e.target.blur(); if (e.key === 'Escape') setEditingFolderId(null); }}
                            />
                          ) : (
                            <span 
                              className="truncate flex-1" 
                              onDoubleClick={(e) => { e.stopPropagation(); setEditingFolderId(folder.id); }}
                            >
                              {folder.name}
                            </span>
                          )}
                          <span className="text-xs text-slate-400">{folderProjects.length}</span>
                          <button 
                            className="p-0.5 hover:bg-red-600 rounded opacity-50 hover:opacity-100"
                            onClick={(e) => { 
                              e.stopPropagation(); 
                              if (confirm('Ordner l√∂schen? Projekte werden nicht gel√∂scht.')) {
                                // Projekte aus Ordner entfernen
                                const updatedProjects = (projects || []).map(p => p.folderId === folder.id ? { ...p, folderId: null } : p);
                                saveProjects(updatedProjects);
                                // Ordner l√∂schen
                                const updatedFolders = (projectFolders || []).filter(f => f.id !== folder.id);
                                saveProjectFolders(updatedFolders);
                                // Falls dieser Ordner ausgew√§hlt war, zur√ºcksetzen
                                if (selectedFolderId === folder.id) setSelectedFolderId(null);
                              }
                            }}
                            title="Ordner l√∂schen"
                          >
                            <Trash2 className="w-3 h-3" />
                          </button>
                        </div>
                        
                        {/* Projekte im Ordner - sortiert nach order */}
                        {!isCollapsed && folderProjects.sort((a, b) => (a.order || 0) - (b.order || 0)).map((project, idx) => {
                          const projectBaselines = (baselines || []).filter(b => b.projectId === project.id);
                          const isDragOver = dragOverProject === project.id;
                          return (
                            <div
                              key={project.id}
                              draggable
                              onDragStart={(e) => { e.stopPropagation(); setDraggingProject(project.id); }}
                              onDragEnd={() => { setDraggingProject(null); setDragOverFolder(null); setDragOverProject(null); }}
                              onDragOver={(e) => { e.preventDefault(); e.stopPropagation(); if (draggingProject && draggingProject !== project.id) setDragOverProject(project.id); }}
                              onDragLeave={() => setDragOverProject(null)}
                              onDrop={(e) => {
                                e.preventDefault();
                                e.stopPropagation();
                                if (draggingProject && draggingProject !== project.id) {
                                  // Projekt in diesen Ordner verschieben und vor diesem Projekt einsortieren
                                  const draggedProj = (projects || []).find(p => p.id === draggingProject);
                                  if (draggedProj) {
                                    let updated = (projects || []).map(p => p.id === draggingProject ? { ...p, folderId: folder.id } : p);
                                    // Neu sortieren innerhalb des Ordners
                                    const inFolder = updated.filter(p => p.folderId === folder.id).sort((a, b) => (a.order || 0) - (b.order || 0));
                                    const targetIdx = inFolder.findIndex(p => p.id === project.id);
                                    const withoutDragged = inFolder.filter(p => p.id !== draggingProject);
                                    withoutDragged.splice(targetIdx, 0, { ...draggedProj, folderId: folder.id });
                                    withoutDragged.forEach((p, i) => { updated = updated.map(pr => pr.id === p.id ? { ...pr, order: i } : pr); });
                                    saveProjects(updated);
                                  }
                                }
                                setDraggingProject(null);
                                setDragOverProject(null);
                              }}
                              onClick={() => { setSelectedProjectId(project.id); setSelectedFolderId(null); setActiveBaseline(null); }}
                              onContextMenu={(e) => { e.preventDefault(); e.stopPropagation(); setContextMenu({ x: e.clientX, y: e.clientY, type: 'sidebar-project', project }); }}
                              className={`w-full pl-8 pr-3 py-1.5 text-left text-sm flex items-center gap-2 cursor-pointer ${selectedProjectId === project.id ? 'bg-indigo-600' : isDragOver ? 'bg-indigo-500 border-t-2 border-indigo-300' : 'hover:bg-slate-700'} ${draggingProject === project.id ? 'opacity-50' : ''}`}
                            >
                              <span className="w-2.5 h-2.5 rounded flex-shrink-0" style={{ backgroundColor: project.color }} />
                              {editingProjectId === project.id ? (
                                <input autoFocus type="text" defaultValue={project.name} className="flex-1 min-w-0 px-1 py-0 rounded text-xs text-gray-800 bg-white" onClick={(e) => e.stopPropagation()} onBlur={(e) => { saveProjects((projects || []).map(p => p.id === project.id ? { ...p, name: e.target.value } : p)); setEditingProjectId(null); }} onKeyDown={(e) => { if (e.key === 'Enter') e.target.blur(); if (e.key === 'Escape') setEditingProjectId(null); }} />
                              ) : (
                                <span className="truncate flex-1" onDoubleClick={(e) => { e.stopPropagation(); setEditingProjectId(project.id); }}>{project.name}</span>
                              )}
                              <span className="text-xs text-slate-400">{(workPackages || []).filter(wp => wp.projectId === project.id).length}</span>
                              {projectBaselines.length > 0 && <span className="text-xs">üìå</span>}
                            </div>
                          );
                        })}
                      </div>
                    );
                  })}
                  
                  {/* Ungrupierte Projekte (ohne Ordner) */}
                  {(() => {
                    const ungroupedProjects = (projects || []).filter(p => !p.folderId && !p.archived);
                    if (ungroupedProjects.length === 0 && (projectFolders || []).length > 0) return null;
                    
                    return (
                      <div 
                        className={`${(projectFolders || []).length > 0 ? 'border-t border-slate-700 mt-1 pt-1' : ''}`}
                        onDragOver={(e) => { e.preventDefault(); setDragOverFolder('ungrouped'); }}
                        onDragLeave={() => setDragOverFolder(null)}
                        onDrop={(e) => {
                          e.preventDefault();
                          setDragOverFolder(null);
                          if (draggingProject) {
                            const updated = (projects || []).map(p => p.id === draggingProject ? { ...p, folderId: null } : p);
                            saveProjects(updated);
                            setDraggingProject(null);
                          }
                        }}
                      >
                        {(projectFolders || []).length > 0 && (
                          <div className={`px-3 py-1 text-xs text-slate-500 ${dragOverFolder === 'ungrouped' ? 'bg-indigo-500 text-white' : ''}`}>
                            Ungrupiert
                          </div>
                        )}
                        {ungroupedProjects.sort((a, b) => (a.order || 0) - (b.order || 0)).map((project, idx) => {
                          const projectBaselines = (baselines || []).filter(b => b.projectId === project.id);
                          const isDragOver = dragOverProject === project.id;
                          return (
                            <div
                              key={project.id}
                              draggable
                              onDragStart={(e) => { e.stopPropagation(); setDraggingProject(project.id); }}
                              onDragEnd={() => { setDraggingProject(null); setDragOverFolder(null); setDragOverProject(null); }}
                              onDragOver={(e) => { e.preventDefault(); e.stopPropagation(); if (draggingProject && draggingProject !== project.id) setDragOverProject(project.id); }}
                              onDragLeave={() => setDragOverProject(null)}
                              onDrop={(e) => {
                                e.preventDefault();
                                e.stopPropagation();
                                if (draggingProject && draggingProject !== project.id) {
                                  // Projekt hierhin verschieben (ungrupiert) und vor diesem Projekt einsortieren
                                  const draggedProj = (projects || []).find(p => p.id === draggingProject);
                                  if (draggedProj) {
                                    let updated = (projects || []).map(p => p.id === draggingProject ? { ...p, folderId: null } : p);
                                    // Neu sortieren innerhalb ungrupiert
                                    const inUngrouped = updated.filter(p => !p.folderId).sort((a, b) => (a.order || 0) - (b.order || 0));
                                    const targetIdx = inUngrouped.findIndex(p => p.id === project.id);
                                    const withoutDragged = inUngrouped.filter(p => p.id !== draggingProject);
                                    withoutDragged.splice(targetIdx, 0, { ...draggedProj, folderId: null });
                                    withoutDragged.forEach((p, i) => { updated = updated.map(pr => pr.id === p.id ? { ...pr, order: i } : pr); });
                                    saveProjects(updated);
                                  }
                                }
                                setDraggingProject(null);
                                setDragOverProject(null);
                              }}
                              onClick={() => { setSelectedProjectId(project.id); setSelectedFolderId(null); setActiveBaseline(null); }}
                              onContextMenu={(e) => { e.preventDefault(); e.stopPropagation(); setContextMenu({ x: e.clientX, y: e.clientY, type: 'sidebar-project', project }); }}
                              className={`w-full px-3 py-1.5 text-left text-sm flex items-center gap-2 cursor-pointer ${selectedProjectId === project.id ? 'bg-indigo-600' : isDragOver ? 'bg-indigo-500 border-t-2 border-indigo-300' : 'hover:bg-slate-700'} ${draggingProject === project.id ? 'opacity-50' : ''}`}
                            >
                              <span className="w-3 h-3 rounded flex-shrink-0" style={{ backgroundColor: project.color }} />
                              {editingProjectId === project.id ? (
                                <input autoFocus type="text" defaultValue={project.name} className="flex-1 min-w-0 px-1 py-0 rounded text-xs text-gray-800 bg-white" onClick={(e) => e.stopPropagation()} onBlur={(e) => { saveProjects((projects || []).map(p => p.id === project.id ? { ...p, name: e.target.value } : p)); setEditingProjectId(null); }} onKeyDown={(e) => { if (e.key === 'Enter') e.target.blur(); if (e.key === 'Escape') setEditingProjectId(null); }} />
                              ) : (
                                <span className="truncate flex-1" onDoubleClick={(e) => { e.stopPropagation(); setEditingProjectId(project.id); }}>{project.name}</span>
                              )}
                              <span className="text-xs text-slate-400">{(workPackages || []).filter(wp => wp.projectId === project.id).length}</span>
                              {projectBaselines.length > 0 && <span className="text-xs">üìå</span>}
                            </div>
                          );
                        })}
                      </div>
                    );
                  })()}
                </div>
              )}
              {/* Archiv */}
              {!projectSidebarCollapsed && (() => {
                const archivedProjects = (projects || []).filter(p => p.archived);
                if (archivedProjects.length === 0) return null;
                return (
                  <div className="border-t border-slate-700">
                    <div 
                      className="px-3 py-1.5 flex items-center gap-2 cursor-pointer hover:bg-slate-700 text-slate-400 text-xs"
                      onClick={() => setShowArchive(!showArchive)}
                    >
                      <span>{showArchive ? '‚ñº' : '‚ñ∂'}</span>
                      <span>üì¶ Archiv</span>
                      <span className="ml-auto text-slate-500">{archivedProjects.length}</span>
                    </div>
                    {showArchive && archivedProjects.map(project => (
                      <div 
                        key={project.id}
                        className="w-full px-3 pl-6 py-1 text-left text-xs flex items-center gap-2 text-slate-500 hover:bg-slate-700 group"
                        onContextMenu={(e) => { e.preventDefault(); e.stopPropagation(); setContextMenu({ x: e.clientX, y: e.clientY, type: 'archived-project', project }); }}
                      >
                        <span className="w-2 h-2 rounded flex-shrink-0 opacity-50" style={{ backgroundColor: project.color }} />
                        <span className="truncate flex-1">{project.name}</span>
                        <button 
                          onClick={(e) => { e.stopPropagation(); saveProjects((projects || []).map(p => p.id === project.id ? { ...p, archived: false } : p)); }}
                          className="text-[10px] px-1.5 py-0.5 rounded bg-slate-700 hover:bg-indigo-600 text-slate-300 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"
                          title="Wiederherstellen"
                        >‚Ü©</button>
                      </div>
                    ))}
                  </div>
                );
              })()}
              {!projectSidebarCollapsed && (
                <div className="p-2 border-t border-slate-700 space-y-1">
                  {/* Neuer Ordner Button */}
                  <button 
                    onClick={() => { 
                      const newFolder = { 
                        id: `folder_${Date.now()}`, 
                        name: `Neuer Ordner`, 
                        order: (projectFolders || []).length 
                      };
                      const newFolders = [...(projectFolders || []), newFolder];
                      saveProjectFolders(newFolders);
                      setEditingFolderId(newFolder.id);
                    }}
                    className="w-full px-3 py-1.5 text-left text-sm flex items-center gap-2 hover:bg-slate-700 rounded text-slate-300"
                  >
                    <span className="text-yellow-400">üìÅ</span>
                    <Plus className="w-3 h-3" />
                    <span>Neuer Ordner</span>
                  </button>
                  {/* Neues Projekt Button */}
                  <button 
                    onClick={() => { 
                      const colors = ['#6366f1', '#8b5cf6', '#ec4899', '#f43f5e', '#f97316', '#eab308', '#22c55e', '#14b8a6', '#0ea5e9'];
                      const newColor = colors[(projects || []).length % colors.length];
                      const newProject = { id: `proj_${Date.now()}`, name: `Neues Projekt ${(projects || []).length + 1}`, color: newColor, folderId: null };
                      const newProjects = [...(projects || []), newProject];
                      setProjects(newProjects);
                      saveProjects(newProjects);
                      setSelectedProjectId(newProject.id);
                    }}
                    className="w-full px-3 py-1.5 text-left text-sm flex items-center gap-2 hover:bg-slate-700 rounded text-slate-300"
                  >
                    <Plus className="w-4 h-4" />
                    <span>Neues Projekt</span>
                  </button>
                </div>
              )}
            </div>
            
            {/* Hauptinhalt */}
            <div className="flex-1 flex flex-col overflow-hidden relative">
            {/* Detail-Sidebar - f√ºr Einzel- und Multi-Select - schwebt √ºber Gantt */}
            {(sidebarWP || selectedWPs.length > 0) && (
              <div 
                className={`absolute top-0 bottom-0 bg-white/80 backdrop-blur-sm border-r shadow-2xl flex flex-col z-40 transition-all duration-200 ${detailsCollapsed ? 'w-8' : 'w-72'}`}
                style={{ left: Math.max(leftPanelWidth, 40) }}
                onClick={(e) => e.stopPropagation()}
              >
                {detailsCollapsed ? (
                  /* Eingeklappter Zustand - nur schmaler Streifen */
                  <div className="flex-1 flex flex-col items-center py-2" style={{ backgroundColor: sidebarWP?.color ? `${sidebarWP.color}e6` : 'rgba(99,102,241,0.9)' }}>
                    <button 
                      onClick={() => setDetailsCollapsed(false)}
                      className="p-1.5 text-white hover:bg-white/20 rounded"
                      title="Details einblenden"
                    >
                      <ChevronRight className="w-4 h-4" />
                    </button>
                    <div className="flex-1 flex items-center justify-center">
                      <span className="text-white text-xs font-bold writing-mode-vertical" style={{ writingMode: 'vertical-rl', textOrientation: 'mixed' }}>
                        {selectedWPs.length > 0 ? `${selectedWPs.length} ausgew√§hlt` : 'Details'}
                      </span>
                    </div>
                  </div>
                ) : (
                  /* Ausgeklappter Zustand */
                  <React.Fragment>
                    {/* Header */}
                    <div className={`p-2 border-b flex items-center justify-between ${selectedWPs.length > 0 ? 'bg-indigo-600 text-white' : 'text-white'}`} style={selectedWPs.length === 0 ? { backgroundColor: sidebarWP?.color || '#6366f1' } : undefined}>
                      <div className="flex items-center gap-2 min-w-0 flex-1">
                        {selectedWPs.length > 0 ? (
                          <React.Fragment>
                            <span className="bg-white text-indigo-600 text-xs font-bold px-1.5 py-0.5 rounded-full">{selectedWPs.length}</span>
                            <span className="text-sm font-medium">ausgew√§hlt</span>
                          </React.Fragment>
                        ) : (
                          <h3 className="font-bold text-sm truncate">{sidebarWP?.name}</h3>
                        )}
                      </div>
                      <div className="flex items-center gap-0.5 flex-shrink-0">
                        {/* Einr√ºcken/Ausr√ºcken Buttons */}
                        {selectedWPs.length > 0 && (
                          <React.Fragment>
                            <button onClick={(e) => { e.stopPropagation(); bulkOutdent(); }} className="p-1 hover:bg-white/20 rounded" title="Ausr√ºcken"><ChevronLeft className="w-4 h-4" /></button>
                            <button onClick={(e) => { e.stopPropagation(); bulkIndent(); }} className="p-1 hover:bg-white/20 rounded" title="Einr√ºcken"><ChevronRight className="w-4 h-4" /></button>
                          </React.Fragment>
                        )}
                        {sidebarWP && selectedWPs.length === 0 && (
                          <React.Fragment>
                            <button onClick={(e) => { e.stopPropagation(); outdentWorkPackage(sidebarWP.id); }} className="p-1 hover:bg-white/20 rounded text-white" title="Ausr√ºcken"><ChevronLeft className="w-4 h-4" /></button>
                            <button onClick={(e) => { e.stopPropagation(); indentWorkPackage(sidebarWP.id); }} className="p-1 hover:bg-white/20 rounded text-white" title="Einr√ºcken"><ChevronRight className="w-4 h-4" /></button>
                          </React.Fragment>
                        )}
                        <div className="w-px h-4 mx-0.5 bg-white/30" />
                        <button onClick={() => setDetailsCollapsed(true)} className="p-1 rounded hover:bg-white/20" title="Einklappen"><ChevronLeft className="w-4 h-4" /></button>
                        <button onClick={(e) => { e.stopPropagation(); setSelectedWPs([]); setSidebarWPId(null); }} className="p-1 rounded hover:bg-white/20" title="Schlie√üen"><X className="w-4 h-4" /></button>
                      </div>
                    </div>
                    
                    {/* Farben - kompakt */}
                    <div className="px-2 py-1.5 border-b bg-gray-50/80 flex items-center gap-1">
                      {wpColors.map(color => (
                        <button 
                          key={color}
                          onClick={() => selectedWPs.length > 0 ? bulkSetColor(color) : updateWorkPackage(sidebarWP.id, 'color', color)}
                          className="w-4 h-4 rounded border border-transparent hover:border-gray-400 hover:scale-125 transition-all"
                          style={{ backgroundColor: color }}
                        />
                      ))}
                      <button 
                        onClick={() => selectedWPs.length > 0 ? bulkSetColor(null) : updateWorkPackage(sidebarWP.id, 'color', null)}
                        className="w-4 h-4 rounded border border-gray-300 hover:border-gray-400 flex items-center justify-center text-gray-400"
                        style={{ fontSize: 8 }}
                      >
                        ‚úï
                      </button>
                    </div>
                    
                    {/* Multi-Select: Nur L√∂schen-Button */}
                    {selectedWPs.length > 0 && (
                      <div className="p-2">
                        <button 
                          onClick={bulkDelete}
                          className="w-full flex items-center justify-center gap-2 px-2 py-1.5 bg-red-50 hover:bg-red-100 text-red-600 rounded text-xs font-medium transition-colors"
                        >
                          <Trash2 className="w-3 h-3" />
                          L√∂schen
                        </button>
                      </div>
                    )}
                {/* Einzel-Auswahl: Alle Details */}
                {sidebarWP && selectedWPs.length === 0 && (
                <div className="flex-1 overflow-y-auto p-2 space-y-3">
                  <div className="grid grid-cols-2 gap-3">
                    <div>
                      <label className="text-xs font-semibold text-gray-600 block mb-1">Planstunden</label>
                      {getChildren(sidebarWP.id, workPackages).length > 0 ? (
                        <div className="text-sm text-gray-500 italic">{calculateTotalHours(sidebarWP.id)}h</div>
                      ) : (
                        <div className="flex items-center gap-1">
                          <input 
                            type="number" 
                            min="0" 
                            step="0.5" 
                            key={`plan-${sidebarWP.id}-${sidebarWP.plannedHours}`}
                            defaultValue={sidebarWP.plannedHours || 0} 
                            onClick={(e) => e.stopPropagation()} 
                            onBlur={(e) => updateWorkPackage(sidebarWP.id, 'plannedHours', parseFloat(e.target.value) || 0)}
                            onKeyDown={(e) => { if (e.key === 'Enter') e.target.blur(); }}
                            className="w-16 px-2 py-1 border rounded text-sm" 
                          />
                          <span className="text-xs text-gray-500">h</span>
                        </div>
                      )}
                    </div>
                    <div>
                      <label className="text-xs font-semibold text-gray-600 block mb-1">Zugewiesen</label>
                      <div className="text-sm font-medium" style={{ color: calculateAssignedHours(sidebarWP) > (sidebarWP.plannedHours || 0) ? '#ef4444' : calculateAssignedHours(sidebarWP) === (sidebarWP.plannedHours || 0) ? '#22c55e' : '#6b7280' }}>
                        {calculateAssignedHours(sidebarWP)}h
                        {sidebarWP.plannedHours > 0 && (
                          <span className="text-xs text-gray-400 ml-1">
                            ({(sidebarWP.plannedHours || 0) - calculateAssignedHours(sidebarWP) >= 0 
                              ? `+${(sidebarWP.plannedHours || 0) - calculateAssignedHours(sidebarWP)}h offen`
                              : `${(sidebarWP.plannedHours || 0) - calculateAssignedHours(sidebarWP)}h √ºberplant`})
                          </span>
                        )}
                      </div>
                    </div>
                  </div>
                  <div>
                    <label className="text-xs font-semibold text-gray-600 block mb-1">Zeitraum</label>
                    {getChildren(sidebarWP.id, workPackages).length > 0 ? (
                      <div className="text-sm text-gray-500 italic">{(() => { const dates = calculateDatesFromChildren(sidebarWP.id, workPackages); return dates ? `${parseLocalDate(dates.startDate).toLocaleDateString('de-DE')} - ${parseLocalDate(dates.endDate).toLocaleDateString('de-DE')}` : '-'; })()}<span className="block text-xs">(aus Unterpaketen)</span></div>
                    ) : (
                      <div className="grid grid-cols-2 gap-2">
                        <div><label className="text-xs text-gray-500">Start</label><input type="date" value={sidebarWP.startDate || ''} onClick={(e) => e.stopPropagation()} onChange={(e) => updateWorkPackage(sidebarWP.id, 'startDate', e.target.value)} className="w-full px-2 py-1 border rounded text-xs" /></div>
                        <div><label className="text-xs text-gray-500">Ende</label><input type="date" value={sidebarWP.endDate || ''} onClick={(e) => e.stopPropagation()} onChange={(e) => updateWorkPackage(sidebarWP.id, 'endDate', e.target.value)} className="w-full px-2 py-1 border rounded text-xs" /></div>
                      </div>
                    )}
                  </div>
                  <div title="Wenn deaktiviert, werden Wochenenden und Feiertage bei Verschiebungen √ºbersprungen">
                    <label className="flex items-center gap-2 text-xs cursor-pointer">
                      <input 
                        type="checkbox" 
                        checked={sidebarWP.allowWeekend || false} 
                        onChange={(e) => updateWorkPackage(sidebarWP.id, 'allowWeekend', e.target.checked)}
                        className="rounded"
                      />
                      <span className="font-semibold text-gray-600">üóìÔ∏è Wochenend/Feiertagsarbeit</span>
                    </label>
                  </div>
                  <div title="Datum wird nicht durch Abh√§ngigkeiten verschoben">
                    <label className="flex items-center gap-2 text-xs cursor-pointer">
                      <input 
                        type="checkbox" 
                        checked={sidebarWP.locked || false} 
                        onChange={(e) => updateWorkPackage(sidebarWP.id, 'locked', e.target.checked)}
                        className="rounded"
                      />
                      <span className="font-semibold text-gray-600">üîí Termin fixiert</span>
                    </label>
                  </div>
                  <UserAssignmentSection wpId={sidebarWP.id} field="responsibles" label="Verantwortliche" filterKey="responsibles" />
                  <UserAssignmentSection wpId={sidebarWP.id} field="editors" label="Bearbeiter" filterKey="editors" />
                  <DivisionAssignmentSection wpId={sidebarWP.id} />
                  <div>
                    <label className="text-xs font-semibold text-gray-600 block mb-1">Abh√§ngigkeiten</label>
                    <div className="space-y-1">
                      {dependencies.filter(d => d.fromId === sidebarWP.id || d.toId === sidebarWP.id).map(dep => {
                        const isFrom = dep.fromId === sidebarWP.id;
                        const otherWP = workPackages.find(w => w.id === (isFrom ? dep.toId : dep.fromId));
                        const depType = dep.type || 'FS';
                        return otherWP ? (
                          <div key={dep.id} className="flex items-center justify-between text-xs bg-gray-50 p-2 rounded hover:bg-purple-50 group transition-colors"
                            onMouseEnter={() => setHoveredDep(dep.id)}
                            onMouseLeave={() => setHoveredDep(null)}
                            style={hoveredDep === dep.id ? { backgroundColor: '#fae8ff', outline: '2px solid #d946ef', outlineOffset: -1 } : undefined}
                          >
                            <div className="flex items-center gap-1.5 min-w-0 flex-1">
                              <span className={`px-1 py-0.5 rounded text-white font-bold ${isFrom ? 'bg-blue-500' : 'bg-orange-500'}`} style={{ fontSize: 9 }}>{isFrom ? 'NACH' : 'VON'}</span>
                              <span className="truncate" title={otherWP.name}>{otherWP.name}</span>
                              <span className="text-gray-400 flex-shrink-0">({depType})</span>
                            </div>
                            <button onClick={(e) => { e.stopPropagation(); deleteDependency(dep.id); }} className="text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-opacity p-0.5" title="Abh√§ngigkeit l√∂schen"><X className="w-3.5 h-3.5" /></button>
                          </div>
                        ) : null;
                      })}
                      {dependencies.filter(d => d.fromId === sidebarWP.id || d.toId === sidebarWP.id).length === 0 && <div className="text-xs text-gray-400 italic">Keine Abh√§ngigkeiten</div>}
                    </div>
                  </div>
                </div>
                )}
                </React.Fragment>
                )}
              </div>
            )}
            
            {/* Header mit Monat, KW, Datum, Wochentag */}
            <div className="flex flex-shrink-0 bg-white border-b z-10">
                {/* Liste-Header - eingeklappt oder ausgeklappt */}
                {leftPanelWidth <= 40 ? (
                  /* Eingeklappter Zustand - nur schmaler Streifen */
                  <div className="w-10 bg-gray-200 flex items-center justify-center flex-shrink-0 border-r" style={{ height: HEADER_HEIGHT }}>
                    <button 
                      onClick={() => setLeftPanelWidth(384)}
                      className="p-1 hover:bg-gray-300 rounded text-gray-600 hover:text-gray-800 transition-colors"
                      title="Liste einblenden"
                    >
                      <ChevronRight className="w-4 h-4" />
                    </button>
                  </div>
                ) : (
                  /* Ausgeklappter Zustand */
                  <div data-panel-list className="flex-shrink-0 bg-gray-100 relative" style={{ height: HEADER_HEIGHT, width: leftPanelWidth }}>
                    <div className="flex h-full items-end pb-2 text-xs font-semibold text-gray-600">
                      <div className="flex-1 px-2 border-r border-gray-300 flex items-center gap-1" style={{ minWidth: 100 }}>
                        <span>Arbeitspaket</span>
                        <div className="flex items-center gap-0.5 ml-auto">
                          <button onClick={collapseOneLevel} className="p-0.5 hover:bg-gray-300 rounded text-gray-500 hover:text-gray-700" title="Eine Ebene zuklappen"><ChevronLeft className="w-3.5 h-3.5" /></button>
                          {Array.from({ length: Math.min(getMaxLevel() + 2, 7) }, (_, i) => (
                            <button key={i} onClick={() => expandToLevel(i)} className={`w-4 h-4 rounded text-[9px] font-medium flex items-center justify-center ${getCurrentExpandLevel() === i ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-500 hover:bg-gray-300'}`} title={i === 0 ? 'Alles zuklappen' : `Ebene ${i}`}>{i}</button>
                          ))}
                          <button onClick={expandOneLevel} className="p-0.5 hover:bg-gray-300 rounded text-gray-500 hover:text-gray-700" title="Eine Ebene aufklappen"><ChevronRight className="w-3.5 h-3.5" /></button>
                        </div>
                      </div>
                      {ganttVisibleColumns.start && (
                        <div className="relative text-center border-r border-gray-300 flex-shrink-0 select-none" style={{ width: columnWidths.start }}>
                          Start
                          <div className="absolute right-0 top-0 bottom-0 w-3 cursor-col-resize bg-transparent hover:bg-indigo-400 z-20" onMouseDown={(e) => { e.preventDefault(); e.stopPropagation(); setResizingColumn({ key: 'start', startX: e.clientX, startWidth: columnWidths.start }); }} />
                        </div>
                      )}
                      {ganttVisibleColumns.end && (
                        <div className="relative text-center border-r border-gray-300 flex-shrink-0 select-none" style={{ width: columnWidths.end }}>
                          Ende
                          <div className="absolute right-0 top-0 bottom-0 w-3 cursor-col-resize bg-transparent hover:bg-indigo-400 z-20" onMouseDown={(e) => { e.preventDefault(); e.stopPropagation(); setResizingColumn({ key: 'end', startX: e.clientX, startWidth: columnWidths.end }); }} />
                        </div>
                      )}
                      {ganttVisibleColumns.hours && (
                        <div className="relative text-center border-r border-gray-300 flex-shrink-0 select-none" style={{ width: columnWidths.hours }}>
                          Plan h
                          <div className="absolute right-0 top-0 bottom-0 w-3 cursor-col-resize bg-transparent hover:bg-indigo-400 z-20" onMouseDown={(e) => { e.preventDefault(); e.stopPropagation(); setResizingColumn({ key: 'hours', startX: e.clientX, startWidth: columnWidths.hours }); }} />
                        </div>
                      )}
                      {ganttVisibleColumns.days && (
                        <div className="relative text-center flex-shrink-0 select-none" style={{ width: columnWidths.days }}>
                          KT
                          <div className="absolute right-0 top-0 bottom-0 w-3 cursor-col-resize bg-transparent hover:bg-indigo-400 z-20" onMouseDown={(e) => { e.preventDefault(); e.stopPropagation(); setResizingColumn({ key: 'days', startX: e.clientX, startWidth: columnWidths.days }); }} />
                        </div>
                      )}
                    </div>
                    {/* Resize Handle + Einklapp-Button f√ºr die gesamte Liste - am rechten Rand */}
                    <div 
                      className="absolute right-0 top-0 bottom-0 w-1 cursor-col-resize bg-gray-300 hover:bg-indigo-500 hover:w-2 active:bg-indigo-600 z-50 transition-all"
                      onMouseDown={(e) => { 
                        e.preventDefault(); 
                        e.stopPropagation(); 
                        setIsResizingPanel(true); 
                      }}
                      title="Liste verbreitern/verkleinern"
                    />
                    {/* Einklapp-Button */}
                    <button
                      onClick={() => setLeftPanelWidth(0)}
                      className="absolute right-1 top-1 w-5 h-5 flex items-center justify-center bg-gray-200 hover:bg-indigo-500 hover:text-white rounded text-gray-500 z-50 transition-colors"
                      title="Liste ausblenden"
                    >
                      <ChevronLeft className="w-3 h-3" />
                    </button>
                  </div>
                )}
                <div 
                  ref={headerScrollRef}
                  className="flex-1 overflow-x-auto overflow-y-hidden hide-scrollbar"
                  onScroll={(e) => {
                    // Synchronisiere mit ganttHScrollRef
                    if (ganttHScrollRef.current && ganttHScrollRef.current.scrollLeft !== e.target.scrollLeft) {
                      ganttHScrollRef.current.scrollLeft = e.target.scrollLeft;
                    }
                  }}
                >
                  <div className="flex flex-col" style={{ minWidth: ganttContentWidth }}>
                    {/* Monat Header */}
                    <div className="flex border-b bg-gray-50">
                      {monthHeaders.map((m, i) => (
                        <div key={i} style={{ width: m.weeks * 7 * DAY_WIDTH }} className="text-xs font-semibold text-center py-1 text-gray-700 border-r">{m.name}</div>
                      ))}
                    </div>
                    {/* KW + Datum + Wochentag */}
                    <div className="flex flex-1">
                      {weekNumbers.map(weekNum => {
                        const weekDates = getWeekDates(weekNum, new Date().getFullYear());
                        const displayWeekNum = weekDates.length > 0 ? getWeekNumber(weekDates[0]) : weekNum;
                        return (
                          <div key={weekNum} style={{ width: 7 * DAY_WIDTH }} className="flex-shrink-0 flex flex-col border-r">
                            <div className="text-xs font-semibold text-center bg-indigo-50 py-0.5 border-b" style={{ fontSize: zoomLevel < 75 ? 9 : 11 }}>KW {displayWeekNum}</div>
                            <div className="flex border-b">
                              {weekDates.map((date, i) => {
                                const dateStr = formatDate(date);
                                const holiday = holidays[dateStr];
                                const isToday = dateStr === formatDate(new Date());
                                const isHighlighted = highlightedDays[dateStr];
                                return (
                                  <div 
                                    key={i} 
                                    style={{ width: DAY_WIDTH, borderBottom: isHighlighted ? `3px solid ${isHighlighted}` : undefined }} 
                                    className={`text-center border-r border-gray-200 cursor-pointer ${isToday ? 'bg-red-200' : holiday ? 'bg-red-200' : i >= 5 ? 'bg-gray-200' : 'bg-gray-50'}`}
                                    onContextMenu={(e) => { e.preventDefault(); setDayContextMenu({ x: e.clientX, y: e.clientY, date: dateStr }); }}
                                    title={holiday ? `${holiday.name} (${holiday.type === 'feiertag' ? 'Feiertag' : holiday.type === 'urlaub' ? 'Urlaub' : holiday.type === 'betriebsferien' ? 'Betriebsferien' : 'Frei'})` : ''}
                                  >
                                    <div className={`text-xs ${isToday ? 'text-red-600 font-bold' : holiday ? 'text-red-700 font-semibold' : 'text-gray-500'}`} style={{ fontSize: zoomLevel < 75 ? 8 : 10 }}>{date.getDate()}</div>
                                  </div>
                                );
                              })}
                            </div>
                            <div className="flex flex-1">
                              {weekDates.map((date, i) => { 
                                const dateStr = formatDate(date);
                                const holiday = holidays[dateStr];
                                const isWeekend = i >= 5; 
                                const isToday = dateStr === formatDate(new Date());
                                const isHighlighted = highlightedDays[dateStr];
                                return (
                                  <div 
                                    key={i} 
                                    style={{ width: DAY_WIDTH, borderBottom: isHighlighted ? `3px solid ${isHighlighted}` : undefined }} 
                                    className={`text-center py-0.5 border-r border-gray-200 flex items-center justify-center cursor-pointer ${holiday ? 'bg-red-300' : isWeekend ? 'bg-gray-300' : ''} ${isToday ? 'bg-red-200 font-bold' : ''}`}
                                    onContextMenu={(e) => { e.preventDefault(); setDayContextMenu({ x: e.clientX, y: e.clientY, date: dateStr }); }}
                                    title={holiday ? `${holiday.name} (${holiday.type === 'feiertag' ? 'Feiertag' : holiday.type === 'urlaub' ? 'Urlaub' : holiday.type === 'betriebsferien' ? 'Betriebsferien' : 'Frei'})` : ''}
                                  >
                                    <span className={isToday ? 'text-red-600' : holiday ? 'text-red-700' : ''} style={{ fontSize: zoomLevel < 75 ? 8 : 10 }}>{['Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So'][i]}</span>
                                  </div>
                                ); 
                              })}
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                </div>
              </div>
              
              <div ref={ganttScrollRef} className="flex-1 overflow-y-auto overflow-x-hidden" style={{ overflowAnchor: 'none' }}
                onScroll={(e) => { window._ganttScrollTop.value = e.target.scrollTop; }}
              >
                <div className="flex" style={{ overflowAnchor: 'none' }}>
                  {/* Liste-Body - eingeklappt oder ausgeklappt */}
                  {leftPanelWidth <= 40 ? (
                    /* Eingeklappter Zustand - nur schmaler Streifen */
                    <div className="w-10 bg-gray-100 flex-shrink-0 border-r" />
                  ) : (
                    /* Ausgeklappter Zustand */
                    <div data-panel-list className="flex-shrink-0 bg-white border-r relative" style={{ width: leftPanelWidth, overflowAnchor: 'none' }}>
                      {/* Resize Handle f√ºr die gesamte Liste */}
                      <div 
                        className="absolute right-0 top-0 bottom-0 w-1 cursor-col-resize bg-gray-300 hover:bg-indigo-500 hover:w-2 active:bg-indigo-600 z-50 transition-all"
                        onMouseDown={(e) => { e.preventDefault(); e.stopPropagation(); setIsResizingPanel(true); }}
                        title="Liste verbreitern/verkleinern"
                      />
                    {allProjectsData.map(({ project, flatList }) => (
                      <div key={project.id}>
                        <div className="bg-gray-50 flex items-center justify-between cursor-pointer hover:bg-gray-100 border-b" style={{ height: ROW_HEIGHT }} onContextMenu={(e) => { e.preventDefault(); setContextMenu({ x: e.clientX, y: e.clientY, type: 'project', project }); }}>
                          <div className="flex items-center gap-2 px-2 border-r border-gray-200 flex-1"><div className="w-3 h-3 rounded" style={{ backgroundColor: project.color }} /><span className="font-semibold text-sm">{project.name}</span><span className="text-xs text-gray-400">({flatList.length})</span></div>
                          <button onClick={() => addWorkPackage(project.id)} className="p-1 hover:bg-indigo-100 rounded text-indigo-600 mr-2"><Plus className="w-4 h-4" /></button>
                        </div>
                        {flatList.map((wp, wpIndex) => {
                          const hasChildren = getChildren(wp.id, workPackages).length > 0;
                          const isExpanded = expandedPackages[wp.id] !== false;
                          const calcDates = hasChildren ? calculateDatesFromChildren(wp.id, workPackages) : null;
                          const isResizingThis = resizingWP?.wp.id === wp.id;
                          const isDraggingThis = draggedWP?.wp.id === wp.id && !draggedWP.isSummary;
                          let displayStart = calcDates?.startDate || wp.startDate;
                          let displayEnd = calcDates?.endDate || wp.endDate;
                          // Zeige Preview w√§hrend Resizing/Dragging
                          if (isResizingThis && resizingWP.side === 'left' && resizingWP.previewStart) {
                            displayStart = resizingWP.previewStart;
                          } else if (isResizingThis && resizingWP.previewEnd) {
                            displayEnd = resizingWP.previewEnd;
                          } else if (isDraggingThis && draggedWP.previewStart) {
                            displayStart = draggedWP.previewStart;
                            displayEnd = draggedWP.previewEnd;
                          }
                          const days = displayStart && displayEnd ? Math.ceil((parseLocalDate(displayEnd) - parseLocalDate(displayStart)) / (1000 * 60 * 60 * 24)) + 1 : '-';
                          const isBeingDragged = rowDragWP?.id === wp.id;
                          const isDropBefore = dropTarget?.wpId === wp.id && dropTarget?.position === 'before';
                          const isDropAfter = dropTarget?.wpId === wp.id && dropTarget?.position === 'after';
                          const isDropChild = dropTarget?.wpId === wp.id && dropTarget?.position === 'child';
                          
                          return (
                            <div key={wp.id} className="relative" data-wp-row={wp.id}>
                              {/* Drop-Indikator oben */}
                              {isDropBefore && <div className="absolute top-0 left-0 right-0 h-0.5 bg-indigo-500 z-10" />}
                              
                              <div 
                                className={`flex border-b border-gray-100 hover:bg-blue-50 items-center text-xs group cursor-pointer ${selectedWPs.includes(wp.id) ? 'bg-indigo-100 ring-2 ring-indigo-400' : sidebarWPId === wp.id ? 'bg-blue-100 ring-2 ring-blue-400' : selectedWP?.id === wp.id ? 'bg-indigo-50 ring-1 ring-indigo-300' : ''} ${isBeingDragged ? 'opacity-50 bg-gray-200' : ''} ${isDropChild ? 'bg-indigo-100 ring-2 ring-indigo-400' : ''}`} 
                                style={{ height: ROW_HEIGHT }} 
                                onClick={(e) => handleWPClick(e, wp, flatList)} 
                                onContextMenu={(e) => { e.preventDefault(); setContextMenu({ x: e.clientX, y: e.clientY, type: 'wp', wp, project }); }}
                                onMouseEnter={() => {
                                  if (rowDragWP && rowDragWP.id !== wp.id) {
                                    // Berechne ob wir im oberen, unteren oder mittleren Bereich sind
                                    setDropTarget({ wpId: wp.id, position: 'after' });
                                  }
                                }}
                                onMouseMove={(e) => {
                                  if (rowDragWP && rowDragWP.id !== wp.id) {
                                    const rect = e.currentTarget.getBoundingClientRect();
                                    const y = e.clientY - rect.top;
                                    const third = rect.height / 3;
                                    if (y < third) {
                                      setDropTarget({ wpId: wp.id, position: 'before' });
                                    } else if (y > third * 2) {
                                      setDropTarget({ wpId: wp.id, position: 'after' });
                                    } else {
                                      setDropTarget({ wpId: wp.id, position: 'child' });
                                    }
                                  }
                                }}
                                onMouseLeave={() => {
                                  if (rowDragWP && dropTarget?.wpId === wp.id) {
                                    setDropTarget(null);
                                  }
                                }}
                              >
                                <div className="flex-1 flex items-center min-w-0 border-r border-gray-200 h-full" style={{ minWidth: 120 }}>
                                  {/* Drag Handle */}
                                  <div 
                                    className="cursor-grab opacity-0 group-hover:opacity-50 hover:opacity-100 px-0.5 flex-shrink-0"
                                    onMouseDown={(e) => { e.stopPropagation(); e.preventDefault(); setRowDragWP(wp); }}
                                  >
                                    <GripVertical className="w-3 h-3 text-gray-400" />
                                  </div>
                                  {/* Tree Lines */}
                                  <div className="flex items-center h-full flex-shrink-0" style={{ width: wp._level * 18 }}>
                                    {Array.from({ length: wp._level }).map((_, lvl) => {
                                      const isLastAtLevel = lvl < wp._level - 1 ? !wp._parentIsLastPath[lvl] : false;
                                      const isConnector = lvl === wp._level - 1;
                                      return (
                                        <div key={lvl} className="relative h-full flex-shrink-0" style={{ width: 18 }}>
                                          {isConnector ? (
                                            <React.Fragment>
                                              {/* Vertical line from top */}
                                              <div className="absolute left-2 top-0" style={{ width: 1, height: wp._isLastChild ? '50%' : '100%', backgroundColor: '#d1d5db' }} />
                                              {/* Horizontal connector */}
                                              <div className="absolute left-2 top-1/2" style={{ width: 10, height: 1, backgroundColor: '#d1d5db' }} />
                                            </React.Fragment>
                                          ) : (
                                            /* Continuation line for non-last ancestors */
                                            isLastAtLevel && <div className="absolute left-2 top-0 bottom-0" style={{ width: 1, backgroundColor: '#d1d5db' }} />
                                          )}
                                        </div>
                                      );
                                    })}
                                  </div>
                                  {/* Expand/Collapse */}
                                  {hasChildren ? (
                                    <button onClick={(e) => { e.stopPropagation(); toggleExpand(wp.id); }} className="p-0.5 hover:bg-gray-200 rounded flex-shrink-0">
                                      {isExpanded ? <ChevronDown className="w-3.5 h-3.5 text-gray-600" /> : <ChevronRight className="w-3.5 h-3.5 text-gray-600" />}
                                    </button>
                                  ) : <span className="w-4 flex-shrink-0" />}
                                  {/* Color dot */}
                                  <div className="w-2.5 h-2.5 rounded-sm flex-shrink-0 mx-0.5" style={{ backgroundColor: wp.color || project.color }} />
                                  {/* Name */}
                                  {editingName === wp.id ? <input autoFocus type="text" defaultValue={wp.name} className="flex-1 min-w-0 px-1 border rounded text-xs" onClick={(e) => e.stopPropagation()} onBlur={(e) => { const updated = workPackages.map(w => w.id === wp.id ? { ...w, name: e.target.value } : w); saveWorkPackages(updated); setEditingName(null); }} onKeyDown={(e) => { if (e.key === 'Enter') e.target.blur(); if (e.key === 'Escape') setEditingName(null); }} /> : <span className={`truncate cursor-text ${hasChildren ? 'font-semibold text-gray-800' : 'text-gray-700'}`} onDoubleClick={(e) => { e.stopPropagation(); setEditingName(wp.id); }}>{wp.name}</span>}
                                </div>
                                {ganttVisibleColumns.start && <div className="text-center border-r border-gray-200 h-full flex items-center justify-center flex-shrink-0 overflow-hidden relative" style={{ width: columnWidths.start }}>{hasChildren ? <span className="text-gray-400 italic text-xs">auto</span> : <React.Fragment><span className="text-xs cursor-pointer hover:text-indigo-600" style={{ fontSize: 9 }} onClick={(e) => { e.stopPropagation(); const input = e.currentTarget.nextSibling; input.style.opacity = '1'; input.style.position = 'relative'; input.style.width = '100%'; input.focus(); }}>{formatDateShort(wp.startDate) || '-'}</span><input type="date" value={wp.startDate || ''} onChange={(e) => { const updated = workPackages.map(w => w.id === wp.id ? { ...w, startDate: e.target.value } : w); saveWorkPackages(updated); }} onBlur={(e) => { e.target.style.opacity = '0'; e.target.style.position = 'absolute'; e.target.style.width = '0'; }} className="absolute opacity-0 w-0 h-0 text-xs" style={{ fontSize: 9 }} /></React.Fragment>}</div>}
                                {ganttVisibleColumns.end && <div className="text-center border-r border-gray-200 h-full flex items-center justify-center flex-shrink-0 overflow-hidden relative" style={{ width: columnWidths.end }}>{hasChildren ? <span className="text-gray-400 italic text-xs">auto</span> : <React.Fragment><span className="text-xs cursor-pointer hover:text-indigo-600" style={{ fontSize: 9 }} onClick={(e) => { e.stopPropagation(); const input = e.currentTarget.nextSibling; input.style.opacity = '1'; input.style.position = 'relative'; input.style.width = '100%'; input.focus(); }}>{formatDateShort(wp.endDate) || '-'}</span><input type="date" value={wp.endDate || ''} onChange={(e) => { const updated = workPackages.map(w => w.id === wp.id ? { ...w, endDate: e.target.value } : w); saveWorkPackages(updated); }} onBlur={(e) => { e.target.style.opacity = '0'; e.target.style.position = 'absolute'; e.target.style.width = '0'; }} className="absolute opacity-0 w-0 h-0 text-xs" style={{ fontSize: 9 }} /></React.Fragment>}</div>}
                                {ganttVisibleColumns.hours && <div className="text-center text-gray-500 font-medium border-r border-gray-200 h-full flex items-center justify-center flex-shrink-0 relative overflow-hidden" style={{ width: columnWidths.hours, fontSize: 10 }}>{hasChildren ? <span className="text-gray-400 italic text-xs" title="Summe aus Unterpaketen">{calculateTotalHours(wp.id) || 0}h</span> : <React.Fragment><span className="cursor-pointer hover:text-indigo-600 hover:bg-indigo-50 px-1 rounded" onClick={(e) => { e.stopPropagation(); const input = e.currentTarget.nextSibling; input.style.opacity = '1'; input.style.width = '100%'; input.focus(); input.select(); }}>{wp.plannedHours ? `${wp.plannedHours}h` : '-'}</span><input type="number" min="0" step="0.5" defaultValue={wp.plannedHours || ''} placeholder="0" onClick={(e) => e.stopPropagation()} onFocus={(e) => { e.target.style.opacity = '1'; e.target.style.width = '100%'; }} onBlur={(e) => { const val = parseFloat(e.target.value) || 0; if (val !== (wp.plannedHours || 0)) { const updated = workPackages.map(w => w.id === wp.id ? { ...w, plannedHours: val } : w); saveWorkPackages(updated); } e.target.style.opacity = '0'; e.target.style.width = '0'; }} onKeyDown={(e) => { if (e.key === 'Enter') e.target.blur(); if (e.key === 'Escape') { e.target.value = wp.plannedHours || ''; e.target.blur(); } }} className="absolute inset-0 opacity-0 w-0 text-center text-xs bg-white border border-indigo-300 rounded" style={{ fontSize: 10 }} /></React.Fragment>}</div>}
                                {ganttVisibleColumns.days && <div className="text-center text-gray-500 h-full flex items-center justify-center flex-shrink-0" style={{ width: columnWidths.days }}>{days}</div>}
                              </div>
                              
                              {/* Drop-Indikator unten */}
                              {isDropAfter && <div className="absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-500 z-10" />}
                            </div>
                          );
                        })}
                        {flatList.length === 0 && <div className="px-4 text-xs text-gray-400 italic border-b flex items-center" style={{ height: ROW_HEIGHT }}>Keine Arbeitspakete</div>}
                      </div>
                    ))}
                    {/* Extra Scroll-Raum unten (synchron mit Gantt) */}
                    <div style={{ height: 500 }} />
                  </div>
                  )}
                  
                  <div 
                    ref={ganttHScrollRef} 
                    className="flex-1 overflow-x-auto" 
                    style={{ overflowAnchor: 'none' }}
                    onScroll={(e) => {
                      window._ganttScrollLeft.value = e.target.scrollLeft;
                      // Track content width changes
                      if (e.target.scrollWidth !== ganttContentWidth) setGanttContentWidth(e.target.scrollWidth);
                      // Sync header
                      if (headerScrollRef.current && headerScrollRef.current.scrollLeft !== e.target.scrollLeft) {
                        headerScrollRef.current.scrollLeft = e.target.scrollLeft;
                      }
                      // Sync workload
                      if (workloadScrollRef.current && workloadScrollRef.current.scrollLeft !== e.target.scrollLeft) {
                        workloadScrollRef.current.scrollLeft = e.target.scrollLeft;
                      }
                    }}
                  >
                    <div className="min-w-max relative"
                      onContextMenu={(e) => {
                        // Nur wenn direkt auf Hintergrund geklickt (nicht auf einen Balken)
                        if (e.target.closest('[data-wp-id]')) return;
                        e.preventDefault();
                        // Datum aus X-Position berechnen
                        const rect = e.currentTarget.getBoundingClientRect();
                        const relX = e.clientX - rect.left;
                        const clickedDate = xToDate(relX);
                        // Projekt ermitteln (ausgew√§hltes oder erstes)
                        const targetProject = selectedProjectId 
                          ? projects.find(p => p.id === selectedProjectId) 
                          : projects[0];
                        if (targetProject) {
                          setContextMenu({ 
                            x: e.clientX, y: e.clientY, type: 'gantt-bg', 
                            date: clickedDate, project: targetProject 
                          });
                        }
                      }}
                    >
                      {/* Feiertags-Overlay - halbtransparente Streifen f√ºr jeden Feiertag/freien Tag */}
                      {Object.keys(holidays).length > 0 && (
                        <div className="absolute inset-0 pointer-events-none z-5">
                          {Object.entries(holidays).map(([dateStr, holiday]) => {
                            const dayX = dateToX(dateStr);
                            if (dayX < 0 || dayX > WEEKS_TO_SHOW * 7 * DAY_WIDTH) return null;
                            const colorMap = {
                              feiertag: 'rgba(239, 68, 68, 0.15)',      // rot
                              urlaub: 'rgba(249, 115, 22, 0.15)',       // orange  
                              betriebsferien: 'rgba(168, 85, 247, 0.15)', // lila
                              frei: 'rgba(107, 114, 128, 0.15)'         // grau
                            };
                            return (
                              <div
                                key={dateStr}
                                className="absolute top-0 bottom-0"
                                style={{ 
                                  left: dayX, 
                                  width: DAY_WIDTH, 
                                  backgroundColor: colorMap[holiday.type] || 'rgba(239, 68, 68, 0.15)'
                                }}
                                title={`${holiday.name} (${holiday.type})`}
                              />
                            );
                          })}
                        </div>
                      )}
                      {allProjectsData.map(({ project, flatList }) => (
                        <div key={project.id}>
                          <div className="flex items-center bg-gray-50 border-b" style={{ height: ROW_HEIGHT }}>
                            <div className="font-semibold text-sm px-2 flex items-center gap-2" style={{ minWidth: WEEKS_TO_SHOW * 7 * DAY_WIDTH }}>
                              <div className="w-3 h-3 rounded" style={{ backgroundColor: project.color }} />{project.name}
                            </div>
                          </div>
                          {flatList.map(wp => {
                            const hasChildren = getChildren(wp.id, workPackages).length > 0;
                            const isExpanded = expandedPackages[wp.id] !== false;
                            const calcDates = hasChildren ? calculateDatesFromChildren(wp.id, workPackages) : null;
                            const isDragging = draggedWP?.wp.id === wp.id;
                            const isResizing = resizingWP?.wp.id === wp.id;
                            const hasPreview = previewPositions[wp.id]; // Live-Preview f√ºr abh√§ngige Balken
                            let displayStart, displayEnd;
                            if (isDragging && !draggedWP.isSummary) {
                              displayStart = draggedWP.previewStart;
                              displayEnd = draggedWP.previewEnd;
                            } else if (isResizing) {
                              if (resizingWP.side === 'left' && resizingWP.previewStart) {
                                displayStart = resizingWP.previewStart;
                                displayEnd = calcDates?.endDate || wp.endDate;
                              } else {
                                displayStart = calcDates?.startDate || wp.startDate;
                                displayEnd = resizingWP.previewEnd || (calcDates?.endDate || wp.endDate);
                              }
                            } else if (hasPreview) {
                              // Zeige Preview-Position f√ºr abh√§ngige Balken
                              displayStart = hasPreview.startDate;
                              displayEnd = hasPreview.endDate;
                            } else {
                              displayStart = calcDates?.startDate || wp.startDate;
                              displayEnd = calcDates?.endDate || wp.endDate;
                            }
                            
                            const bgStyle = {
                              height: ROW_HEIGHT, 
                              minWidth: WEEKS_TO_SHOW * 7 * DAY_WIDTH,
                              backgroundImage: `
                                repeating-linear-gradient(90deg, 
                                  transparent 0, transparent ${DAY_WIDTH - 1}px, 
                                  #e5e7eb ${DAY_WIDTH - 1}px, #e5e7eb ${DAY_WIDTH}px
                                ),
                                repeating-linear-gradient(90deg, 
                                  transparent 0, transparent ${DAY_WIDTH * 5}px, 
                                  #d1d5db ${DAY_WIDTH * 5}px, #d1d5db ${DAY_WIDTH * 7}px
                                )
                              `
                            };
                            
                            if (!displayStart || !displayEnd) return <div key={wp.id} className="border-b border-gray-100" style={bgStyle} />;
                            const x = dateToX(displayStart);
                            const endX = dateToX(displayEnd);
                            const width = endX - x + DAY_WIDTH;
                            const color = wp.color || project.color;
                            const isPreview = !!hasPreview || isDragging || isResizing;
                            const hasOriginal = originalPositions[wp.id]; // F√ºr violetten Schatten bei Drag
                            
                            // Baseline-Position finden
                            const baselineWP = activeBaseline?.workPackages.find(bwp => bwp.id === wp.id);
                            
                            // Violetter Schatten f√ºr Original-Position (beim Drag) oder Baseline
                            let shadowElement = null;
                            if (hasOriginal && (hasPreview || isDragging || isResizing)) {
                              // Drag-Preview Schatten
                              const origX = dateToX(hasOriginal.startDate);
                              const origEndX = dateToX(hasOriginal.endDate);
                              const origWidth = origEndX - origX + DAY_WIDTH;
                              shadowElement = (
                                <div 
                                  className="absolute rounded opacity-30 pointer-events-none"
                                  style={{ 
                                    left: origX, 
                                    width: origWidth, 
                                    top: hasChildren ? 4 : (wp._level > 0 ? 6 : 4), 
                                    height: hasChildren ? ROW_HEIGHT - 8 : (wp._level > 0 ? ROW_HEIGHT - 12 : ROW_HEIGHT - 8),
                                    backgroundColor: '#8b5cf6',
                                    border: '2px dashed #7c3aed'
                                  }} 
                                />
                              );
                            } else if (baselineWP && baselineWP.startDate && baselineWP.endDate) {
                              // Baseline Schatten (nur wenn Position anders ist)
                              const baselineStartDate = baselineWP.startDate;
                              const baselineEndDate = baselineWP.endDate;
                              const currentStart = calcDates?.startDate || wp.startDate;
                              const currentEnd = calcDates?.endDate || wp.endDate;
                              
                              if (baselineStartDate !== currentStart || baselineEndDate !== currentEnd) {
                                const baseX = dateToX(baselineStartDate);
                                const baseEndX = dateToX(baselineEndDate);
                                const baseWidth = baseEndX - baseX + DAY_WIDTH;
                                shadowElement = (
                                  <div 
                                    className="absolute rounded opacity-25 pointer-events-none"
                                    style={{ 
                                      left: baseX, 
                                      width: baseWidth, 
                                      top: hasChildren ? 4 : (wp._level > 0 ? 6 : 4), 
                                      height: hasChildren ? ROW_HEIGHT - 8 : (wp._level > 0 ? ROW_HEIGHT - 12 : ROW_HEIGHT - 8),
                                      backgroundColor: '#8b5cf6',
                                      border: '2px dashed #7c3aed'
                                    }} 
                                  />
                                );
                              }
                            }
                            
                            const isBeingDragged = rowDragWP?.id === wp.id;
                            const isDropBefore = dropTarget?.wpId === wp.id && dropTarget?.position === 'before';
                            const isDropAfter = dropTarget?.wpId === wp.id && dropTarget?.position === 'after';
                            const isDropChild = dropTarget?.wpId === wp.id && dropTarget?.position === 'child';
                            
                            return (
                              <div key={wp.id} className="relative" data-wp-row-right={wp.id}>
                                {/* Drop-Indikator oben */}
                                {isDropBefore && <div className="absolute top-0 left-0 right-0 h-0.5 bg-indigo-500 z-10" />}
                                
                                <div 
                                  className={`relative border-b border-gray-100 group ${isBeingDragged ? 'opacity-50' : ''} ${isDropChild ? 'ring-2 ring-indigo-400 ring-inset' : ''}`} 
                                  style={bgStyle}
                                  onMouseEnter={() => {
                                    if (rowDragWP && rowDragWP.id !== wp.id) {
                                      setDropTarget({ wpId: wp.id, position: 'after' });
                                    }
                                  }}
                                  onMouseMove={(e) => {
                                    if (rowDragWP && rowDragWP.id !== wp.id) {
                                      const rect = e.currentTarget.getBoundingClientRect();
                                      const y = e.clientY - rect.top;
                                      const third = rect.height / 3;
                                      if (y < third) {
                                        setDropTarget({ wpId: wp.id, position: 'before' });
                                      } else if (y > third * 2) {
                                        setDropTarget({ wpId: wp.id, position: 'after' });
                                      } else {
                                        setDropTarget({ wpId: wp.id, position: 'child' });
                                      }
                                    }
                                  }}
                                  onMouseLeave={() => {
                                    if (rowDragWP && dropTarget?.wpId === wp.id) {
                                      setDropTarget(null);
                                    }
                                  }}
                                >
                                  {shadowElement}
                                  {hasChildren && isExpanded ? renderBracket(wp, x, width, color) : renderBar(wp, x, width, color, wp._level > 0)}
                                </div>
                                
                                {/* Drop-Indikator unten */}
                                {isDropAfter && <div className="absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-500 z-10" />}
                              </div>
                            );
                          })}
                          {flatList.length === 0 && <div className="border-b border-gray-100" style={{ height: ROW_HEIGHT, minWidth: WEEKS_TO_SHOW * 7 * DAY_WIDTH }} />}
                        </div>
                      ))}
                      {/* Extra Scroll-Raum unten */}
                      <div style={{ height: 500, minWidth: WEEKS_TO_SHOW * 7 * DAY_WIDTH }} />
                      {/* Hervorgehobene Tage */}
                      {Object.keys(highlightedDays).length > 0 && (
                        <div className="absolute inset-0 pointer-events-none" style={{ zIndex: 2 }}>
                          {Object.entries(highlightedDays).map(([dateStr, color]) => {
                            const dayX = dateToX(dateStr);
                            if (dayX < 0 || dayX > WEEKS_TO_SHOW * 7 * DAY_WIDTH) return null;
                            return (
                              <div
                                key={`hl-${dateStr}`}
                                className="absolute top-0 bottom-0"
                                style={{ left: dayX, width: DAY_WIDTH, backgroundColor: color, opacity: 0.2 }}
                              />
                            );
                          })}
                        </div>
                      )}
                      {/* Heutige-Tag Markierung - Roter Strich (nach Rows gerendert = √ºber Backgrounds, z-3 < Balken z-6) */}
                      {(() => {
                        const todayX = dateToX(formatDate(new Date()));
                        if (todayX >= 0 && todayX <= WEEKS_TO_SHOW * 7 * DAY_WIDTH) {
                          return (
                            <div 
                              className="absolute top-0 bottom-0 pointer-events-none"
                              style={{ left: todayX + Math.floor(DAY_WIDTH / 2) - 1, width: 2, backgroundColor: '#ef4444', zIndex: 3 }}
                            />
                          );
                        }
                        return null;
                      })()}
                      <svg className="absolute top-0 left-0 pointer-events-none" style={{ width: WEEKS_TO_SHOW * 7 * DAY_WIDTH, height: '100%', overflow: 'visible' }}>
                        <defs>
                          <marker id="arrow-gray" markerWidth="5" markerHeight="4" refX="4" refY="2" orient="auto"><polygon points="0 0, 5 2, 0 4" fill="#9ca3af" /></marker>
                          <marker id="arrow-red" markerWidth="5" markerHeight="4" refX="4" refY="2" orient="auto"><polygon points="0 0, 5 2, 0 4" fill="#ef4444" /></marker>
                          <marker id="arrow-orange" markerWidth="5" markerHeight="4" refX="4" refY="2" orient="auto"><polygon points="0 0, 5 2, 0 4" fill="#f97316" /></marker>
                          <marker id="arrow-magenta" markerWidth="5" markerHeight="4" refX="4" refY="2" orient="auto"><polygon points="0 0, 5 2, 0 4" fill="#d946ef" /></marker>
                          <filter id="glow-magenta" x="-50%" y="-50%" width="200%" height="200%">
                            <feGaussianBlur stdDeviation="3" result="blur" />
                            <feMerge><feMergeNode in="blur" /><feMergeNode in="blur" /><feMergeNode in="SourceGraphic" /></feMerge>
                          </filter>
                        </defs>
                        {dependencies.map(dep => {
                          const fromWP = workPackages.find(w => w.id === dep.fromId);
                          const toWP = workPackages.find(w => w.id === dep.toId);
                          if (!fromWP || !toWP) return null;
                          
                          const depType = dep.type || 'FS'; // Standard ist Finish-to-Start
                          const isSSType = depType === 'SS';
                          
                          // Pr√ºfe ob Ziel gesperrt ist und Konflikt besteht
                          const toIsLocked = toWP.locked === true;
                          let hasConflict = false;
                          if (toIsLocked && !isSSType) {
                            // FS: Konflikt wenn Vorg√§nger-Ende >= Nachfolger-Start
                            const fromEndDate = getChildren(fromWP.id, workPackages).length > 0 
                              ? calculateDatesFromChildren(fromWP.id, workPackages)?.endDate 
                              : fromWP.endDate;
                            const toStartDate = getChildren(toWP.id, workPackages).length > 0 
                              ? calculateDatesFromChildren(toWP.id, workPackages)?.startDate 
                              : toWP.startDate;
                            if (fromEndDate && toStartDate && parseLocalDate(fromEndDate) >= parseLocalDate(toStartDate)) {
                              hasConflict = true;
                            }
                          } else if (toIsLocked && isSSType) {
                            // SS: Konflikt wenn Vorg√§nger-Start > Nachfolger-Start
                            const fromStartDate = getChildren(fromWP.id, workPackages).length > 0 
                              ? calculateDatesFromChildren(fromWP.id, workPackages)?.startDate 
                              : fromWP.startDate;
                            const toStartDate = getChildren(toWP.id, workPackages).length > 0 
                              ? calculateDatesFromChildren(toWP.id, workPackages)?.startDate 
                              : toWP.startDate;
                            if (fromStartDate && toStartDate && parseLocalDate(fromStartDate) > parseLocalDate(toStartDate)) {
                              hasConflict = true;
                            }
                          }
                          
                          // Ber√ºcksichtige Preview-Positionen f√ºr Pfeile
                          const fromPreview = previewPositions[dep.fromId];
                          const toPreview = previewPositions[dep.toId];
                          const fromDragged = draggedWP?.wp.id === dep.fromId;
                          const toDragged = draggedWP?.wp.id === dep.toId;
                          const fromResized = resizingWP?.wp.id === dep.fromId && resizingWP.previewEnd;
                          
                          let fromDate, toStartDate;
                          
                          // From-Datum berechnen (Ende bei FS, Start bei SS)
                          if (isSSType) {
                            // Start-to-Start: Vom Start des From-Balkens
                            if (fromDragged && !draggedWP.isSummary && draggedWP.previewStart) {
                              fromDate = draggedWP.previewStart;
                            } else if (fromDragged && draggedWP.isSummary && draggedWP.daysDiff) {
                              const origStart = parseLocalDate(fromWP.startDate);
                              origStart.setDate(origStart.getDate() + draggedWP.daysDiff);
                              fromDate = formatDate(origStart);
                            } else if (fromPreview) {
                              fromDate = fromPreview.startDate;
                            } else {
                              const fromDates = getChildren(fromWP.id, workPackages).length > 0 ? calculateDatesFromChildren(fromWP.id, workPackages) : { startDate: fromWP.startDate };
                              fromDate = fromDates?.startDate;
                            }
                          } else {
                            // Finish-to-Start: Vom Ende des From-Balkens
                            if (fromDragged && !draggedWP.isSummary && draggedWP.previewEnd) {
                              fromDate = draggedWP.previewEnd;
                            } else if (fromDragged && draggedWP.isSummary && draggedWP.daysDiff) {
                              const origEnd = parseLocalDate(fromWP.endDate);
                              origEnd.setDate(origEnd.getDate() + draggedWP.daysDiff);
                              fromDate = formatDate(origEnd);
                            } else if (fromResized) {
                              fromDate = resizingWP.previewEnd;
                            } else if (fromPreview) {
                              fromDate = fromPreview.endDate;
                            } else {
                              const fromDates = getChildren(fromWP.id, workPackages).length > 0 ? calculateDatesFromChildren(fromWP.id, workPackages) : { endDate: fromWP.endDate };
                              fromDate = fromDates?.endDate;
                            }
                          }
                          
                          // To-Start berechnen
                          if (toDragged && !draggedWP.isSummary && draggedWP.previewStart) {
                            toStartDate = draggedWP.previewStart;
                          } else if (toDragged && draggedWP.isSummary && draggedWP.daysDiff) {
                            const origStart = parseLocalDate(toWP.startDate);
                            origStart.setDate(origStart.getDate() + draggedWP.daysDiff);
                            toStartDate = formatDate(origStart);
                          } else if (toPreview) {
                            toStartDate = toPreview.startDate;
                          } else {
                            const toDates = getChildren(toWP.id, workPackages).length > 0 ? calculateDatesFromChildren(toWP.id, workPackages) : { startDate: toWP.startDate };
                            toStartDate = toDates?.startDate;
                          }
                          
                          if (!fromDate || !toStartDate) return null;
                          let fromY = 0, toY = 0, foundFrom = false, foundTo = false, currentY = 0;
                          allProjectsData.forEach(({ flatList }) => { currentY += ROW_HEIGHT; flatList.forEach(wp => { if (wp.id === fromWP.id) { fromY = currentY + ROW_HEIGHT / 2; foundFrom = true; } if (wp.id === toWP.id) { toY = currentY + ROW_HEIGHT / 2; foundTo = true; } currentY += ROW_HEIGHT; }); if (flatList.length === 0) currentY += ROW_HEIGHT; });
                          if (!foundFrom || !foundTo) return null;
                          
                          // Bei SS: Vom Start, bei FS: Vom Ende
                          const fromX = isSSType ? dateToX(fromDate) : dateToX(fromDate) + DAY_WIDTH;
                          const toStartX = dateToX(toStartDate);
                          const isHovered = hoveredDep === dep.id;
                          
                          const r = 6;
                          const barHeight = ROW_HEIGHT - 8;
                          const startX = isSSType ? fromX + DAY_WIDTH / 2 : fromX - DAY_WIDTH / 2;
                          const startY = fromY + barHeight / 2;
                          const endX = toStartX;
                          const endY = toY;
                          const goingDown = endY > startY;
                          const goingBack = isSSType ? (toStartX < fromX + DAY_WIDTH) : (toStartX < fromX);
                          
                          let path;
                          if (Math.abs(startY - endY) < 5 && !goingBack) {
                            path = `M ${fromX} ${fromY} L ${endX} ${endY}`;
                          } else if (goingBack) {
                            const firstDropY = startY + 12;
                            const leftX = Math.min(startX, endX) - 12;
                            
                            path = `M ${startX} ${startY}`;
                            path += ` L ${startX} ${firstDropY - r}`;
                            path += ` Q ${startX} ${firstDropY}, ${startX - r} ${firstDropY}`;
                            path += ` L ${leftX + r} ${firstDropY}`;
                            path += ` Q ${leftX} ${firstDropY}, ${leftX} ${firstDropY + (goingDown ? r : -r)}`;
                            path += ` L ${leftX} ${endY + (goingDown ? -r : r)}`;
                            path += ` Q ${leftX} ${endY}, ${leftX + r} ${endY}`;
                            path += ` L ${endX} ${endY}`;
                          } else {
                            path = `M ${startX} ${startY}`;
                            path += ` L ${startX} ${endY + (goingDown ? -r : r)}`;
                            path += ` Q ${startX} ${endY}, ${startX + r} ${endY}`;
                            path += ` L ${endX} ${endY}`;
                          }
                          
                          // Alle Pfeile grau (magenta bei Hover, orange bei Konflikt)
                          const strokeColor = hasConflict ? '#f97316' : (isHovered ? '#d946ef' : '#9ca3af');
                          const arrowMarker = hasConflict ? 'url(#arrow-orange)' : (isHovered ? 'url(#arrow-magenta)' : 'url(#arrow-gray)');
                          const strokeDasharray = hasConflict ? '6,3' : 'none';
                          
                          // Berechne Mittelpunkt entlang des Pfadverlaufs
                          let midX, midY;
                          if (Math.abs(startY - endY) < 5 && !goingBack) {
                            // Rein horizontal: Mitte der Linie
                            midX = (startX + endX) / 2;
                            midY = (startY + endY) / 2;
                          } else if (goingBack) {
                            // U-Form: Sammle Wegpunkte und finde den Mittelpunkt entlang des Pfads
                            const firstDropY = startY + 12;
                            const leftX = Math.min(startX, endX) - 12;
                            const pts = [
                              [startX, startY], [startX, firstDropY],
                              [leftX, firstDropY], [leftX, endY], [endX, endY]
                            ];
                            let totalLen = 0;
                            const segs = [];
                            for (let si = 1; si < pts.length; si++) {
                              const segLen = Math.abs(pts[si][0] - pts[si-1][0]) + Math.abs(pts[si][1] - pts[si-1][1]);
                              segs.push({ from: pts[si-1], to: pts[si], len: segLen });
                              totalLen += segLen;
                            }
                            let halfLen = totalLen / 2, acc = 0;
                            for (const seg of segs) {
                              if (acc + seg.len >= halfLen) {
                                const t = (halfLen - acc) / seg.len;
                                midX = seg.from[0] + (seg.to[0] - seg.from[0]) * t;
                                midY = seg.from[1] + (seg.to[1] - seg.from[1]) * t;
                                break;
                              }
                              acc += seg.len;
                            }
                          } else {
                            // L-Form: Wegpunkte startX,startY ‚Üí startX,endY ‚Üí endX,endY
                            const vertLen = Math.abs(endY - startY);
                            const horizLen = Math.abs(endX - startX);
                            const totalLen = vertLen + horizLen;
                            const halfLen = totalLen / 2;
                            if (halfLen <= vertLen) {
                              // Mittelpunkt auf dem vertikalen Segment
                              midX = startX;
                              midY = startY + (endY - startY) * (halfLen / vertLen);
                            } else {
                              // Mittelpunkt auf dem horizontalen Segment
                              const t = (halfLen - vertLen) / horizLen;
                              midX = startX + (endX - startX) * t;
                              midY = endY;
                            }
                          }
                          
                          return (
                            <g key={dep.id} onMouseEnter={() => setHoveredDep(dep.id)} onMouseLeave={() => setHoveredDep(null)} style={{ pointerEvents: 'stroke', cursor: 'pointer' }}>
                              <path d={path} fill="none" stroke="transparent" strokeWidth="24" />
                              <path d={path} fill="none" stroke={strokeColor} strokeWidth={isHovered ? 3.5 : hasConflict ? 2.5 : 1.5} strokeDasharray={strokeDasharray} markerEnd={arrowMarker} filter={isHovered ? 'url(#glow-magenta)' : undefined} />
                              {/* Warnsymbol bei Konflikt */}
                              {hasConflict && (
                                <g transform={`translate(${midX - 10}, ${midY - 10})`} style={{ pointerEvents: 'all' }} title="Terminkonflikt: Ziel ist fixiert">
                                  <circle cx="10" cy="10" r="10" fill="#fef3c7" stroke="#f97316" strokeWidth="1.5" />
                                  <text x="10" y="14" textAnchor="middle" fontSize="13" fontWeight="bold" fill="#f97316">‚ö†</text>
                                </g>
                              )}
                              {/* L√∂sch-Button - nur bei Hover auf der Mitte des horizontalen Segments */}
                              {isHovered && (
                                <g transform={`translate(${hasConflict ? midX + 4 : midX - 8}, ${midY - 8})`} onClick={() => deleteDependency(dep.id)} style={{ cursor: 'pointer', pointerEvents: 'all' }}>
                                  <circle cx="8" cy="8" r="9" fill="white" stroke="#d946ef" strokeWidth="1.5" />
                                  <path d="M5 5 L11 11 M11 5 L5 11" stroke="#d946ef" strokeWidth="1.5" strokeLinecap="round" />
                                </g>
                              )}
                            </g>
                          );
                        })}
                      </svg>
                    </div>
                  </div>
                </div>
              </div>
          
          {linkingFrom && linkMousePos && <svg className="fixed inset-0 pointer-events-none z-40" style={{ width: '100vw', height: '100vh' }}><line x1={linkingFrom.startX || 0} y1={linkingFrom.startY || 0} x2={linkMousePos.x} y2={linkMousePos.y} stroke="#9ca3af" strokeWidth="2" strokeDasharray="5,5" /><circle cx={linkMousePos.x} cy={linkMousePos.y} r="5" fill="#9ca3af" /></svg>}
          
          {contextMenu && <div className="fixed bg-white rounded-lg shadow-xl border py-1 z-50 min-w-48" style={{ left: contextMenu.x, top: contextMenu.y }}>
            {contextMenu.type === 'project' && <React.Fragment>
              <div className="px-3 py-1 text-xs text-gray-500 border-b">{contextMenu.project.name}</div>
              <button onClick={() => { addWorkPackage(contextMenu.project.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><Plus className="w-4 h-4 text-indigo-600" /> Neues Arbeitspaket</button>
              <div className="border-t my-1" />
              <button onClick={() => { setEditingProjectId(contextMenu.project.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><span className="w-4 h-4 text-center">‚úèÔ∏è</span> Umbenennen</button>
              <button onClick={() => { saveProjects((projects || []).map(p => p.id === contextMenu.project.id ? { ...p, archived: true } : p)); if (selectedProjectId === contextMenu.project.id) setSelectedProjectId(null); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-amber-50 text-amber-700 flex items-center gap-2"><span className="w-4 h-4 text-center">üì¶</span> Archivieren</button>
              <button onClick={() => { if (confirm(`Projekt "${contextMenu.project.name}" und alle zugeh√∂rigen Arbeitspakete unwiderruflich l√∂schen?`)) { const projId = contextMenu.project.id; saveProjects((projects || []).filter(p => p.id !== projId)); saveWorkPackages((workPackages || []).filter(wp => wp.projectId !== projId)); saveDependencies((dependencies || []).filter(d => { const fromWP = (workPackages || []).find(w => w.id === d.fromId); const toWP = (workPackages || []).find(w => w.id === d.toId); return fromWP?.projectId !== projId && toWP?.projectId !== projId; })); if (selectedProjectId === projId) setSelectedProjectId(null); } setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2"><Trash2 className="w-4 h-4" /> L√∂schen</button>
            </React.Fragment>}
            {contextMenu.type === 'sidebar-project' && <React.Fragment>
              <div className="px-3 py-1 text-xs text-gray-500 border-b">{contextMenu.project.name}</div>
              <button onClick={() => { setEditingProjectId(contextMenu.project.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><span className="w-4 h-4 text-center">‚úèÔ∏è</span> Umbenennen</button>
              <button onClick={() => { saveProjects((projects || []).map(p => p.id === contextMenu.project.id ? { ...p, archived: true } : p)); if (selectedProjectId === contextMenu.project.id) setSelectedProjectId(null); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-amber-50 text-amber-700 flex items-center gap-2"><span className="w-4 h-4 text-center">üì¶</span> Archivieren</button>
              <div className="border-t my-1" />
              <button onClick={() => { if (confirm(`Projekt "${contextMenu.project.name}" und alle zugeh√∂rigen Arbeitspakete unwiderruflich l√∂schen?`)) { const projId = contextMenu.project.id; saveProjects((projects || []).filter(p => p.id !== projId)); saveWorkPackages((workPackages || []).filter(wp => wp.projectId !== projId)); saveDependencies((dependencies || []).filter(d => { const fromWP = (workPackages || []).find(w => w.id === d.fromId); const toWP = (workPackages || []).find(w => w.id === d.toId); return fromWP?.projectId !== projId && toWP?.projectId !== projId; })); if (selectedProjectId === projId) setSelectedProjectId(null); } setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2"><Trash2 className="w-4 h-4" /> L√∂schen</button>
            </React.Fragment>}
            {contextMenu.type === 'archived-project' && <React.Fragment>
              <div className="px-3 py-1 text-xs text-gray-500 border-b">üì¶ {contextMenu.project.name}</div>
              <button onClick={() => { saveProjects((projects || []).map(p => p.id === contextMenu.project.id ? { ...p, archived: false } : p)); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-green-50 text-green-700 flex items-center gap-2"><span className="w-4 h-4 text-center">‚Ü©Ô∏è</span> Wiederherstellen</button>
              <div className="border-t my-1" />
              <button onClick={() => { if (confirm(`Projekt "${contextMenu.project.name}" und alle zugeh√∂rigen Arbeitspakete unwiderruflich l√∂schen?`)) { const projId = contextMenu.project.id; saveProjects((projects || []).filter(p => p.id !== projId)); saveWorkPackages((workPackages || []).filter(wp => wp.projectId !== projId)); saveDependencies((dependencies || []).filter(d => { const fromWP = (workPackages || []).find(w => w.id === d.fromId); const toWP = (workPackages || []).find(w => w.id === d.toId); return fromWP?.projectId !== projId && toWP?.projectId !== projId; })); } setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2"><Trash2 className="w-4 h-4" /> Endg√ºltig l√∂schen</button>
            </React.Fragment>}
            {contextMenu.type === 'wp' && <React.Fragment><div className="px-3 py-1 text-xs text-gray-500 border-b truncate max-w-48">{contextMenu.wp.name}</div><button onClick={() => { addWorkPackage(contextMenu.wp.projectId, contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><Plus className="w-4 h-4 text-green-600" /> Tochter-Arbeitspaket</button><button onClick={() => { addWorkPackageBelow(contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><Plus className="w-4 h-4 text-indigo-600" /> Arbeitspaket darunter</button><button onClick={() => { indentWorkPackage(contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><ChevronRight className="w-4 h-4" /> Einr√ºcken</button><button onClick={() => { outdentWorkPackage(contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><ChevronLeft className="w-4 h-4" /> Ausr√ºcken</button><div className="border-t my-1" /><button onClick={() => { showWPResourcePlanning(contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><span className="w-4 h-4 flex items-center justify-center text-orange-600">üìä</span> Ressourcen-Feinplanung</button><div className="border-t my-1" /><button onClick={() => { deleteWorkPackage(contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2"><Trash2 className="w-4 h-4" /> L√∂schen</button></React.Fragment>}
            {contextMenu.type === 'gantt-wp' && <React.Fragment>
              <div className="px-3 py-1 text-xs text-gray-500 border-b truncate max-w-48">{contextMenu.wp.name}</div>
              <div className="px-3 py-2 text-xs text-gray-600">Farbe w√§hlen:</div>
              <div className="px-3 pb-2 flex flex-wrap gap-1">
                {wpColors.map(color => <button key={color} onClick={() => { updateWorkPackage(contextMenu.wp.id, 'color', color); setContextMenu(null); }} className={`w-6 h-6 rounded border-2 ${contextMenu.wp.color === color ? 'border-gray-800' : 'border-transparent'} hover:scale-110 transition-transform`} style={{ backgroundColor: color }} />)}
                <button onClick={() => { updateWorkPackage(contextMenu.wp.id, 'color', null); setContextMenu(null); }} className="w-6 h-6 rounded border-2 border-gray-300 hover:scale-110 transition-transform text-xs text-gray-400">X</button>
              </div>
              <div className="border-t my-1" />
              <button onClick={() => { addWorkPackage(contextMenu.wp.projectId, contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><Plus className="w-4 h-4 text-green-600" /> Tochter-Arbeitspaket</button>
              <button onClick={() => { addWorkPackageBelow(contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><Plus className="w-4 h-4 text-indigo-600" /> Arbeitspaket darunter</button>
              <button onClick={() => { updateWorkPackage(contextMenu.wp.id, 'allowWeekend', !contextMenu.wp.allowWeekend); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2">
                {contextMenu.wp.allowWeekend ? <span className="w-4 h-4 text-center">‚úÖ</span> : <span className="w-4 h-4 text-center text-gray-300">‚òê</span>}
                üóìÔ∏è Wochenend/Feiertagsarbeit
              </button>
              <button onClick={() => { updateWorkPackage(contextMenu.wp.id, 'locked', !contextMenu.wp.locked); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2">
                {contextMenu.wp.locked ? <span className="w-4 h-4 text-center">‚úÖ</span> : <span className="w-4 h-4 text-center text-gray-300">‚òê</span>}
                üîí Termin fixiert
              </button>
              <button onClick={() => { setSelectedWPs([]); setSidebarWPId(contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><Settings className="w-4 h-4" /> Details bearbeiten</button>
              <button onClick={() => { showWPResourcePlanning(contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"><span className="w-4 h-4 flex items-center justify-center text-orange-600">üìä</span> Ressourcen-Feinplanung</button>
              <div className="border-t my-1" />
              <button onClick={() => { deleteWorkPackage(contextMenu.wp.id); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2"><Trash2 className="w-4 h-4" /> L√∂schen</button>
            </React.Fragment>}
            {contextMenu.type === 'gantt-bg' && <React.Fragment>
              <div className="px-3 py-1 text-xs text-gray-500 border-b">
                {new Date(contextMenu.date + 'T12:00:00').toLocaleDateString('de-DE', { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric' })}
              </div>
              <button onClick={() => { addWorkPackage(contextMenu.project.id, null, contextMenu.date); setContextMenu(null); }} className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2">
                <Plus className="w-4 h-4 text-green-600" /> Neues Arbeitspaket
              </button>
              <div className="border-t my-1" />
              <div className="px-3 py-1 text-xs text-gray-500">Tag hervorheben:</div>
              <div className="px-3 pb-2 flex flex-wrap gap-1">
                {['#fbbf24', '#34d399', '#60a5fa', '#f87171', '#c084fc', '#fb923c'].map(color => (
                  <button 
                    key={color} 
                    onClick={() => { 
                      saveHighlightedDays({ ...highlightedDays, [contextMenu.date]: color }); 
                      setContextMenu(null); 
                    }} 
                    className={`w-6 h-6 rounded border-2 ${highlightedDays[contextMenu.date] === color ? 'border-gray-800' : 'border-transparent'} hover:scale-110 transition-transform`} 
                    style={{ backgroundColor: color }} 
                  />
                ))}
                {highlightedDays[contextMenu.date] && (
                  <button 
                    onClick={() => { 
                      const next = {...highlightedDays}; delete next[contextMenu.date]; saveHighlightedDays(next); 
                      setContextMenu(null); 
                    }} 
                    className="w-6 h-6 rounded border-2 border-gray-300 hover:scale-110 transition-transform text-xs text-gray-400"
                  >‚úï</button>
                )}
              </div>
            </React.Fragment>}
          </div>}
          
          {/* Kontextmen√º f√ºr Tage (Feiertage/freie Tage) */}
          {dayContextMenu && (
            <div className="fixed bg-white rounded-lg shadow-xl border py-2 z-50 min-w-56" style={{ left: dayContextMenu.x, top: dayContextMenu.y }}>
              <div className="px-3 py-1 text-xs text-gray-500 border-b mb-1">
                {new Date(dayContextMenu.date).toLocaleDateString('de-DE', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' })}
              </div>
              {holidays[dayContextMenu.date] ? (
                <React.Fragment>
                  <div className="px-3 py-1.5 text-sm">
                    <div className="font-medium text-red-600">{holidays[dayContextMenu.date].name}</div>
                    <div className="text-xs text-gray-500">
                      {holidays[dayContextMenu.date].type === 'feiertag' ? 'üéâ Feiertag' : 
                       holidays[dayContextMenu.date].type === 'urlaub' ? 'üèñÔ∏è Urlaub' : 
                       holidays[dayContextMenu.date].type === 'betriebsferien' ? 'üè¢ Betriebsferien' : 'üìÖ Frei'}
                    </div>
                  </div>
                  <div className="border-t my-1" />
                  <button 
                    onClick={() => { setEditingHoliday({ date: dayContextMenu.date, ...holidays[dayContextMenu.date] }); setDayContextMenu(null); }}
                    className="w-full px-3 py-1.5 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
                  >
                    <span>‚úèÔ∏è</span> Bearbeiten
                  </button>
                  <button 
                    onClick={() => { const h = { ...holidays }; delete h[dayContextMenu.date]; saveHolidays(h); setDayContextMenu(null); }}
                    className="w-full px-3 py-1.5 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2"
                  >
                    <Trash2 className="w-4 h-4" /> Entfernen
                  </button>
                </React.Fragment>
              ) : (
                <React.Fragment>
                  <div className="px-3 pb-1 text-xs text-gray-400">Als frei markieren:</div>
                  <button 
                    onClick={() => { setEditingHoliday({ date: dayContextMenu.date, type: 'feiertag', name: '' }); setDayContextMenu(null); }}
                    className="w-full px-3 py-1.5 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
                  >
                    <span>üéâ</span> Feiertag
                  </button>
                  <button 
                    onClick={() => { setEditingHoliday({ date: dayContextMenu.date, type: 'urlaub', name: '' }); setDayContextMenu(null); }}
                    className="w-full px-3 py-1.5 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
                  >
                    <span>üèñÔ∏è</span> Urlaub
                  </button>
                  <button 
                    onClick={() => { setEditingHoliday({ date: dayContextMenu.date, type: 'betriebsferien', name: '' }); setDayContextMenu(null); }}
                    className="w-full px-3 py-1.5 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
                  >
                    <span>üè¢</span> Betriebsferien
                  </button>
                  <button 
                    onClick={() => { setEditingHoliday({ date: dayContextMenu.date, type: 'frei', name: '' }); setDayContextMenu(null); }}
                    className="w-full px-3 py-1.5 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
                  >
                    <span>üìÖ</span> Sonstiger freier Tag
                  </button>
                </React.Fragment>
              )}
            </div>
          )}
          
          {/* Workload-Kontextmen√º */}
          {workloadContextMenu && (
            <div className="fixed bg-white rounded-lg shadow-xl border py-1 z-50 min-w-52" style={{ left: workloadContextMenu.x, top: workloadContextMenu.y }} onClick={(e) => e.stopPropagation()}>
              <div className="px-3 py-1.5 text-xs text-gray-500 border-b truncate">
                <span className="font-medium text-gray-700">{workloadContextMenu.projectName}</span>
                <span className="mx-1 text-gray-400">‚Ä∫</span>
                <span>{workloadContextMenu.wpName}</span>
              </div>
              <button 
                onClick={() => { resetDailyOverrides(workloadContextMenu.wpId, workloadContextMenu.userId); setWorkloadContextMenu(null); }}
                className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"
              >
                <span>‚öñÔ∏è</span> Gleichm√§√üige Verteilung
              </button>
              <button 
                onClick={() => { scrollToWPInGantt(workloadContextMenu.wpId); setWorkloadContextMenu(null); }}
                className="w-full px-3 py-2 text-left text-sm hover:bg-blue-50 flex items-center gap-2"
              >
                <span>üîç</span> Im Gantt-Diagramm anzeigen
              </button>
              <button 
                onClick={() => { updateWorkPackage(workloadContextMenu.wpId, 'locked', !workloadContextMenu.locked); setWorkloadContextMenu(null); }}
                className="w-full px-3 py-2 text-left text-sm hover:bg-indigo-50 flex items-center gap-2"
              >
                {workloadContextMenu.locked ? <span>üîì</span> : <span>üîí</span>}
                {workloadContextMenu.locked ? 'Termin freigeben' : 'Termin fixieren'}
              </button>
              <button 
                onClick={() => { openSidebar(workloadContextMenu.wpId); setWorkloadContextMenu(null); }}
                className="w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
              >
                <span>üìã</span> Details √∂ffnen
              </button>
            </div>
          )}
          
          {/* Vacation-Typ-Picker */}
          {vacationTypePicker && (
            <div className="fixed bg-white rounded-lg shadow-xl border py-1 z-50 min-w-44" style={{ left: vacationTypePicker.x, top: vacationTypePicker.y }} onClick={(e) => e.stopPropagation()}>
              <div className="px-3 py-1.5 text-xs text-gray-500 border-b">
                {vacationTypePicker.dates.length} Tag{vacationTypePicker.dates.length > 1 ? 'e' : ''} markiert
              </div>
              <button 
                onClick={() => { setVacationBatch(vacationTypePicker.userId, vacationTypePicker.dates, 'add', 'urlaub'); setVacationTypePicker(null); }}
                className="w-full px-3 py-2 text-left text-sm hover:bg-orange-50 flex items-center gap-2"
              >
                <span>üèñÔ∏è</span> Urlaub
              </button>
              <button 
                onClick={() => { setVacationBatch(vacationTypePicker.userId, vacationTypePicker.dates, 'add', 'krank'); setVacationTypePicker(null); }}
                className="w-full px-3 py-2 text-left text-sm hover:bg-rose-50 flex items-center gap-2"
              >
                <span>ü§í</span> Krank
              </button>
              <button 
                onClick={() => { setVacationBatch(vacationTypePicker.userId, vacationTypePicker.dates, 'add', 'sonstige'); setVacationTypePicker(null); }}
                className="w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2"
              >
                <span>üìÖ</span> Sonstiges
              </button>
              {vacationTypePicker.hasExisting && (
                <React.Fragment>
                  <div className="border-t my-1" />
                  <button 
                    onClick={() => { setVacationBatch(vacationTypePicker.userId, vacationTypePicker.dates, 'remove'); setVacationTypePicker(null); }}
                    className="w-full px-3 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2"
                  >
                    <span>‚úï</span> Entfernen
                  </button>
                </React.Fragment>
              )}
            </div>
          )}
          
          {/* Dialog zum Bearbeiten/Erstellen eines freien Tages */}
          {editingHoliday && (
            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50" onClick={() => setEditingHoliday(null)}>
              <div className="bg-white rounded-xl shadow-2xl p-6 w-96" onClick={(e) => e.stopPropagation()}>
                <h3 className="text-lg font-bold mb-4">
                  {editingHoliday.type === 'feiertag' ? 'üéâ Feiertag' : 
                   editingHoliday.type === 'urlaub' ? 'üèñÔ∏è Urlaub' : 
                   editingHoliday.type === 'betriebsferien' ? 'üè¢ Betriebsferien' : 'üìÖ Freier Tag'}
                </h3>
                <div className="text-sm text-gray-500 mb-4">
                  {new Date(editingHoliday.date).toLocaleDateString('de-DE', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' })}
                </div>
                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-1">Bezeichnung</label>
                  <input 
                    type="text"
                    autoFocus
                    value={editingHoliday.name}
                    onChange={(e) => setEditingHoliday({ ...editingHoliday, name: e.target.value })}
                    placeholder={editingHoliday.type === 'feiertag' ? 'z.B. Rosenmontag' : editingHoliday.type === 'urlaub' ? 'z.B. Teamurlaub' : 'Bezeichnung eingeben...'}
                    className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                  />
                </div>
                <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-1">Typ</label>
                  <select 
                    value={editingHoliday.type}
                    onChange={(e) => setEditingHoliday({ ...editingHoliday, type: e.target.value })}
                    className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                  >
                    <option value="feiertag">üéâ Feiertag</option>
                    <option value="urlaub">üèñÔ∏è Urlaub</option>
                    <option value="betriebsferien">üè¢ Betriebsferien</option>
                    <option value="frei">üìÖ Sonstiger freier Tag</option>
                  </select>
                </div>
                <div className="flex justify-end gap-2">
                  <button 
                    onClick={() => setEditingHoliday(null)}
                    className="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg"
                  >
                    Abbrechen
                  </button>
                  <button 
                    onClick={() => {
                      if (editingHoliday.name.trim()) {
                        saveHolidays({ ...holidays, [editingHoliday.date]: { type: editingHoliday.type, name: editingHoliday.name.trim() } });
                        setEditingHoliday(null);
                      }
                    }}
                    disabled={!editingHoliday.name.trim()}
                    className="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"
                  >
                    Speichern
                  </button>
                </div>
              </div>
            </div>
          )}
          
          {/* ========== WORKLOAD PANEL ========== */}
          {workloadPanelHeight > 0 && (
            <div className="flex-shrink-0 bg-white flex flex-col" style={{ height: workloadPanelHeight, border: wlFocusWP ? `3px solid ${wlFocusWP.color}` : '2px solid #d4d4d4', borderTop: wlFocusWP ? `3px solid ${wlFocusWP.color}` : '2px solid #d4d4d4', borderRadius: wlFocusWP ? 4 : 0 }}>
              {/* Dynamic font scaling for workload panel */}
              <style dangerouslySetInnerHTML={{ __html: `
                .wl-content { font-size: ${wlFontSize}px !important; }
                .wl-content .wl-t-sm, .wl-content .wl-t-xs, .wl-content .wl-t-xxs, .wl-content .wl-t-tiny { font-size: ${wlFontSize}px !important; }
                .wl-content .wl-icon { font-size: ${Math.max(wlFontSize - 1, 8)}px !important; }
                .wl-content .wl-separator { height: 2px; background: #e0e0e0; border: none; flex-shrink: 0; }
              `}} />
              {/* Resize Handle */}
              <div 
                className="h-1.5 cursor-ns-resize transition-colors flex-shrink-0 flex items-center justify-center bg-indigo-100 hover:bg-indigo-200"
                onMouseDown={(e) => {
                  e.preventDefault();
                  const startY = e.clientY;
                  const startH = workloadPanelHeight;
                  const onMove = (ev) => {
                    const diff = startY - ev.clientY;
                    setWorkloadPanelHeight(Math.max(80, Math.min(500, startH + diff)));
                  };
                  const onUp = () => { document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); };
                  document.addEventListener('mousemove', onMove);
                  document.addEventListener('mouseup', onUp);
                }}
              >
                <div className="w-8 h-0.5 bg-indigo-400 rounded" />
              </div>
              {/* Header with filter tabs */}
              <div className="flex items-center justify-between px-3 py-1 bg-white border-b flex-shrink-0">
                <div className="flex items-center gap-1">
                  {[
                    { key: 'bereiche', label: 'Bereiche' },
                    { key: 'abteilungen', label: 'Abteilungen' },
                    { key: 'teams', label: 'Teams' },
                    { key: 'mitarbeiter', label: 'Mitarbeiter' },
                    { key: 'ressourcen', label: 'Ressourcen' },
                  ].map(f => (
                    <button key={f.key} onClick={() => { setWorkloadFilter(f.key); setWlFocusWP(null); }} className={`text-[10px] px-2 py-0.5 rounded font-medium ${workloadFilter === f.key ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-500 hover:bg-gray-200'}`}>
                      {f.label}
                    </button>
                  ))}
                  <div className="w-px h-4 bg-gray-200 mx-1" />
                  <button onClick={() => setWorkloadZoom(z => Math.max(70, z - 10))} className="w-5 h-5 rounded bg-gray-100 hover:bg-gray-200 text-gray-600 text-xs font-bold flex items-center justify-center" title="Zeilen verkleinern">‚àí</button>
                  <span className="text-[10px] text-gray-500 w-7 text-center">{workloadZoom}%</span>
                  <button onClick={() => setWorkloadZoom(z => Math.min(150, z + 10))} className="w-5 h-5 rounded bg-gray-100 hover:bg-gray-200 text-gray-600 text-xs font-bold flex items-center justify-center" title="Zeilen vergr√∂√üern">+</button>
                  <div className="w-px h-4 bg-gray-200 mx-1" />
                  <span className="text-[9px] text-gray-400">Aa</span>
                  <input type="range" min="8" max="14" value={wlFontSize} onChange={(e) => setWlFontSize(Number(e.target.value))} className="w-12 h-3 accent-indigo-500" title={`Schriftgr√∂√üe: ${wlFontSize}px`} />
                  <span className="text-[9px] text-gray-500 w-5">{wlFontSize}</span>
                  <div className="w-px h-4 bg-gray-200 mx-1" />
                  <span className="text-[9px] text-gray-400" title="Dezimalstellen">.</span>
                  {[0,1,2].map(d => (
                    <button key={d} onClick={() => setWlDecimals(d)} className={`w-4 h-4 rounded text-[9px] font-medium flex items-center justify-center ${wlDecimals === d ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-500 hover:bg-gray-200'}`} title={`${d} Dezimalstellen`}>{d}</button>
                  ))}
                </div>
                <button onClick={() => setWorkloadPanelHeight(0)} className="text-gray-400 hover:text-gray-600 text-sm">‚úï</button>
              </div>
              {/* Content */}
              <div className="wl-content flex flex-1 overflow-hidden">
                {/* Left: Names ‚Äî SAME width as gantt left panel, no separate resize */}
                <div data-panel-list className="flex-shrink-0 border-r bg-white overflow-y-auto hide-scrollbar" ref={workloadLeftRef} style={{ width: leftPanelWidth }} onScroll={(e) => { window._workloadScroll.top = e.target.scrollTop; if (workloadScrollRef.current && workloadScrollRef.current.scrollTop !== e.target.scrollTop) workloadScrollRef.current.scrollTop = e.target.scrollTop; }}>
                  {(() => {
                    const rows = [];
                    const WLR = Math.round(ROW_HEIGHT * workloadZoom / 100);
                    const wlFmt = (v) => { const s = v.toFixed(wlDecimals); return wlDecimals === 0 ? s : s.replace(/\.?0+$/, '') || '0'; };
                    
                    // Focus-Banner bei Feinplanung
                    if (wlFocusWP && workloadFilter === 'mitarbeiter') {
                      const focusWP = workPackages.find(w => w.id === wlFocusWP.wpId);
                      const focusProject = focusWP ? projects.find(p => p.id === focusWP.projectId) : null;
                      rows.push(
                        <div key="_focus" className="flex items-center gap-2 px-3 py-1.5 border-b flex-shrink-0" style={{ backgroundColor: wlFocusWP.color + '18', borderColor: wlFocusWP.color + '40', minHeight: WLR }}>
                          <div className="w-3 h-3 rounded-sm flex-shrink-0" style={{ backgroundColor: wlFocusWP.color }} />
                          <div className="flex flex-col min-w-0 flex-1">
                            <span className="truncate font-semibold" style={{ color: '#333333', fontSize: 11 }}>{wlFocusWP.wpName}</span>
                            {focusProject && <span className="truncate" style={{ color: '#777777', fontSize: 9 }}>{focusProject.name}</span>}
                          </div>
                          <button onClick={() => setWlFocusWP(null)} className="flex-shrink-0 w-5 h-5 rounded flex items-center justify-center hover:bg-black/10" style={{ color: '#555555', fontSize: 12 }} title="Filter aufheben">‚úï</button>
                        </div>
                      );
                    }
                    
                    if (workloadFilter === 'bereiche') {
                      departments.sort((a,b) => a.name.localeCompare(b.name)).forEach(dept => {
                        const deptDivs = divisions.filter(d => d.departmentId === dept.id);
                        const deptTeams = teams.filter(t => deptDivs.some(d => d.id === t.divisionId));
                        const deptUsers = users.filter(u => u.role !== 'admin' && deptTeams.some(t => t.id === u.teamId));
                        rows.push(
                          <div key={dept.id} className="flex items-center gap-1.5 px-2 py-1 bg-slate-100 border-b wl-t-sm text-[11px] font-semibold text-slate-700" style={{ height: WLR }}>
                            <div className="w-2 h-2 rounded-full bg-slate-500 flex-shrink-0" />
                            <span className="truncate">{dept.name}</span>
                            <span className="wl-t-xs text-[10px] text-slate-400 ml-auto">{deptUsers.length}P</span>
                          </div>
                        );
                      });
                    } else if (workloadFilter === 'abteilungen') {
                      divisions.sort((a,b) => a.name.localeCompare(b.name)).forEach(div => {
                        const divTeams = teams.filter(t => t.divisionId === div.id);
                        const divUsers = users.filter(u => u.role !== 'admin' && divTeams.some(t => t.id === u.teamId));
                        if (divUsers.length === 0) return;
                        rows.push(
                          <div key={div.id} className="flex items-center gap-1.5 px-2 py-1 bg-blue-50 border-b wl-t-sm text-[11px] font-semibold text-blue-700" style={{ height: WLR }}>
                            <div className="w-1.5 h-1.5 rounded-full bg-blue-500 flex-shrink-0" />
                            <span className="truncate">{div.name}</span>
                            <span className="wl-t-xs text-[10px] text-stone-400 ml-auto">{divUsers.length}P</span>
                          </div>
                        );
                      });
                    } else if (workloadFilter === 'teams') {
                      teams.sort((a,b) => a.name.localeCompare(b.name)).forEach(team => {
                        const teamUsers = users.filter(u => u.role !== 'admin' && u.teamId === team.id);
                        if (teamUsers.length === 0) return;
                        rows.push(
                          <div key={team.id} className="flex items-center gap-1.5 px-2 py-1 bg-indigo-50 border-b wl-t-sm text-[11px] font-semibold text-indigo-700" style={{ height: WLR }}>
                            <div className="w-1.5 h-1.5 rounded-full bg-indigo-500 flex-shrink-0" />
                            <span className="truncate">{team.name}</span>
                            <span className="wl-t-xs text-[10px] text-stone-400 ml-auto">{teamUsers.length}P</span>
                          </div>
                        );
                      });
                    } else if (workloadFilter === 'mitarbeiter') {
                      // Helper: Tree-Line Connector
                      const TreeLines = ({ level, isLast, parentLines }) => (
                        <div className="flex items-center h-full flex-shrink-0" style={{ width: level * 16 }}>
                          {Array.from({ length: level }).map((_, lvl) => {
                            const isConnector = lvl === level - 1;
                            const showContinuation = parentLines[lvl]; // ancestor still has siblings
                            return (
                              <div key={lvl} className="relative h-full flex-shrink-0" style={{ width: 16 }}>
                                {isConnector ? (
                                  <React.Fragment>
                                    <div className="absolute left-2 top-0" style={{ width: 1, height: isLast ? '50%' : '100%', backgroundColor: '#cccccc' }} />
                                    <div className="absolute left-2 top-1/2" style={{ width: 8, height: 1, backgroundColor: '#cccccc' }} />
                                  </React.Fragment>
                                ) : (
                                  showContinuation && <div className="absolute left-2 top-0 bottom-0" style={{ width: 1, backgroundColor: '#cccccc' }} />
                                )}
                              </div>
                            );
                          })}
                        </div>
                      );

                      const toggleGroup = (key) => { const sL = workloadLeftRef.current?.scrollTop; const sR = workloadScrollRef.current?.scrollTop; setWorkloadExpandedGroups(prev => ({...prev, [key]: prev[key] === false ? true : (prev[key] === undefined ? false : !prev[key])})); requestAnimationFrame(() => { if (workloadLeftRef.current && sL !== undefined) workloadLeftRef.current.scrollTop = sL; if (workloadScrollRef.current && sR !== undefined) workloadScrollRef.current.scrollTop = sR; }); };
                      const isGroupExp = (key) => workloadExpandedGroups[key] !== false;
                      
                      const renderUserWithWPs = (u, level, isLastUser, parentLines) => {
                        const userWPs = getUserWorkPackages(u.id);
                        const isUserExp = workloadExpandedUsers[u.id];
                        const wpCount = userWPs.length;
                        const userParentLines = [...parentLines.slice(0, level - 1), !isLastUser];
                        rows.push(
                          <div key={u.id} className={`flex items-center gap-1 pr-2 py-1 border-b wl-t-sm font-medium ${wpCount > 0 ? 'cursor-pointer' : ''} relative`} style={{ height: WLR, backgroundColor: '#f4f4f4', borderColor: '#e8e8e8', color: '#333333' }} onClick={() => { if (wpCount > 0) { const scrollL = workloadLeftRef.current?.scrollTop; const scrollR = workloadScrollRef.current?.scrollTop; setWorkloadExpandedUsers(prev => ({...prev, [u.id]: !prev[u.id]})); requestAnimationFrame(() => { if (workloadLeftRef.current && scrollL !== undefined) workloadLeftRef.current.scrollTop = scrollL; if (workloadScrollRef.current && scrollR !== undefined) workloadScrollRef.current.scrollTop = scrollR; }); } }}>
                            <TreeLines level={level} isLast={isLastUser} parentLines={parentLines} />
                            {wpCount > 0 && <span className="wl-t-tiny flex-shrink-0" style={{ color: '#999999' }}>{isUserExp ? '‚ñº' : '‚ñ∂'}</span>}
                            {wpCount === 0 && <span style={{ width: 8 }} className="flex-shrink-0" />}
                            <span className="truncate">{u.name}</span>
                            {wpCount > 0 && <span className="wl-t-xxs ml-auto flex-shrink-0" style={{ color: '#999999' }}>{wpCount} AP</span>}
                          </div>
                        );
                        if (isUserExp) {
                          const wpLevel = level + 1;
                          const wpParentLines = [...parentLines, !isLastUser];
                          userWPs.forEach((wp, wpIdx) => {
                            const project = projects.find(p => p.id === wp.projectId);
                            const isLastWP = wpIdx === userWPs.length - 1;
                            const wpColor = wp.color || project?.color || '#6366f1';
                            rows.push(
                              <div key={u.id + '_' + wp.id} className="flex items-center gap-0 pr-2 py-0 border-b wl-t-xs relative" style={{ height: WLR, backgroundColor: '#fafafa', borderColor: '#f0f0f0', color: '#555555' }}>
                                <TreeLines level={wpLevel} isLast={isLastWP} parentLines={wpParentLines} />
                                <div className="flex items-center gap-1.5 flex-1 min-w-0">
                                  <div className="w-2.5 h-2.5 rounded-sm flex-shrink-0" style={{ backgroundColor: wpColor }} />
                                  <span className="truncate">{wp.name}</span>
                                  {wp.locked && <span className="text-orange-500 flex-shrink-0" title="Termin fixiert">üîí</span>}
                                  <span className="wl-t-tiny ml-auto flex-shrink-0" style={{ color: '#999999' }}>{getUserHours([...(wp.responsibles || []), ...(wp.editors || [])], u.id)}h</span>
                                </div>
                              </div>
                            );
                          });
                        }
                        rows.push(<div key={u.id + '_sep'} className="wl-separator" />);
                      };

                      // Focus-Mode: Nur beteiligte Mitarbeiter anzeigen
                      if (wlFocusWP) {
                        const focusUsers = users.filter(u => wlFocusWP.userIds.includes(u.id)).sort((a,b) => a.name.localeCompare(b.name));
                        focusUsers.forEach((u, uIdx) => {
                          renderUserWithWPs(u, 0, uIdx === focusUsers.length - 1, []);
                        });
                      } else {
                      // Full hierarchy: Bereich ‚Üí Abteilung ‚Üí Team ‚Üí Mitarbeiter
                      const activeDepts = departments.filter(dept => {
                        const deptDivisions = divisions.filter(d => d.departmentId === dept.id);
                        return users.some(u => u.role !== 'admin' && teams.some(t => t.id === u.teamId && deptDivisions.some(d => d.id === t.divisionId)));
                      }).sort((a,b) => a.name.localeCompare(b.name));
                      
                      activeDepts.forEach((dept, deptIdx) => {
                        const deptDivisions = divisions.filter(d => d.departmentId === dept.id);
                        const deptAllUsers = users.filter(u => u.role !== 'admin' && teams.some(t => t.id === u.teamId && deptDivisions.some(d => d.id === t.divisionId)));
                        const deptKey = 'wl_dept_' + dept.id;
                        const deptExp = isGroupExp(deptKey);
                        const isLastDept = deptIdx === activeDepts.length - 1;
                        rows.push(
                          <div key={deptKey} className="flex items-center gap-1 px-2 py-1 border-b cursor-pointer font-bold" style={{ height: WLR, backgroundColor: '#dcdcdc', borderColor: '#d0d0d0', color: '#444444' }} onClick={() => toggleGroup(deptKey)}>
                            <span style={{ color: '#888888' }}>{deptExp ? '‚ñº' : '‚ñ∂'}</span>
                            <span className="truncate">{dept.name}</span>
                            <span className="ml-auto font-normal" style={{ color: '#888888' }}>{deptAllUsers.length} MA</span>
                          </div>
                        );
                        if (deptExp) {
                          const activeDivisions = deptDivisions.filter(d => {
                            const divTeams = teams.filter(t => t.divisionId === d.id);
                            return users.some(u => u.role !== 'admin' && divTeams.some(t => t.id === u.teamId));
                          }).sort((a,b) => a.name.localeCompare(b.name));
                          
                          activeDivisions.forEach((div, divIdx) => {
                            const divTeams = teams.filter(t => t.divisionId === div.id);
                            const divAllUsers = users.filter(u => u.role !== 'admin' && divTeams.some(t => t.id === u.teamId));
                            if (divAllUsers.length === 0) return;
                            const divKey = 'wl_' + div.id;
                            const divExp = isGroupExp(divKey);
                            const isLastDiv = divIdx === activeDivisions.length - 1;
                            rows.push(
                              <div key={divKey} className="flex items-center gap-1 pr-2 py-1 border-b cursor-pointer font-semibold relative" style={{ height: WLR, backgroundColor: '#e2e2e2', borderColor: '#d4d4d4', color: '#444444' }} onClick={() => toggleGroup(divKey)}>
                                <TreeLines level={1} isLast={isLastDiv} parentLines={[]} />
                                <span style={{ color: '#999999' }}>{divExp ? '‚ñº' : '‚ñ∂'}</span>
                                <span className="truncate">{div.name}</span>
                                <span className="ml-auto font-normal" style={{ color: '#999999' }}>{divAllUsers.length} MA</span>
                              </div>
                            );
                            if (divExp) {
                              const activeTeams = divTeams.filter(t => users.some(u => u.role !== 'admin' && u.teamId === t.id)).sort((a,b) => a.name.localeCompare(b.name));
                              
                              activeTeams.forEach((team, teamIdx) => {
                                const teamUsers = users.filter(u => u.role !== 'admin' && u.teamId === team.id);
                                if (teamUsers.length === 0) return;
                                const teamKey = 'wl_team_' + team.id;
                                const teamExp = isGroupExp(teamKey);
                                const isLastTeam = teamIdx === activeTeams.length - 1;
                                const teamParentLines = [!isLastDiv];
                                rows.push(
                                  <div key={teamKey} className="flex items-center gap-1 pr-2 py-1 border-b cursor-pointer font-medium relative" style={{ height: WLR, backgroundColor: '#ececec', borderColor: '#e0e0e0', color: '#555555' }} onClick={() => toggleGroup(teamKey)}>
                                    <TreeLines level={2} isLast={isLastTeam} parentLines={teamParentLines} />
                                    <span style={{ color: '#aaaaaa' }}>{teamExp ? '‚ñº' : '‚ñ∂'}</span>
                                    <span className="truncate">{team.name}</span>
                                    <span className="ml-auto font-normal" style={{ color: '#aaaaaa' }}>{teamUsers.length} MA</span>
                                  </div>
                                );
                                if (teamExp) {
                                  const userParentLines = [!isLastDiv, !isLastTeam];
                                  teamUsers.sort((a,b) => a.name.localeCompare(b.name)).forEach((u, uIdx) => {
                                    renderUserWithWPs(u, 3, uIdx === teamUsers.length - 1, userParentLines);
                                  });
                                }
                              });
                            }
                          });
                        }
                      });
                      
                      // Orphan users (no team or team not in any division/department)
                      const assignedUserIds = new Set();
                      departments.forEach(dept => {
                        divisions.filter(d => d.departmentId === dept.id).forEach(div => {
                          teams.filter(t => t.divisionId === div.id).forEach(team => {
                            users.filter(u => u.role !== 'admin' && u.teamId === team.id).forEach(u => assignedUserIds.add(u.id));
                          });
                        });
                      });
                      const orphans = users.filter(u => u.role !== 'admin' && !assignedUserIds.has(u.id));
                      if (orphans.length > 0) {
                        const orphKey = 'wl_orphan';
                        const orphExp = isGroupExp(orphKey);
                        rows.push(
                          <div key="_orph" className="flex items-center gap-1 px-2 py-1 border-b cursor-pointer font-semibold" style={{ height: WLR, backgroundColor: '#ececec', borderColor: '#e0e0e0', color: '#555555' }} onClick={() => toggleGroup(orphKey)}>
                            <span style={{ color: '#aaaaaa' }}>{orphExp ? '‚ñº' : '‚ñ∂'}</span>
                            <span>Nicht zugeordnet</span>
                            <span className="ml-auto font-normal" style={{ color: '#aaaaaa' }}>{orphans.length} MA</span>
                          </div>
                        );
                        if (orphExp) orphans.sort((a,b) => a.name.localeCompare(b.name)).forEach((u, uIdx) => renderUserWithWPs(u, 1, uIdx === orphans.length - 1, []));
                      }
                      } // end else (non-focus mode)
                    } else if (workloadFilter === 'ressourcen') {
                      const typeGroups = [
                        { type: 'maschine', label: 'üè≠ Maschinen', bgClass: 'bg-blue-50 hover:bg-blue-100 text-blue-700', countClass: 'text-blue-400' },
                        { type: 'fahrzeug', label: 'üöõ Fahrzeuge', bgClass: 'bg-green-50 hover:bg-green-100 text-green-700', countClass: 'text-green-400' },
                        { type: 'werkzeug', label: 'üîß Werkzeuge', bgClass: 'bg-amber-50 hover:bg-amber-100 text-amber-700', countClass: 'text-amber-400' },
                      ];
                      typeGroups.forEach(tg => {
                        const grouped = resources.filter(r => r.type === tg.type);
                        if (grouped.length === 0) return;
                        const isExp = workloadExpandedGroups['wl_res_' + tg.type] !== false;
                        rows.push(
                          <div key={'rg_' + tg.type} className={`flex items-center gap-1 px-2 py-1 border-b cursor-pointer wl-t-xs text-[10px] font-semibold ${tg.bgClass}`} style={{ height: WLR }} onClick={() => { const sL = workloadLeftRef.current?.scrollTop; const sR = workloadScrollRef.current?.scrollTop; setWorkloadExpandedGroups({...workloadExpandedGroups, ['wl_res_' + tg.type]: !isExp}); requestAnimationFrame(() => { if (workloadLeftRef.current && sL !== undefined) workloadLeftRef.current.scrollTop = sL; if (workloadScrollRef.current && sR !== undefined) workloadScrollRef.current.scrollTop = sR; }); }}>
                            <span className="text-gray-400">{isExp ? '‚ñº' : '‚ñ∂'}</span>
                            <span>{tg.label}</span>
                            <span className={`${tg.countClass} ml-auto`}>{grouped.length}</span>
                          </div>
                        );
                        if (isExp) grouped.sort((a,b) => a.name.localeCompare(b.name)).forEach(r => {
                          rows.push(
                            <div key={r.id} className="flex items-center gap-1.5 px-3 py-1 border-b border-gray-100 wl-t-sm text-[11px] text-gray-700" style={{ height: WLR }}>
                              {r.kuerzel && <span className="wl-t-xxs text-[9px] px-1 py-0.5 rounded bg-gray-100 font-mono flex-shrink-0">{r.kuerzel}</span>}
                              <span className="truncate">{r.name}</span>
                              {r.schichtmodell > 1 && <span className="wl-t-xxs text-[9px] text-gray-400 ml-auto">{r.schichtmodell}S</span>}
                            </div>
                          );
                        });
                      });
                    }
                    
                    return rows;
                  })()}
                </div>
                {/* Right: IDENTICAL to headerScrollRef ‚Äî proven pattern that syncs perfectly */}
                <div 
                  ref={workloadScrollRef}
                  className="flex-1 overflow-auto hide-scrollbar"
                  onScroll={(e) => {
                    // Bidirectional horizontal sync (same as header)
                    if (ganttHScrollRef.current && ganttHScrollRef.current.scrollLeft !== e.target.scrollLeft) {
                      ganttHScrollRef.current.scrollLeft = e.target.scrollLeft;
                    }
                    if (headerScrollRef.current && headerScrollRef.current.scrollLeft !== e.target.scrollLeft) {
                      headerScrollRef.current.scrollLeft = e.target.scrollLeft;
                    }
                    window._ganttScrollLeft.value = e.target.scrollLeft;
                    // Vertical sync to left names
                    if (workloadLeftRef.current) workloadLeftRef.current.scrollTop = e.target.scrollTop;
                    window._workloadScroll.top = e.target.scrollTop;
                  }}
                >
                  <div style={{ minWidth: ganttContentWidth, position: 'relative' }}>
                      {/* Today line */}
                      {(() => {
                        const todayStr = formatDate(new Date());
                        const todayIdx = allDays.findIndex(d => formatDate(d) === todayStr);
                        if (todayIdx >= 0) {
                          const todayX = todayIdx * DAY_WIDTH + Math.floor(DAY_WIDTH / 2) - 1;
                          return <div className="absolute top-0 bottom-0 pointer-events-none" style={{ left: todayX, width: 2, backgroundColor: '#ef4444', zIndex: 3 }} />;
                        }
                        return null;
                      })()}
                      {(() => {
                      const gridRows = [];
                      const WLR = Math.round(ROW_HEIGHT * workloadZoom / 100);
                      const wlFmt = (v) => { const s = v.toFixed(wlDecimals); return wlDecimals === 0 ? s : s.replace(/\.?0+$/, '') || '0'; };
                      
                      const renderUserRow = (u, key) => (
                        <div key={key || u.id} className="flex border-b" style={{ height: WLR, backgroundColor: '#f4f4f4', borderColor: '#e8e8e8' }}>
                          {allDays.map((day, i) => {
                            const ds = formatDate(day);
                            const dow = day.getDay();
                            const isWE = dow === 0 || dow === 6;
                            const isHol = holidays[ds];
                            const isToday = ds === formatDate(new Date());
                            const isVac = isVacation(u.id, day);
                            const vacType = isVac ? getVacationType(u.id, day) : null;
                            const data = calculateWorkload[u.id]?.[ds];
                            const hours = data?.total || 0;
                            const dailyCapacity = isVac ? 0 : getDailyHours(u, day);
                            const ratio = dailyCapacity > 0 ? hours / dailyCapacity : (hours > 0 && isVac ? 2 : 0);
                            
                            // Drag-Selection highlight
                            const isDragSelected = vacationDrag && vacationDrag.userId === u.id && vacationDrag.endIdx !== undefined &&
                              i >= Math.min(vacationDrag.startIdx, vacationDrag.endIdx) && i <= Math.max(vacationDrag.startIdx, vacationDrag.endIdx) && !isWE;
                            
                            // Type-specific styling
                            const vacColors = { urlaub: 'bg-orange-100', krank: 'bg-rose-100', sonstige: 'bg-slate-100' };
                            const vacIcons = { urlaub: 'üèñÔ∏è', krank: 'ü§í', sonstige: 'üìÖ' };
                            
                            let bg = '';
                            const vacConflict = isVac && !isWE && hours > 0;
                            if (isDragSelected) bg = 'bg-indigo-100';
                            else if (vacConflict) bg = 'bg-red-200';
                            else if (isVac && !isWE) bg = vacColors[vacType] || 'bg-orange-100';
                            else if (isToday) bg = 'bg-red-50';
                            else if (isHol) bg = 'bg-red-100';
                            else if (isWE) bg = 'bg-gray-200';
                            else if (hours > 0 && ratio > 1) bg = 'bg-red-100';
                            else if (hours > 0 && ratio > 0.8) bg = 'bg-amber-50';
                            else if (hours > 0) bg = 'bg-green-50';
                            const textColor = isVac && !isWE ? 'text-orange-500' : ratio > 1 ? 'text-red-600 font-bold' : ratio > 0.8 ? 'text-orange-600' : hours > 0 ? 'text-green-700' : 'text-gray-300';
                            
                            return (
                              <div 
                                key={i} 
                                data-vac-idx={i}
                                data-vac-user-id={u.id}
                                className={`flex-shrink-0 border-r text-center wl-t-xxs text-[9px] flex items-center justify-center ${bg} ${!isWE ? 'cursor-cell' : 'cursor-default'} select-none`} 
                                style={{ width: DAY_WIDTH, height: WLR }} 
                                title={isVac ? `${vacIcons[vacType] || 'üèñÔ∏è'} ${vacType === 'krank' ? 'Krank' : vacType === 'sonstige' ? 'Sonstiges' : 'Urlaub'} ‚Äì ${u.name}` : data?.details?.map(d => `${d.wpName}: ${d.hours.toFixed(1)}h`).join('\n') || `${u.name} - ${ds}`}
                                onMouseDown={(e) => {
                                  if (e.button !== 0 || isWE) return;
                                  e.preventDefault();
                                  setVacationDrag({ userId: u.id, startIdx: i, endIdx: i });
                                }}
                                onContextMenu={(e) => {
                                  if (isWE) return;
                                  e.preventDefault();
                                  setVacationTypePicker({ x: e.clientX, y: e.clientY, userId: u.id, dates: [ds], hasExisting: isVac });
                                }}
                              >
                                {isVac && !isWE && hours > 0 ? (
                                  <span className="wl-icon" style={{ fontSize: 9 }} title={`‚ö†Ô∏è ${hours.toFixed(1)}h geplant aber ${vacType === 'krank' ? 'krank' : vacType === 'sonstige' ? 'abwesend' : 'Urlaub'}!\n` + (data?.details?.map(d => `${d.wpName}: ${d.hours.toFixed(1)}h`).join('\n') || '')}>‚ö†Ô∏è</span>
                                ) : isVac && !isWE ? (
                                  <span className="wl-icon" style={{ fontSize: 9 }}>{vacIcons[vacType] || 'üèñÔ∏è'}</span>
                                ) : hours > 0 ? (
                                  <span className={`wl-t-xxs ${textColor}`}>{wlFmt(hours)}</span>
                                ) : null}
                              </div>
                            );
                          })}
                        </div>
                      );
                      
                      const renderGroupRow = (userGroup, bgClass, key, rowStyle) => (
                        <div key={key} className={`flex border-b ${bgClass}`} style={{ height: WLR, ...rowStyle }}>
                          {allDays.map((day, i) => {
                            const ds = formatDate(day);
                            const dow = day.getDay();
                            const isWE = dow === 0 || dow === 6;
                            const isHol = holidays[ds];
                            const isToday = ds === formatDate(new Date());
                            const total = userGroup.reduce((sum, u) => sum + (calculateWorkload[u.id]?.[ds]?.total || 0), 0);
                            const totalCap = userGroup.reduce((sum, u) => sum + getDailyHours(u, day), 0);
                            const ratio = totalCap > 0 ? total / totalCap : 0;
                            const textColor = ratio > 1 ? 'text-red-600 font-bold' : total > 0 ? 'text-gray-700 font-medium' : '';
                            
                            return <div key={i} className={`flex-shrink-0 border-r text-center wl-t-tiny text-[8px] flex items-center justify-center ${isToday ? 'bg-red-50/50' : isHol ? 'bg-red-100/50' : isWE ? 'bg-gray-200/50' : ''}`} style={{ width: DAY_WIDTH, height: WLR }}>
                              {total > 0 && <span className={`wl-t-tiny ${textColor}`}>{wlFmt(total)}</span>}
                            </div>;
                          })}
                        </div>
                      );
                      
                      if (workloadFilter === 'bereiche') {
                        departments.sort((a,b) => a.name.localeCompare(b.name)).forEach(dept => {
                          const deptDivs = divisions.filter(d => d.departmentId === dept.id);
                          const deptTeams = teams.filter(t => deptDivs.some(d => d.id === t.divisionId));
                          const deptUsers = users.filter(u => u.role !== 'admin' && deptTeams.some(t => t.id === u.teamId));
                          gridRows.push(renderGroupRow(deptUsers, 'bg-slate-100', dept.id));
                        });
                      } else if (workloadFilter === 'abteilungen') {
                        divisions.sort((a,b) => a.name.localeCompare(b.name)).forEach(div => {
                          const divTeams = teams.filter(t => t.divisionId === div.id);
                          const divUsers = users.filter(u => u.role !== 'admin' && divTeams.some(t => t.id === u.teamId));
                          if (divUsers.length === 0) return;
                          gridRows.push(renderGroupRow(divUsers, 'bg-blue-50', div.id));
                        });
                      } else if (workloadFilter === 'teams') {
                        teams.sort((a,b) => a.name.localeCompare(b.name)).forEach(team => {
                          const teamUsers = users.filter(u => u.role !== 'admin' && u.teamId === team.id);
                          if (teamUsers.length === 0) return;
                          gridRows.push(renderGroupRow(teamUsers, '', team.id));
                        });
                      } else if (workloadFilter === 'mitarbeiter') {
                        // WP-Balken-Zeile f√ºr einen User
                        const renderWPBarRow = (u, wp) => {
                          const project = projects.find(p => p.id === wp.projectId);
                          const barColor = wp.color || project?.color || '#6366f1';
                          const wpStart = wp.startDate;
                          const wpEnd = wp.endDate;
                          const workDays = getWPWorkDays(wp);
                          const activeDays = getActiveDaysForWP(wp, u.id);
                          const totalHours = getUserHours([...(wp.responsibles || []), ...(wp.editors || [])], u.id);
                          const hoursPerActiveDay = activeDays.length > 0 ? totalHours / activeDays.length : 0;
                          const hasOverrides = !!wp.dailyOverrides?.[u.id];
                          
                          return (
                            <div key={u.id + '_wp_' + wp.id} className="flex border-b border-gray-50 relative" style={{ height: WLR, backgroundColor: 'transparent' }}
                              onContextMenu={(e) => {
                                e.preventDefault();
                                setWorkloadContextMenu({ x: e.clientX, y: e.clientY, wpId: wp.id, userId: u.id, wpName: wp.name, projectName: project?.name, locked: wp.locked });
                              }}
                            >
                              {allDays.map((day, i) => {
                                const ds = formatDate(day);
                                const dow = day.getDay();
                                const isWE = dow === 0 || dow === 6;
                                const isHol = holidays[ds];
                                const isToday = ds === formatDate(new Date());
                                const inRange = ds >= wpStart && ds <= wpEnd;
                                const isWorkDay = workDays.includes(ds);
                                const isActive = activeDays.includes(ds);
                                const isFirst = ds === wpStart;
                                const isLast = ds === wpEnd;
                                const isVac = isVacation(u.id, day);
                                const vacConflict = inRange && isWorkDay && isActive && isVac;
                                
                                // Hintergrund
                                let bg = '';
                                let cellStyle = { width: DAY_WIDTH, height: WLR };
                                
                                if (vacConflict) {
                                  cellStyle.backgroundColor = '#fef2f2'; // red-50
                                } else if (inRange && isWorkDay && isActive) {
                                  cellStyle.backgroundColor = barColor + '40';
                                } else if (inRange && isWorkDay && !isActive) {
                                  bg = 'bg-white';
                                } else if (isToday) {
                                  bg = 'bg-red-50';
                                } else if (isHol) {
                                  bg = 'bg-red-100/50';
                                } else if (isWE) {
                                  bg = 'bg-gray-200/50';
                                }
                                
                                // Border
                                let borderStyle = {};
                                if (inRange && isWorkDay) {
                                  const bColor = vacConflict ? '#ef4444' : barColor;
                                  borderStyle.borderTop = `2px solid ${bColor}`;
                                  borderStyle.borderBottom = `2px solid ${bColor}`;
                                  if (isFirst || (i > 0 && formatDate(allDays[i-1]) < wpStart)) { borderStyle.borderLeft = `2px solid ${bColor}`; borderStyle.borderTopLeftRadius = 4; borderStyle.borderBottomLeftRadius = 4; }
                                  if (isLast || (i < allDays.length - 1 && formatDate(allDays[i+1]) > wpEnd)) { borderStyle.borderRight = `2px solid ${bColor}`; borderStyle.borderTopRightRadius = 4; borderStyle.borderBottomRightRadius = 4; }
                                } else if (inRange && (isWE || isHol)) {
                                  borderStyle.borderTop = `1px dashed ${barColor}50`;
                                  borderStyle.borderBottom = `1px dashed ${barColor}50`;
                                }
                                
                                // Label nach dem letzten Tag des Balkens
                                const showLabel = isLast;
                                
                                return (
                                  <div 
                                    key={i} 
                                    className={`flex-shrink-0 border-r text-center wl-t-tiny text-[8px] flex items-center justify-center ${bg} ${isWorkDay && inRange ? 'cursor-pointer hover:brightness-90' : 'cursor-default'} ${showLabel ? 'relative' : ''}`} 
                                    style={{ ...cellStyle, ...borderStyle }}
                                    onClick={() => { if (isWorkDay && inRange) toggleWPDayForUser(wp.id, u.id, ds); }}
                                    title={vacConflict ? `‚ö†Ô∏è ${hoursPerActiveDay.toFixed(1)}h geplant aber abwesend!` : inRange && isWorkDay ? (isActive ? `${hoursPerActiveDay.toFixed(1)}h ‚Äì Klick: Tag deaktivieren` : 'Klick: Tag aktivieren') : ''}
                                  >
                                    {vacConflict ? (
                                      <span className="wl-icon" style={{ fontSize: 9 }}>‚ö†Ô∏è</span>
                                    ) : isActive && hoursPerActiveDay > 0 ? (
                                      <span className="wl-t-tiny font-medium" style={{ color: barColor, fontSize: 8 }}>
                                        {wlFmt(hoursPerActiveDay)}
                                      </span>
                                    ) : null}
                                    {showLabel && (
                                      <span className="absolute left-full ml-1 whitespace-nowrap wl-t-xxs text-[9px] pointer-events-none flex items-center gap-1 z-10" style={{ top: '50%', transform: 'translateY(-50%)' }}>
                                        <span className="font-medium" style={{ color: barColor }}>{project?.name}</span>
                                        <span className="text-gray-400">‚Ä∫</span>
                                        <span className="text-gray-600">{wp.name}</span>
                                        <span className="text-gray-400 ml-0.5">{totalHours}h</span>
                                        {wp.locked && <span className="text-orange-500" title="Termin fixiert">üîí</span>}
                                      </span>
                                    )}
                                  </div>
                                );
                              })}
                            </div>
                          );
                        };
                        
                        const renderUserWithWPRows = (u) => {
                          gridRows.push(renderUserRow(u));
                          if (workloadExpandedUsers[u.id]) {
                            getUserWorkPackages(u.id).forEach(wp => {
                              gridRows.push(renderWPBarRow(u, wp));
                            });
                          }
                          gridRows.push(<div key={u.id + '_rsep'} className="wl-separator" />);
                        };
                        
                        const isGroupExp = (key) => workloadExpandedGroups[key] !== false;
                        
                        // Focus-Banner
                        if (wlFocusWP) {
                          gridRows.push(<div key="_rfocus" className="flex border-b" style={{ height: WLR, backgroundColor: wlFocusWP.color + '18', borderColor: wlFocusWP.color + '40' }}>
                            {allDays.map((day, i) => <div key={i} className="flex-shrink-0 border-r" style={{ width: DAY_WIDTH, height: WLR, borderColor: wlFocusWP.color + '20' }} />)}
                          </div>);
                        }
                        
                        // Focus-Mode: Nur beteiligte Mitarbeiter
                        if (wlFocusWP) {
                          const focusUsers = users.filter(u => wlFocusWP.userIds.includes(u.id)).sort((a,b) => a.name.localeCompare(b.name));
                          focusUsers.forEach(u => renderUserWithWPRows(u));
                        } else {
                        // Full hierarchy: Bereich ‚Üí Abteilung ‚Üí Team ‚Üí Mitarbeiter
                        departments.sort((a,b) => a.name.localeCompare(b.name)).forEach(dept => {
                          const deptDivisions = divisions.filter(d => d.departmentId === dept.id);
                          const deptAllUsers = users.filter(u => u.role !== 'admin' && teams.some(t => t.id === u.teamId && deptDivisions.some(d => d.id === t.divisionId)));
                          if (deptAllUsers.length === 0) return;
                          const deptKey = 'wl_dept_' + dept.id;
                          const deptExp = isGroupExp(deptKey);
                          gridRows.push(renderGroupRow(deptAllUsers, '', deptKey, { backgroundColor: '#dcdcdc', color: '#444444' }));
                          if (deptExp) {
                            const activeDivisions = deptDivisions.filter(d => {
                              const divTeams = teams.filter(t => t.divisionId === d.id);
                              return users.some(u => u.role !== 'admin' && divTeams.some(t => t.id === u.teamId));
                            }).sort((a,b) => a.name.localeCompare(b.name));
                            
                            activeDivisions.forEach(div => {
                              const divTeams = teams.filter(t => t.divisionId === div.id);
                              const divAllUsers = users.filter(u => u.role !== 'admin' && divTeams.some(t => t.id === u.teamId));
                              if (divAllUsers.length === 0) return;
                              const divKey = 'wl_' + div.id;
                              const divExp = isGroupExp(divKey);
                              gridRows.push(renderGroupRow(divAllUsers, '', divKey, { backgroundColor: '#e2e2e2', color: '#444444' }));
                              if (divExp) {
                                const activeTeams = divTeams.filter(t => users.some(u => u.role !== 'admin' && u.teamId === t.id)).sort((a,b) => a.name.localeCompare(b.name));
                                activeTeams.forEach(team => {
                                  const teamUsers = users.filter(u => u.role !== 'admin' && u.teamId === team.id);
                                  if (teamUsers.length === 0) return;
                                  const teamKey = 'wl_team_' + team.id;
                                  const teamExp = isGroupExp(teamKey);
                                  gridRows.push(renderGroupRow(teamUsers, '', teamKey, { backgroundColor: '#ececec', color: '#555555' }));
                                  if (teamExp) {
                                    teamUsers.sort((a,b) => a.name.localeCompare(b.name)).forEach(u => renderUserWithWPRows(u));
                                  }
                                });
                              }
                            });
                          }
                        });
                        
                        const assignedUserIds = new Set();
                        departments.forEach(dept => {
                          divisions.filter(d => d.departmentId === dept.id).forEach(div => {
                            teams.filter(t => t.divisionId === div.id).forEach(team => {
                              users.filter(u => u.role !== 'admin' && u.teamId === team.id).forEach(u => assignedUserIds.add(u.id));
                            });
                          });
                        });
                        const orphans = users.filter(u => u.role !== 'admin' && !assignedUserIds.has(u.id));
                        if (orphans.length > 0) {
                          const orphExp = isGroupExp('wl_orphan');
                          gridRows.push(renderGroupRow(orphans, '', '_orph', { backgroundColor: '#ececec', color: '#555555' }));
                          if (orphExp) orphans.sort((a,b) => a.name.localeCompare(b.name)).forEach(u => renderUserWithWPRows(u));
                        }
                        } // end else (non-focus mode)
                      } else if (workloadFilter === 'ressourcen') {
                        // Ressourcen haben noch keine Workload-Daten, zeigen leere Zeilen
                        const typeGroups = [
                          { type: 'maschine', bg: 'bg-blue-50' },
                          { type: 'fahrzeug', bg: 'bg-green-50' },
                          { type: 'werkzeug', bg: 'bg-amber-50' },
                        ];
                        typeGroups.forEach(tg => {
                          const grouped = resources.filter(r => r.type === tg.type);
                          if (grouped.length === 0) return;
                          const isExp = workloadExpandedGroups['wl_res_' + tg.type] !== false;
                          gridRows.push(<div key={'rg_' + tg.type} className={`flex border-b ${tg.bg}`} style={{ height: WLR }}>
                            {allDays.map((day, i) => {
                              const ds = formatDate(day);
                              const dow = day.getDay();
                              const isWE = dow === 0 || dow === 6;
                              const isHol = holidays[ds];
                              return <div key={i} className={`flex-shrink-0 border-r ${isHol ? 'bg-red-200/50' : isWE ? 'bg-gray-200/50' : ''}`} style={{ width: DAY_WIDTH, height: WLR }} />;
                            })}
                          </div>);
                          if (isExp) grouped.sort((a,b) => a.name.localeCompare(b.name)).forEach(r => {
                            gridRows.push(<div key={r.id} className="flex border-b border-gray-100" style={{ height: WLR }}>
                              {allDays.map((day, i) => {
                                const ds = formatDate(day);
                                const dow = day.getDay();
                                const isWE = dow === 0 || dow === 6;
                                const isHol = holidays[ds];
                                return <div key={i} className={`flex-shrink-0 border-r ${isHol ? 'bg-red-200' : isWE ? 'bg-gray-200' : ''}`} style={{ width: DAY_WIDTH, height: WLR }} />;
                              })}
                            </div>);
                          });
                        });
                      }
                      
                      return gridRows;
                    })()}
                  </div>
                </div>
              </div>
            </div>
          )}
          
          <div className="bg-white border-t px-4 py-2 flex gap-6 text-xs text-gray-600 flex-shrink-0 items-center">
            <button 
              onClick={() => setWorkloadPanelHeight(workloadPanelHeight > 0 ? 0 : 350)}
              className={`text-xs px-3 py-1 rounded font-medium flex items-center gap-1.5 ${workloadPanelHeight > 0 ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`}
            >
              üìä Workload
            </button>
            <div className="w-px h-4 bg-gray-200" />
            <div className="flex items-center gap-2"><div className="w-6 h-2 border-t-2 border-l-2 border-r-2 border-indigo-500 rounded-t" /><span>Klammer = Eltern</span></div>
            <div className="flex items-center gap-2"><div className="w-6 h-3 bg-indigo-500 rounded" /><span>Balken</span></div>
            <div className="flex items-center gap-2"><div className="w-3 h-3 rounded-full bg-gray-400 border-2 border-white" /><span>Abh√§ngigkeit</span></div>
            {selectedProjectId && (
              <div className="flex items-center gap-4 ml-4 pl-4 border-l">
                <span className="text-indigo-600 font-medium">{(workPackages || []).filter(wp => wp.projectId === selectedProjectId).length} Arbeitspakete</span>
                <span className="text-gray-500">{currentProjectBaselines.length} Baseline{currentProjectBaselines.length !== 1 ? 's' : ''}</span>
              </div>
            )}
            <div className="ml-auto text-gray-400">Rechtsklick f√ºr Men√º | Doppelklick zum Umbenennen</div>
          </div>
            </div>
          </div>
        </div>
      );
    };
    
    return <ProjectPlanningDashboard />;
  }


  const sortedProjects = [...projects].sort((a, b) => a.name.localeCompare(b.name));
  const filteredProjects = sortedProjects.filter(p => 
    p.name.toLowerCase().includes(projectSearchText.toLowerCase())
  );
  const displayUser = selectedUser || currentUser;

  return (
    <div className="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50">
      <div className="bg-white shadow-lg sticky top-0 z-10">
        <div className="max-w-full mx-auto px-6 py-4 flex justify-between">
          <div className="flex items-center gap-3">
            <Calendar className="w-6 h-6 text-indigo-600" />
            <h1 className="text-xl font-bold">Kapazit√§tsplaner V5</h1>
            {currentUser.teamRole === 'lead' ? (
              <select value={selectedUser?.id || ''} onChange={(e) => { const user = users.find(u => u.id === e.target.value); if (user) setSelectedUser(user); }}
                className="ml-4 px-4 py-2 border-2 border-indigo-600 rounded-xl font-semibold">
                {users.filter(u => u.role !== 'admin').map(u => (<option key={u.id} value={u.id}>{u.name}</option>))}
              </select>
            ) : (
              <span className="ml-4 px-4 py-2 font-semibold text-gray-600">- {displayUser?.name}</span>
            )}
          </div>
          <div className="flex gap-2">
            {/* Undo/Redo Buttons */}
            <button 
              onClick={undo} 
              disabled={undoStack.length === 0}
              className={`p-3 rounded-2xl ${undoStack.length > 0 ? 'hover:bg-gray-100' : 'opacity-30 cursor-not-allowed'}`}
              title={`R√ºckg√§ngig (${undoStack.length} verf√ºgbar)`}>
              ‚Ü∂
            </button>
            <button 
              onClick={redo} 
              disabled={redoStack.length === 0}
              className={`p-3 rounded-2xl ${redoStack.length > 0 ? 'hover:bg-gray-100' : 'opacity-30 cursor-not-allowed'}`}
              title={`Wiederholen (${redoStack.length} verf√ºgbar)`}>
              ‚Ü∑
            </button>
            
            {/* History Button */}
            <button 
              onClick={() => setShowHistory(!showHistory)} 
              className={`p-3 rounded-2xl ${showHistory ? 'bg-blue-100' : 'hover:bg-gray-100'}`}
              title="√Ñnderungshistorie">
              üìú
            </button>
            
            {/* Navigation - IMMER sichtbar, aktiver Button hervorgehoben */}
            <button 
              onClick={() => { setShowDashboard(false); setShowProjectDashboard(false); setShowProjectPlanning(false); }} 
              className={`px-4 py-2 rounded-2xl ${!showDashboard && !showProjectDashboard && !showProjectPlanning ? 'bg-indigo-600 text-white' : 'bg-gray-100 hover:bg-gray-200'}`}
            >
              <Calendar className="w-4 h-4 inline mr-2" />Planung
            </button>
            <button 
              onClick={() => { setShowDashboard(true); setShowProjectDashboard(false); setShowProjectPlanning(false); }} 
              className={`px-4 py-2 rounded-2xl ${showDashboard ? 'bg-green-600 text-white' : 'bg-gray-100 hover:bg-gray-200'}`}
            >
              <BarChart3 className="w-4 h-4 inline mr-2" />Team Dashboard
            </button>
            <button 
              onClick={() => { setShowDashboard(false); setShowProjectDashboard(true); setShowProjectPlanning(false); }} 
              className={`px-4 py-2 rounded-2xl ${showProjectDashboard ? 'bg-blue-600 text-white' : 'bg-gray-100 hover:bg-gray-200'}`}
            >
              <BarChart3 className="w-4 h-4 inline mr-2" />Projekt Dashboard
            </button>
            <button 
              onClick={() => { setShowDashboard(false); setShowProjectDashboard(false); setShowProjectPlanning(true); }} 
              className={`px-4 py-2 rounded-2xl ${showProjectPlanning ? 'bg-orange-600 text-white' : 'bg-gray-100 hover:bg-gray-200'}`}
            >
              üèóÔ∏è Projektplanung
            </button>
            
            {currentUser.role === 'admin' && (<button onClick={() => setShowAdmin(true)} className="px-4 py-2 bg-purple-600 text-white rounded-2xl">Admin</button>)}
            <button onClick={() => setShowSettings(true)} className="p-3 hover:bg-gray-100 rounded-2xl"><Settings className="w-5 h-5" /></button>
            <button onClick={() => { setCurrentUser(null); setSelectedUser(null); setShowLogin(true); setShowDashboard(false); }} 
              className="px-4 py-2 bg-gray-100 rounded-2xl"><LogOut className="w-4 h-4 inline mr-2" />Abmelden</button>
          </div>
        </div>
      </div>
      
      <div className="bg-white shadow">
        <div className="max-w-full mx-auto px-6 py-4 flex justify-between items-center">
          <button onClick={() => setCurrentWeek(w => w === 1 ? 52 : w - 1)} className="px-4 py-2 bg-indigo-600 text-white rounded-2xl"><ChevronLeft className="w-5 h-5" /></button>
          <div className="font-bold">KW {currentWeek} - {currentWeek + WEEKS_TO_SHOW - 1}</div>
          <button onClick={() => setCurrentWeek(w => w === 52 ? 1 : w + 1)} className="px-4 py-2 bg-indigo-600 text-white rounded-2xl"><ChevronRight className="w-5 h-5" /></button>
        </div>
      </div>

      <div className="max-w-full mx-auto px-6 py-6">
        <div className="bg-white rounded-3xl shadow-lg">
          <div className="bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4">
            <h2 className="text-xl font-bold text-white">Wochenansicht - {displayUser?.name}</h2>
          </div>
          <div className="p-4 flex gap-4">
            <div className="w-56 bg-gray-50 rounded-2xl p-4 flex-shrink-0 flex flex-col" style={{maxHeight: '600px'}}>
              <h3 className="font-bold mb-3">Projekte</h3>
              
              {/* Suchfeld */}
              <div className="mb-3">
                <input 
                  type="text" 
                  placeholder="Suchen..." 
                  value={projectSearchText}
                  onChange={(e) => setProjectSearchText(e.target.value)}
                  className="w-full p-2 border rounded-lg text-sm"
                />
              </div>
              
              <div className="space-y-2 overflow-y-auto flex-1">
                {filteredProjects.map(p => (
                  <div key={p.id} draggable onDragStart={() => setDraggedProject(p)} 
                    className="flex items-center gap-2 p-3 rounded-xl cursor-move hover:shadow-lg bg-white border-2 transition-shadow" style={{borderColor: p.color}}>
                    <GripVertical className="w-4 h-4" />
                    <div className="w-4 h-4 rounded" style={{backgroundColor: p.color}}></div>
                    <span className="flex-1 text-sm">{p.name}</span>
                  </div>
                ))}
                {filteredProjects.length === 0 && projectSearchText && (
                  <div className="text-center text-gray-500 text-xs py-4">
                    Keine Projekte
                  </div>
                )}
              </div>
            </div>
            <div className="flex-1 overflow-x-auto preserve-scroll" ref={ganttScrollRef}>
              <div className="flex gap-4 pb-4">
                {displayUser && Array.from({length: WEEKS_TO_SHOW}, (_, i) => {
                  const weekNum = currentWeek + i;
                  return <WeekColumn key={weekNum} weekNum={weekNum} user={displayUser} />;
                })}
              </div>
            </div>
          </div>
        </div>
      </div>

      {showSettings && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-3xl p-6 max-w-[1400px] w-full max-h-[80vh] overflow-y-auto">
            <div className="flex justify-between mb-6">
              <h2 className="text-2xl font-bold">Einstellungen</h2>
              <button onClick={() => { setShowSettings(false); setProjectSearchText(''); }} className="text-2xl">‚úï</button>
            </div>
            <div className="mb-6">
              <h3 className="font-semibold mb-3">Schriftgr√∂√üe: {fontSize}px</h3>
              <input type="range" min="10" max="16" value={fontSize} onChange={(e) => setFontSize(parseInt(e.target.value))} className="w-full" />
            </div>
            
            {/* Arbeitszeiten & Pausen */}
            <div>
              <h3 className="font-semibold mb-3">Arbeitszeiten & Pausen</h3>
              <div className="p-3 bg-gray-50 rounded-xl">
                <div className="space-y-2">
                  {[{d:1,l:'Mo'},{d:2,l:'Di'},{d:3,l:'Mi'},{d:4,l:'Do'},{d:5,l:'Fr'}].map(({d,l}) => {
                    const sched = displayUser?.dailySchedule || DEFAULT_SCHEDULE;
                    const dayS  = sched[d] || {start:8, end:17, break1Start:9, break1Duration:0.25, break2Start:12.5, break2Duration:0.75};
                    const isOff = dayS.start >= dayS.end || (dayS.start === 0 && dayS.end === 0);
                    const toggleOff = () => {
                      const newSched = {...sched, [d]: isOff ? {start:8,end:17,break1Start:9,break1Duration:0.25,break2Start:12.5,break2Duration:0.75} : {start:0,end:0,break1Duration:0,break2Duration:0}};
                      const updatedUsers = users.map(u => u.id === displayUser.id ? {...u, dailySchedule: newSched} : u);
                      saveUsers(updatedUsers);
                      if (selectedUser?.id === displayUser.id) setSelectedUser({...displayUser, dailySchedule: newSched});
                    };
                    const setVal = (field, raw) => {
                      const val = (field === 'break1Duration' || field === 'break2Duration' || field === 'break1Start' || field === 'break2Start') 
                        ? parseFloat(raw) || 0 
                        : t2h(raw);
                      const newSched = {...sched, [d]: {...dayS, [field]: val}};
                      const updatedUsers = users.map(u => u.id === displayUser.id ? {...u, dailySchedule: newSched} : u);
                      saveUsers(updatedUsers);
                      if (selectedUser?.id === displayUser.id) setSelectedUser({...displayUser, dailySchedule: newSched});
                    };
                    const break1 = dayS.break1Duration || 0;
                    const break2 = (dayS.end > 13) ? (dayS.break2Duration || 0) : 0;
                    const netHours = Math.max(0, (dayS.end - dayS.start) - break1 - break2);
                    return (
                      <div key={d} className="space-y-1">
                        <div className="flex items-center gap-2 text-sm">
                          <span className="font-medium text-gray-700 w-20">{l}</span>
                          {isOff ? (
                            <>
                              <span className="text-red-500 italic flex-1">frei</span>
                              <button onClick={toggleOff} className="text-xs px-2 py-1 rounded font-semibold bg-green-100 text-green-700">An</button>
                            </>
                          ) : (
                            <>
                              <input 
                                type="text" 
                                defaultValue={h2t(dayS.start)}
                                key={`settings-start-${d}-${dayS.start}`}
                                onBlur={(e) => {
                                  const formatted = formatTimeInput(e.target.value);
                                  if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                    setVal('start', formatted);
                                  }
                                }}
                                onKeyDown={(e) => {
                                  if (e.key === 'Enter') {
                                    const formatted = formatTimeInput(e.target.value);
                                    if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                      setVal('start', formatted);
                                      e.target.blur();
                                    }
                                  }
                                }}
                                className="p-1.5 border rounded text-sm w-20"
                                placeholder="HH:MM" 
                              />
                              <span className="text-gray-400 text-sm">‚Äì</span>
                              <input 
                                type="text" 
                                defaultValue={h2t(dayS.end)}
                                key={`settings-end-${d}-${dayS.end}`}
                                onBlur={(e) => {
                                  const formatted = formatTimeInput(e.target.value);
                                  if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                    setVal('end', formatted);
                                  }
                                }}
                                onKeyDown={(e) => {
                                  if (e.key === 'Enter') {
                                    const formatted = formatTimeInput(e.target.value);
                                    if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                      setVal('end', formatted);
                                      e.target.blur();
                                    }
                                  }
                                }}
                                className="p-1.5 border rounded text-sm w-20"
                                placeholder="HH:MM"
                              />
                              <span className="font-semibold text-indigo-600 w-16 text-right text-sm">{netHours.toFixed(2)}h</span>
                              <button onClick={toggleOff} className="text-xs px-2 py-1 rounded font-semibold bg-red-100 text-red-600">Aus</button>
                            </>
                          )}
                        </div>
                        {!isOff && (
                          <div className="flex items-center gap-2 ml-24 text-sm text-gray-600">
                            <span className="font-medium">P1:</span>
                            <input 
                              type="text" 
                              defaultValue={h2t(dayS.break1Start || 9)}
                              key={`settings-b1s-${d}-${dayS.break1Start}`}
                              onBlur={(e) => {
                                const formatted = formatTimeInput(e.target.value);
                                if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                  setVal('break1Start', formatted);
                                }
                              }}
                              onKeyDown={(e) => {
                                if (e.key === 'Enter') {
                                  const formatted = formatTimeInput(e.target.value);
                                  if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                    setVal('break1Start', formatted);
                                    e.target.blur();
                                  }
                                }
                              }}
                              className="p-2 border rounded text-sm w-32" 
                              placeholder="HH:MM"
                              title="Pause 1 Start" />
                            <span className="text-gray-400">‚Äì</span>
                            <input 
                              type="text" 
                              defaultValue={h2t((dayS.break1Start || 9) + (dayS.break1Duration || 0.25))}
                              key={`settings-b1e-${d}-${dayS.break1Duration}`}
                              onBlur={(e) => {
                                const formatted = formatTimeInput(e.target.value);
                                if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                  const end = t2h(formatted);
                                  const start = dayS.break1Start || 9;
                                  const duration = Math.max(0, end - start);
                                  const newSched = {...sched, [d]: {...dayS, break1Duration: duration}};
                                  const updatedUsers = users.map(u => u.id === displayUser.id ? {...u, dailySchedule: newSched} : u);
                                  saveUsers(updatedUsers);
                                  if (selectedUser?.id === displayUser.id) setSelectedUser({...displayUser, dailySchedule: newSched});
                                }
                              }}
                              onKeyDown={(e) => {
                                if (e.key === 'Enter') {
                                  const formatted = formatTimeInput(e.target.value);
                                  if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                    const end = t2h(formatted);
                                    const start = dayS.break1Start || 9;
                                    const duration = Math.max(0, end - start);
                                    const newSched = {...sched, [d]: {...dayS, break1Duration: duration}};
                                    const updatedUsers = users.map(u => u.id === displayUser.id ? {...u, dailySchedule: newSched} : u);
                                    saveUsers(updatedUsers);
                                    if (selectedUser?.id === displayUser.id) setSelectedUser({...displayUser, dailySchedule: newSched});
                                    e.target.blur();
                                  }
                                }
                              }}
                              className="p-2 border rounded text-sm w-32" 
                              placeholder="HH:MM"
                              title="Pause 1 Ende" />
                            
                            <span className="text-gray-400 mx-1">|</span>
                            
                            <span className="font-medium">P2:</span>
                            <input 
                              type="text" 
                              defaultValue={h2t(dayS.break2Start || 12.5)}
                              key={`settings-b2s-${d}-${dayS.break2Start}`}
                              onBlur={(e) => {
                                const formatted = formatTimeInput(e.target.value);
                                if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                  setVal('break2Start', formatted);
                                }
                              }}
                              onKeyDown={(e) => {
                                if (e.key === 'Enter') {
                                  const formatted = formatTimeInput(e.target.value);
                                  if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                    setVal('break2Start', formatted);
                                    e.target.blur();
                                  }
                                }
                              }}
                              className="p-2 border rounded text-sm w-32" 
                              placeholder="HH:MM"
                              title="Pause 2 Start" />
                            <span className="text-gray-400">‚Äì</span>
                            <input 
                              type="text" 
                              defaultValue={h2t((dayS.break2Start || 12.5) + (dayS.break2Duration || 0.75))}
                              key={`settings-b2e-${d}-${dayS.break2Duration}`}
                              onBlur={(e) => {
                                const formatted = formatTimeInput(e.target.value);
                                if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                  const end = t2h(formatted);
                                  const start = dayS.break2Start || 12.5;
                                  const duration = Math.max(0, end - start);
                                  const newSched = {...sched, [d]: {...dayS, break2Duration: duration}};
                                  const updatedUsers = users.map(u => u.id === displayUser.id ? {...u, dailySchedule: newSched} : u);
                                  saveUsers(updatedUsers);
                                  if (selectedUser?.id === displayUser.id) setSelectedUser({...displayUser, dailySchedule: newSched});
                                }
                              }}
                              onKeyDown={(e) => {
                                if (e.key === 'Enter') {
                                  const formatted = formatTimeInput(e.target.value);
                                  if (formatted && formatted.match(/^\d{2}:\d{2}$/)) {
                                    const end = t2h(formatted);
                                    const start = dayS.break2Start || 12.5;
                                    const duration = Math.max(0, end - start);
                                    const newSched = {...sched, [d]: {...dayS, break2Duration: duration}};
                                    const updatedUsers = users.map(u => u.id === displayUser.id ? {...u, dailySchedule: newSched} : u);
                                    saveUsers(updatedUsers);
                                    if (selectedUser?.id === displayUser.id) setSelectedUser({...displayUser, dailySchedule: newSched});
                                    e.target.blur();
                                  }
                                }
                              }}
                              className="p-2 border rounded text-sm w-32" 
                              placeholder="HH:MM"
                              title="Pause 2 Ende" />
                          </div>
                        )}
                      </div>
                    );
                  })}
                </div>
                <div className="text-sm text-gray-500 text-right pt-3 border-t mt-3">
                  Gesamt: <span className="font-bold text-indigo-600">{[1,2,3,4,5].reduce((s,d) => { 
                    const ds=(displayUser?.dailySchedule||DEFAULT_SCHEDULE)[d]||{start:8,end:17,break1Duration:0.25,break2Duration:0.75}; 
                    const gross=ds.end>ds.start?ds.end-ds.start:0; 
                    const b1=ds.break1Duration||0; 
                    const b2=(ds.end>13)?(ds.break2Duration||0):0; 
                    return s+Math.max(0,gross-b1-b2); 
                  }, 0).toFixed(2)}h / Woche</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      )}

      {showAdmin && <AdminPanel />}
      
      {/* Global History Panel - fixed overlay f√ºr alle Views */}
      {showHistory && (
        <div className="fixed top-20 right-4 w-80 bg-white rounded-2xl shadow-2xl p-4 flex flex-col z-40 border-2 border-indigo-200" style={{maxHeight: '600px'}}>
          <div className="flex justify-between items-center mb-3">
            <h3 className="font-bold text-indigo-600">üìú √Ñnderungshistorie</h3>
            <button onClick={() => setShowHistory(false)} className="text-gray-400 hover:text-gray-600 text-xl">‚úï</button>
          </div>
          
          <div className="space-y-2 overflow-y-auto flex-1">
            {historyLog.length === 0 ? (
              <div className="text-center text-gray-400 text-sm py-8">
                Noch keine √Ñnderungen
              </div>
            ) : (
              historyLog.map(entry => {
                const date = new Date(entry.timestamp);
                const timeStr = date.toLocaleTimeString('de-DE', {hour: '2-digit', minute: '2-digit'});
                const dateStr = date.toLocaleDateString('de-DE', {day: '2-digit', month: '2-digit'});
                
                let icon = 'üìù';
                let actionText = entry.action;
                
                if (entry.action === 'task_create') { icon = '‚ûï'; actionText = 'Task erstellt'; }
                else if (entry.action === 'task_delete') { icon = 'üóëÔ∏è'; actionText = 'Task gel√∂scht'; }
                else if (entry.action === 'task_move') { icon = '‚ÜîÔ∏è'; actionText = 'Task verschoben'; }
                else if (entry.action === 'vacation_set') { icon = 'üèñÔ∏è'; actionText = 'Urlaub gesetzt'; }
                else if (entry.action === 'vacation_remove') { icon = '‚ùå'; actionText = 'Urlaub entfernt'; }
                else if (entry.action === 'project_create') { icon = 'üé®'; actionText = 'Projekt erstellt'; }
                else if (entry.action === 'project_delete') { icon = 'üóëÔ∏è'; actionText = 'Projekt gel√∂scht'; }
                else if (entry.action === 'undo') { icon = '‚Ü∂'; actionText = 'R√ºckg√§ngig'; }
                else if (entry.action === 'redo') { icon = '‚Ü∑'; actionText = 'Wiederherstellt'; }
                
                return (
                  <div key={entry.id} className="bg-gray-50 p-3 rounded-lg shadow-sm border border-gray-200 hover:bg-gray-100 transition-colors">
                    <div className="flex items-start gap-2">
                      <span className="text-lg">{icon}</span>
                      <div className="flex-1 min-w-0">
                        <div className="text-xs text-gray-500">{dateStr} {timeStr}</div>
                        <div className="font-medium text-sm">{entry.userName}</div>
                        <div className="text-sm text-gray-600 mt-1">{actionText}</div>
                        {entry.details && (
                          <div className="text-xs text-gray-500 mt-1 truncate" title={entry.details}>
                            {entry.details}
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                );
              })
            )}
          </div>
        </div>
      )}
    </div>
  );
};

    // App rendern
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<CapacityPlanner />);
  </script>
</body>
</html>
